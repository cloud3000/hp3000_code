001000$CONTROL POST85, BOUNDS, LINES=59, LIST, MAP, CROSSREF            080831ma
001100******************************************************************080702MA
001200*   COPYRIGHT 2007 - 2009 J3K Solutions All rights reserved.      080702MA
001300*                                                                 080830ma
001400*                ****************************                     080830ma
001600*                  FORMSPEC export utility                        081215ma
001700*                ****************************                     080830ma
001800*                                                                 080830ma
001900* This program WILL COUNT all FORMFILES, FORMS, and all objects   080830ma
002000* in the form design. This allows formspec data to be exported    080830ma
002100* to an Image Database with the proper capacities.                080830ma
002200*                                                                 080830ma
002300* The following environment variables are set at completion:      080830ma
002400*   MIG_FM_FILES                                                  080830ma
002500*   MIG_FM_FORMS                                                  080830ma
002600*   MIG_FM_FIELDS (The total number of Objects, text and fkeys)   080830ma
002700*   MIG_FM_SPECS  (The total number of Processing Spec lines)     080830ma
002800*                                                                 080830ma
002900* SEE SHOWVAR after this program runs,                            080830ma
003000*                                                                 080830ma
003100*                                                                 080813ma
003200*  Data exported includes the following:                          080902ma
003300*  Data Fields and all their properties.                          080830ma
003400*  Processing Specs for each field.                               080830ma
003500*  Screen enhancements.                                           080830ma
003600*  Line Drawing characters.                                       080830ma
003700*  Descriptive Text on the screen, and text properties.           080830ma
003800*  The Function Keys that were painted as text on the screen      080830ma
003900*  design (row 1 and 2) using screen escape sequences.            080830ma
004000*  The Function Key Labels (f1 thru f8) as entered in the         080830ma
004100*  FKEY screen in formspec.                                       080830ma
004200*                                                                 080828MA
004300*   http://www.j3ksolutions.com                                   080702MA
004400*   mailto:support@j3ksolutions.com                               080702MA
004500******************************************************************080702MA
004600 IDENTIFICATION DIVISION.                                                 
004700 PROGRAM-ID.     MIG898.                                          080902ma
004800 AUTHOR.     MICHAEL ANDERSON.                                            
004900 ENVIRONMENT DIVISION.                                            060615MA
005000 CONFIGURATION SECTION.                                           060615MA
005100 SOURCE-COMPUTER. HP-3000.                                        081114ma
005200*  SOURCE-COMPUTER. HP-3000 WITH DEBUGGING MODE.                  081114ma
005300 OBJECT-COMPUTER. HP-3000.                                        080828MA
005400*                                                                 060615MA
005500 INPUT-OUTPUT SECTION.                                            060615MA
005600 FILE-CONTROL.                                                    060615MA
005700*                                                                 060615MA
005800     SELECT PRINT-FILE      ASSIGN TO "DMG014,,,LP(SDTL)".        060706MA
005900     SELECT SORTFILE        ASSIGN TO "DMG01SRT,,,,9000000".      060706MA
006000     SELECT EXTFILE1        ASSIGN TO "DMG01A1,,,,9000000".       060706MA
006100     SELECT EXTFILE2        ASSIGN TO "DMG01A2,,,,9000000".       060706MA
006200     SELECT DMG01A3-FILE    ASSIGN TO "VPLUSRR,,,,9000000".       080422MA
006300     SELECT DMGFTP-FILE     ASSIGN TO "DMGFTP".                   060713MA
006400     SELECT FORMA-FILE      ASSIGN TO "FORM,,,DISC"               080813ma
006500            FILE STATUS IS FORMFILE-STATUS.                       080813ma
006600     SELECT G-FILE      ASSIGN TO "GFILE,,,DISC"                  080830ma
006700            FILE STATUS IS GFILE-STATUS.                          080830ma
006800*                                                                 060615MA
006900 DATA DIVISION.                                                   060615MA
007000 FILE SECTION.                                                    060615MA
007100                                                                  060615MA
007200                                                                  060615MA
007300 FD  PRINT-FILE                                                   060615MA
007400     RECORD CONTAINS 132 CHARACTERS                               060615MA
007500     BLOCK CONTAINS 1 RECORDS                                     060615MA
007600     LABEL RECORDS ARE OMITTED.                                   060615MA
007700 01  PRINT-LINE.                                                  060615MA
007800     02  CLEAR-OUT                   PIC X(132).                  060615MA
007900                                                                  060615MA
008000 FD  EXTFILE2 DATA RECORD IS EXT-REC                              060615MA
008100     RECORD CONTAINS 62 CHARACTERS.                               060615MA
008200 01  EXT-REC2.                                                    060615MA
008300     05  FILLER                PIC X(62).                         060615MA
008400                                                                  060615MA
008500 FD  EXTFILE1 DATA RECORD IS EXT-REC                              060615MA
008600     RECORD CONTAINS 62 CHARACTERS.                               060615MA
008700 01  EXT-REC.                                                     060615MA
008800     05  FILLER                PIC X(62).                         060615MA
008900                                                                  060615MA
009000 SD  SORTFILE DATA RECORD IS SORT-REC                             060615MA
009100          RECORD CONTAINS 62 CHARACTERS.                          060615MA
009200 01  SORT-REC.                                                    060615MA
009300     02 SORT-KEY PIC X(62).                                       060615MA
009400 FD  DMG01A3-FILE                                                 060713MA
009500     RECORD CONTAINS 256 CHARACTERS                               080422MA
009600     DATA RECORD IS Script-File.                                  060713MA
009700 01  Script-File.                                                 060619MA
009800     05  Script-Str                     PIC X(256).               080422MA
009900                                                                  060713MA
010000 FD  DMGFTP-FILE                                                  060713MA
010100     RECORD CONTAINS 256 CHARACTERS                               060713MA
010200     DATA RECORD IS FTP-File.                                     060713MA
010300 01  FTP-File.                                                    060713MA
010400     05  FTP-Str                     PIC X(256).                  060713MA
010500 FD  FORMA-FILE                                                   080813ma
010600     RECORD CONTAINS 256 CHARACTERS                               080813ma
010700     DATA RECORD IS Form-File.                                    080813ma
010800 01  Form-File.                                                   080813ma
010900     05  Form-Rec                     PIC X(256).                 080813ma
011000*                                                                 080830ma
011100 FD  G-File                                                       080830ma
011200     RECORD CONTAINS 1540 CHARACTERS                              080830ma
011300     DATA RECORD is G-REC.                                        080830ma
011400 01  G-REC                            PIC X(1540).                080830ma
011500                                                                  080830ma
011600$PAGE "WORKING STORAGE"                                           060615MA
011700 WORKING-STORAGE SECTION.                                         060615MA
011800***************************************************************** 080813ma
011900 01  FILE-ERROR-DATA.                                             080813ma
012000     05 ERROR-NUMBER        PIC XX    VALUE SPACES.               080830ma
012100     05 FNAME               PIC X(8)  VALUE SPACES.               080830ma
012200     05 FILE-ERROR-RECORD   PIC X(79) VALUE SPACES.               080830ma
012300                                                                  080830ma
012400                                                                  080830ma
012500 01  GFILE-STATUS           PIC XX    VALUE SPACES.               080830ma
012600 01  GFILE-COUNT            PIC S9(9) COMP VALUE 0.               080830ma
012700 01  GFILE-RCOUNT           PIC S9(9) COMP VALUE 0.               080830ma
012800 01  GFILE-FLAG             PIC XX    VALUE SPACES.               080830ma
012900     88 GFILE-CLOSED        VALUE SPACES.                         080830ma
013000     88 GFILE-OPENED-INPUT  VALUE "01".                           080830ma
013100     88 GFILE-OPENED-OUTPUT VALUE "02".                           080830ma
013200     88 GFILE-EOF           VALUE "99".                           080830ma
013300                                                                  080830ma
013400 01  FORMFILE-STATUS        PIC XX    VALUE SPACES.               080830ma
013500 01  FORMFILE-COUNT         PIC S9(9) COMP VALUE 0.               080813ma
013600 01  FORMFILE-FLAG          PIC XX    VALUE SPACES.               080813ma
013700     88 FORMFILE-CLOSED        VALUE SPACES.                      080830ma
013800     88 FORMFILE-OPENED-INPUT  VALUE "01".                        080813ma
013900     88 FORMFILE-OPENED-OUTPUT VALUE "02".                        080813ma
014000     88 FORMFILE-EOF           VALUE "99".                        080830ma
014100 01  X2                    PIC S9(4) COMP VALUE 0.                080813ma
014200 01  I                     PIC S9(4) COMP VALUE 0.                080820MA
014300 01  X                     PIC S9(4) COMP VALUE 0.                080820MA
014400 01  FCNT                  PIC S9(4) COMP VALUE 0.                080820MA
014500 01  FX                    PIC S9(4) COMP VALUE 0.                080820MA
014600 01 Esc-len                PIC S9(4) COMP VALUE 0.                080813ma
014700 01 ld-IDX                 PIC S9(4) COMP VALUE 0.                080828MA
014800 01 ld-len                 PIC S9(4) COMP VALUE 0.                080828MA
014900 01  Ascii-Value           PIC S9(4) COMP VALUE 0.                080813ma
015000 01  ASCII-CHARACTER       REDEFINES Ascii-Value.                 080813ma
015100     02 ASCII-BYTE1        PIC X.                                 080813ma
015200     02 ASCII-BYTE2        PIC X.                                 080813ma
015300 01  LAST-FORMFILE          PIC S9(4) COMP VALUE 1.               080813ma
015400 01  HPVAR-NAME        PIC X(20) VALUE "ITOSQLS_STATUS~  ".       060614MA
015500 01  HPVAR-ITEM        PIC S9(9) COMP VALUE -1.                           
015600 01  HPVAR-ITEMNUM     PIC S9(9) COMP VALUE 1.                            
015700 01  HPVAR-STAT        PIC S9(9) COMP VALUE 0.                            
015800 01  DS-IDX            PIC S9(9) COMP VALUE 0.                    060621MA
015900 01  DI-IDX            PIC S9(9) COMP VALUE 0.                    060621MA
016000 01 forms-data.                                                   080813ma
016100    05 frdidx pic s9(9) comp value 0.                             080813ma
016200    05 frdptr pic s9(9) comp value 0.                             080813ma
016300    05 PRCptr pic s9(9) comp value 0.                             080813ma
016400    05 frdcnt pic s9(9) comp value 0.                             080813ma
016500    05 PRCcnt pic s9(9) comp value 0.                             080813ma
016600    05 frd-table.                                                 080813ma
016700       10 frd-entries OCCURS 32767  times.                        080813ma
016800          20 frdstr pic x(256).                                   080813ma
016900 01 S1       PIC S9(9) COMP VALUE 0.                              080813ma
017000 01 S2       PIC S9(9) COMP VALUE 0.                              080813ma
017100                                                                  080813ma
017200 01 FORMSFILE-SW PIC X VALUE "0".                                 080813ma
017300    88 END-OF-FORMSFILE VALUE "1".                                080813ma
017400 01 end-of-specs-sw pic x value "0".                              080828MA
017500    88 end-of-specs value "1".                                    080828MA
017600 01 FORMFILES-REC-TYPE-SW PIC X VALUE "~".                        080813ma
017700    88 Type-is-Valid VALUES ARE                                   080813ma
017800    "V" "F".                                                      080813ma
017900*    "K" "G" "E" "H" "V" "F" "N" "T" "W" "S" "A" "O".             080813ma
018000                                                                  080820MA
018100 01 T-RECORD.                                                     080813ma
018200    02 TIDX          PIC S9(4) COMP VALUE 0.                      080820MA
018300    02 T-LEN         PIC S9(9) COMP VALUE 0.                      080820MA
018400    02 T-STRT        PIC S9(9) COMP VALUE 0.                      080820MA
018500    02 T-END         PIC S9(9) COMP VALUE 0.                      080820MA
018600    02 T-HEADER PIC X(40).                                        080813ma
018700    02 T-FLD-ENTRIES OCCURS 256 TIMES.                            080813ma
018800       05 T-FIELD PIC X(62).                                      080813ma
018900 01 T-HEADER-FORMAT.                                              080813ma
019000    05 THF-LENGTH PIC S9(4) COMP.                                 080813ma
019100    05 THF-TYPE   PIC X.                                          080813ma
019200    05 THF-FORM   PIC X(15).                                      080813ma
019300    05 THF-CNT1   PIC S9(4) COMP.                                 080813ma
019400    05 THF-CNT2   PIC S9(4) COMP.                                 080813ma
019500    05 FILLER     PIC X(18).                                      080813ma
019600                                                                  080813ma
019700 01 T-FIELD-FORMAT.                                               080813ma
019800    05 TFF-FLD1 PIC X(15).                                        080813ma
019900    05 TFF-FLD2 PIC X(15).                                        080813ma
020000    05 TFF-ENH   PIC X(4).                                        080813ma
020100    05 TFF-ESCVAL    PIC X.                                       080813ma
020200    05 TFF-A     PIC X.                                           080813ma
020300    05 TFF-FLDNUM  PIC S9(4) COMP.                                080813ma
020400    05 TFF-SCRNODR  PIC S9(4) COMP.                               080813ma
020500    05 FILLER  PIC S9(4) COMP.                                    080813ma
020600    05 FILLER  PIC S9(4) COMP.                                    080813ma
020700    05 TFF-LEN   PIC S9(4) COMP.                                  080813ma
020800    05 TFF-ROW   PIC S9(4) COMP.                                  080813ma
020900    05 TFF-COL   PIC S9(4) COMP.                                  080813ma
021000                                                                  080813ma
021100 01 D-RECORD.                                                     080813ma
021200    02 DIDX          PIC S9(4) COMP VALUE 0.                      080820MA
021300    02 D-LEN         PIC S9(9) COMP VALUE 0.                      080820MA
021400    02 D-STRT        PIC S9(9) COMP VALUE 0.                      080820MA
021500    02 D-END         PIC S9(9) COMP VALUE 0.                      080820MA
021600    02 D-RECORD-ENTRIES OCCURS 256 TIMES.                         080813ma
021700       05 D-HEADER PIC X(3).                                      080813ma
021800       05 D-FIELD PIC X(99).                                      080813ma
021900                                                                  080813ma
022000 01 D-HEADER-FORMAT.                                              080813ma
022100    05 DHF-LENGTH PIC S9(4) COMP.                                 080813ma
022200    05 DHF-TYPE   PIC X.                                          080813ma
022300                                                                  080813ma
022400 01 D-FIELD-FORMAT.                                               080813ma
022500    05 DFF-FLD1    PIC X(15).                                     080813ma
022600    05 DFF-FLD2    PIC X(15).                                     080813ma
022700    05 DFF-LEN     PIC XXX.                                       080813ma
022800    05 DFF-DTYPE   PIC XXXX.                                      080813ma
022900    05 DFF-INIT    PIC X(62).                                     080813ma
023000                                                                  080813ma
023100 01 E-RECORD.                                                     080813ma
023200    02 EIDX          PIC S9(4) COMP VALUE 0.                      080820MA
023300    02 ECNT          PIC S9(4) COMP VALUE 0.                      080820MA
023400    02 E-LEN         PIC S9(9) COMP VALUE 0.                      080820MA
023500    02 E-STRT        PIC S9(9) COMP VALUE 0.                      080820MA
023600    02 E-END         PIC S9(9) COMP VALUE 0.                      080820MA
023700    02 E-RECORD-ENTRIES OCCURS 2048 TIMES.                        080813ma
023800       05 E-HEADER PIC X(3).                                      080813ma
023900       05 E-DATA.                                                 080813ma
024000          10 E-FORM1             PIC X(15).                       080813ma
024100          10 E-FORM2             PIC X(15).                       080813ma
024200          10 E-REPEAT-OPTION     PIC X.                           080813ma
024300          10 E-NFORM-OPTION      PIC X.                           080813ma
024400          10 E-NFORM             PIC X(15).                       080813ma
024500          10 E-FKEY-DEF          PIC X.                           080813ma
024600          10 E-REPRODUCED-FR     PIC X(15).                       080813ma
024700          10 E-COMMENTS          PIC X(50).                       080813ma
024800                                                                  080813ma
024900 01 GSIDX          PIC S9(4) COMP VALUE 0.                        080831ma
025000 01 GSCNT          PIC S9(4) COMP VALUE 0.                        080831ma
025010 01 G-SCREEN-DATA.                                                080831ma
025100    02 G-SCREEN-ARRAY.                                            080831ma
025200       05 G-SCREEN-ENTRIES OCCURS 260 TIMES.                      080831ma
025300          10 GS-HEADER PIC XXX.                                   080831ma
025400          10 GS-FIELD  PIC X(1537).                               080831ma
025500 01 G-DATA-STORAGE.                                               080831ma
025600    02 GIDX          PIC S9(4) COMP VALUE 0.                      080831ma
025700    02 GCNT          PIC S9(4) COMP VALUE 0.                      080831ma
025800    02 G-LEN         PIC S9(9) COMP VALUE 0.                      080820MA
025900    02 G-STRT        PIC S9(9) COMP VALUE 0.                      080820MA
026000    02 G-END         PIC S9(9) COMP VALUE 0.                      080820MA
026100    02 G-RECORD.                                                  080831ma
026200       05 G-HEADER PIC X(3).                                      080813ma
026300       05 G-FIELD PIC X(1536).                                    080813ma
026400                                                                  080813ma
026500 01 G-HEADER-FORMAT.                                              080813ma
026600    05 GHF-LENGTH    PIC S9(4) COMP.                              080813ma
026700    05 GHF-TYPE      PIC X.                                       080813ma
026800                                                                  080830ma
026900 01 G-FIELD-FORMAT.                                               080813ma
027000    05 GFF-FORM      PIC X(15).                                   080813ma
027100    05 GFF-FIELD     PIC X(15).                                   080813ma
027200    05 GFF-NUM       PIC X(4).                                    080813ma
027300    05 GFF-LEN       PIC X(4).                                    080813ma
027400    05 GFF-FIELD2    PIC X(15).                                   080813ma
027500    05 GFF-ENH       PIC X(4).                                    080813ma
027600    05 GFF-FTYPE     PIC X.                                       080813ma
027700    05 GFF-DTYPE     PIC X(4).                                    080813ma
027800    05 GFF-INIT      PIC X(65).                                   080813ma
027900    05 GFF-PROCSPECS PIC X(1300).                                 080831ma
028000                                                                  080813ma
028100                                                                  080813ma
028200                                                                  080813ma
028300 01 FILE-DATA.                                                    080813ma
028400    02 FILE-ERR-ENH PIC X(4) VALUE SPACES.                        080813ma
028500    02 FILE-FLD-ENH PIC X(4) VALUE SPACES.                        080813ma
028600    02 FILE-VERSION PIC X(8) VALUE SPACES.                        080813ma
028700 01 HP-Enhancements.                                              080813ma
028800    02 FILLER  PIC X value "@".                                   080813ma
028900    02 FILLER  PIC X value "A".                                   080813ma
029000    02 FILLER  PIC X value "B".                                   080813ma
029100    02 FILLER  PIC X value "C".                                   080813ma
029200    02 FILLER  PIC X value "D".                                   080813ma
029300    02 FILLER  PIC X value "E".                                   080813ma
029400    02 FILLER  PIC X value "F".                                   080813ma
029500    02 FILLER  PIC X value "G".                                   080813ma
029600    02 FILLER  PIC X value "H".                                   080813ma
029700    02 FILLER  PIC X value "I".                                   080813ma
029800    02 FILLER  PIC X value "J".                                   080813ma
029900    02 FILLER  PIC X value "K".                                   080813ma
030000    02 FILLER  PIC X value "L".                                   080813ma
030100    02 FILLER  PIC X value "M".                                   080813ma
030200    02 FILLER  PIC X value "N".                                   080813ma
030300    02 FILLER  PIC X value "O".                                   080813ma
030400    02 FILLER  PIC X value "S".                                   080813ma
030500    02 FILLER  PIC X VALUE "Z".                                   080813ma
030600 01 HPENH-TABLE REDEFINES HP-Enhancements.                        080813ma
030700    02 HPENH-ENTRIES OCCURS 18 TIMEs.                             080813ma
030800       05 HPENH PIC X.                                            080813ma
030900                                                                  080813ma
031000 01 ENHIDX PIC S9(4) COMP VALUE 0.                                080813ma
031100                                                                  080813ma
031200 01 VPLUS-Enhancements.                                           080813ma
031300    02 FILLER PIC X(4) VALUE "NONE".                              080813ma
031400    02 FILLER PIC X(4) VALUE "B   ".                              080813ma
031500    02 FILLER PIC X(4) VALUE "I   ".                              080813ma
031600    02 FILLER PIC X(4) VALUE "BI  ".                              080813ma
031700    02 FILLER PIC X(4) VALUE "U   ".                              080813ma
031800    02 FILLER PIC X(4) VALUE "BU  ".                              080813ma
031900    02 FILLER PIC X(4) VALUE "IU  ".                              080813ma
032000    02 FILLER PIC X(4) VALUE "BIU ".                              080813ma
032100    02 FILLER PIC X(4) VALUE "H   ".                              080813ma
032200    02 FILLER PIC X(4) VALUE "BH  ".                              080813ma
032300    02 FILLER PIC X(4) VALUE "IH  ".                              080813ma
032400    02 FILLER PIC X(4) VALUE "BIH ".                              080813ma
032500    02 FILLER PIC X(4) VALUE "UH  ".                              080813ma
032600    02 FILLER PIC X(4) VALUE "BUH ".                              080813ma
032700    02 FILLER PIC X(4) VALUE "IUH ".                              080813ma
032800    02 FILLER PIC X(4) VALUE "BIUH".                              080813ma
032900    02 FILLER PIC X(4) VALUE "S   ".                              080813ma
033000    02 FILLER PIC X(4) VALUE "ERR ".                              080813ma
033100 01 VPLUSENH-TABLE REDEFINES VPLUS-Enhancements.                  080813ma
033200    02 VPLUSENH-ENTRIES OCCURS 18 TIMEs.                          080813ma
033300       05 VPLUSENH PIC X(4).                                      080813ma
033500 01 ALL-ROWS.                                                     080813ma
033600    02 FORM-SCRNORD PIC S9(4) COMP.                               080813ma
033700    02 ODFLEN       PIC S9(4) COMP.                               080813ma
033800    02 ODF          PIC S9(4) COMP.                               080813ma
033900    02 ROWIDX       PIC S9(4) COMP VALUE 0.                       080813ma
034000    02 ROWCNT       PIC S9(4) COMP VALUE 0.                       080813ma
034100    02 ROWMAX       PIC S9(4) COMP VALUE 26.                      080813ma
034200    02 ROWSTART     PIC S9(4) COMP VALUE 1.                       080813ma
034300    02 ROWEND       PIC S9(4) COMP VALUE 0.                       080813ma
034400    02 ROWLEN       PIC S9(4) COMP VALUE 0.                       080813ma
034500    02 ROW-COLUMN       PIC S9(4) COMP VALUE 0.                   080813ma
034600    02 ROW-ENTRIES OCCURS 40 TIMES.                               080813ma
034700       05 ROWSTR PIC X(256).                                      080813ma
034800       05 OBJIDX PIC S9(4) COMP.                                  080813ma
034900       05 OBJCNT PIC S9(4) COMP.                                  080813ma
035000       05 ROW-OBJECTS OCCURS 80.                                  080813ma
035100          10 OBJ-TYPE     PIC XX.                                 ma080814
035200          10 OBJ-fTYPE    PIC X.                                  ma080814
035300          10 OBJ-dTYPE    PIC XxxX.                               ma080814
035400          10 OBJ-Enh      PIC X.                                  ma080814
035500          10 OBJ-NAME     PIC X(16).                              ma080814
035600          10 OBJ-SRNORD   PIC S9(4) COMP.                         ma080814
035700          10 OBJ-STRTCOL  PIC S9(4) COMP.                         ma080814
035800          10 OBJ-STRTROW  PIC S9(4) COMP.                         ma080814
035900          10 OBJ-ENDCOL   PIC S9(4) COMP.                         ma080814
036000          10 OBJ-ENDROW   PIC S9(4) COMP.                         ma080814
036100          10 OBJ-VALUE    PIC X(80).                              ma080814
036200          10 OBJ-FLDNUM   PIC S9(4) COMP.                         ma080814
036300          10 OBJ-LEN      PIC S9(4) COMP.                         ma080814
036400                                                                  ma080814
036500                                                                  080813ma
036600 01 NEW-TEXT-AREA.                                                080813ma
036700    05 END-ROW-SW     PIC X VALUE "0".                            080813ma
036800       88 END-OF-ROW  VALUE "1".                                  080813ma
036900    05 TEXT-COLUMN       PIC S9(4) COMP VALUE 0.                  080813ma
037000    05 TEXT-ROW          PIC S9(4) COMP VALUE 0.                  080813ma
037100    05 TXIDX             PIC S9(4) COMP VALUE 0.                  080813ma
037200    05 TEXT-CHAR         PIC S9(4) COMP VALUE 0.                  080813ma
037300    05 TEXT-FIELDS.                                               080813ma
037400       10 TXPTR-START          PIC S9(4) COMP VALUE 0.            080813ma
037500       10 TXPTR                PIC S9(4) COMP VALUE 0.            080813ma
037600       10 TEXT-ENH             PIC X  VALUE "@".                  080813ma
037700       10 NON-TEXT-SW          PIC X  VALUE "0".                  080813ma
037800          88 IN-TEXT-AREA   VALUE "0".                            080813ma
037900          88 IN-NON-TEXT    VALUE "1".                            080813ma
038000       10 NEW-TEXT-FOUND-SW    PIC X  VALUE "0".                  080813ma
038100          88 NEW-TEXT-FOUND VALUE "1".                            080813ma
038200       10 TEXT-FLDCNT          PIC S9(4) COMP VALUE 0.            080813ma
038300       10 TEXT-FIELD-ENTRIES OCCURS 40 TIMES.                     080813ma
038400          20 TEXT-FLDCOL    PIC S9(4) COMP.                       080813ma
038500          20 TEXT-FLDROW    PIC S9(4) COMP.                       080813ma
038600          20 TEXT-FLDENH    PIC X.                                080813ma
038700          20 TEXT-FLDSTR    PIC X(80).                            080813ma
038800          20 TEXT-FLDLEN    PIC S9(4) COMP.                       080813ma
038900                                                                  080825MA
039000 01 btnrow-data.                                                  080825MA
039100    05 brwidx     pic s9(4) comp value 0.                         080825MA
039200    05 brwcnt     pic s9(4) comp value 0.                         080825MA
039300    05 nxkey-x    pic s9(4) comp value 0.                         080825MA
039400    05 nxkey-y    pic s9(4) comp value 0.                         080825MA
039500    05 nxchr-cnt  pic s9(4) comp value 0.                         080825MA
039600    05 nxlbl      pic x(32) value spaces.                         080828MA
039700    05 Next-Label pic x(8)  value spaces.                         080825MA
039800    05 btn        pic x(8) OCCURS 8.                              080825MA
039900                                                                  080825MA
040000 01 TEXT-BUTTONS.                                                 080821MA
040100       10 TEXT-BTNCNT          PIC S9(4) COMP VALUE 0.            080813ma
040200       10 TEXT-Button-ENTRIES OCCURS 8 TIMES.                     080813ma
040300          20 TEXT-BTNCOL    PIC S9(4) COMP.                       080813ma
040400          20 TEXT-BTNROW    PIC S9(4) COMP.                       080813ma
040500          20 TEXT-BTNENH    PIC X.                                080813ma
040600          20 TEXT-BTNSTR    PIC X(16).                            080813ma
040700          20 TEXT-BTNLEN    PIC S9(4) COMP.                       080813ma
040800       10 Text-Keys.                                              080813ma
040900          15 Txkey1-1 Pic X(8) Value Spaces.                      080813ma
041000          15 Txkey2-1 Pic X(8) Value Spaces.                      080813ma
041100          15 Txkey3-1 Pic X(8) Value Spaces.                      080813ma
041200          15 Txkey4-1 Pic X(8) Value Spaces.                      080813ma
041300          15 Txkey5-1 Pic X(8) Value Spaces.                      080813ma
041400          15 Txkey6-1 Pic X(8) Value Spaces.                      080813ma
041500          15 Txkey7-1 Pic X(8) Value Spaces.                      080813ma
041600          15 Txkey8-1 Pic X(8) Value Spaces.                      080813ma
041700          15 Txkey1-2 Pic X(8) Value Spaces.                      080813ma
041800          15 Txkey2-2 Pic X(8) Value Spaces.                      080813ma
041900          15 Txkey3-2 Pic X(8) Value Spaces.                      080813ma
042000          15 Txkey4-2 Pic X(8) Value Spaces.                      080813ma
042100          15 Txkey5-2 Pic X(8) Value Spaces.                      080813ma
042200          15 Txkey6-2 Pic X(8) Value Spaces.                      080813ma
042300          15 Txkey7-2 Pic X(8) Value Spaces.                      080813ma
042400          15 Txkey8-2 Pic X(8) Value Spaces.                      080813ma
042500                                                                  080813ma
042600 01 Design-Area.                                                  080813ma
042700    02 Design-name        Pic X(16).                              080813ma
042800    02 Deslen             Pic S9(9) Comp.                         080813ma
042900    02 F-DESIGN-LEN       Pic S9(9) Comp.                         080813ma
043000    02 F-Design           Pic X(16384).                           080830ma
043100    02 F-DESIGN-POINTERS.                                         080813ma
043200       05 FDPIDX PIC S9(4) COMP VALUE 0.                          080813ma
043300       05 FDPCNT PIC S9(4) COMP VALUE 0.                          080813ma
043400       05 FDP-ARRAY OCCURS 110 TIMES.                             080830ma
043500          10 FDP-LEN  PIC S9(9) COMP.                             080813ma
043600          10 FDP-STRT PIC S9(9) COMP.                             080813ma
043700          10 FDP-END  PIC S9(9) COMP.                             080813ma
043800    02 V-DESIGN-LEN       Pic S9(9) Comp.                         080813ma
043900    02 V-Design           Pic X(16384).                           080830ma
044000    02 V-DESIGN-POINTERS.                                         080813ma
044100       05 VDPIDX PIC S9(4) COMP VALUE 0.                          080813ma
044200       05 VDPCNT PIC S9(4) COMP VALUE 0.                          080813ma
044300       05 VDP-ARRAY OCCURS 110 TIMES.                             080830ma
044400          10 VDP-LEN  PIC S9(9) COMP.                             080813ma
044500          10 VDP-STRT PIC S9(9) COMP.                             080813ma
044600          10 VDP-END  PIC S9(9) COMP.                             080813ma
044700    02 startx             Pic S9(9) Comp.                         080813ma
044800    02 endx               Pic S9(9) Comp.                         080813ma
044900    02 xidx               Pic S9(9) Comp.                         080813ma
045000    02 V-xlen             Pic S9(4) Comp.                         080813ma
045100    02 F-xlen             Pic S9(4) Comp.                         080813ma
045200                                                                  080813ma
045300 01 Field-x-y.                                                    080813ma
045400    02 Field-Name    Pic x(16) Value Spaces.                      080813ma
045500    02 Field-Column  Pic S9(4) Comp Value 0.                      080813ma
045600    02 Field-Row     Pic S9(4) Comp Value 0.                      080813ma
045700    02 F1            Pic S9(4) Comp Value 0.                      080813ma
045800    02 Found-len     Pic S9(4) Comp Value 0.                      080813ma
045900    02 F-idx         Pic S9(4) Comp Value 0.                      080813ma
046000                                                                  080813ma
046100 01 Form-File-Data.                                               080820MA
046200   02 FDATA-TIMESTAMP      PIC X(32) VALUE SPACES.                080830ma
046300   02 Form-Data-Record.                                           080830ma
046400      05  FDATA-FUNCTION-KEYS.                                    080820MA
046500         10 FKEY OCCURS 8 TIMES.                                  080813ma
046600            15 FKEY-LINE1 PIC X(8).                               080813ma
046700            15 FKEY-LINE2 PIC X(8).                               080813ma
046800 01  GETINFO-DATA.                                                080813ma
046900    05  GINFO-LEN                PIC S9(4) COMP.                  080813ma
047000    05  GINFO-STR                PIC X(128).                      080813ma
047100    05  GINFO-PARM               PIC S9(4) COMP.                  080813ma
047200 01  PARSED-DATA.                                                 080813ma
047300    05  ITEMS-PARSED             PIC S9(4) COMP.                  080813ma
047400        88 PARSE-IS-COMPLETE VALUES ARE 8 THRU 99.                080813ma
047500    05  PARSED-STRING            PIC X(128).                      080813ma
047600    05  NEXT-STRING              PIC X(256).                      080825MA
047700    05  STRING-POINTER             PIC S9(4) COMP.                080813ma
047800    05  GX                       PIC S9(4) COMP.                  080813ma
047900    05  GY                       PIC S9(4) COMP.                  080813ma
048000    05  PX                       PIC S9(4) COMP.                  080813ma
048100 01 ITEM-1                  PIC S9(9)  COMP VALUE 1.              080813ma
048200 01 ITEM-2                  PIC S9(9)  COMP VALUE 2.              080813ma
048300 01 ITEM-11                 PIC S9(9)  COMP VALUE 11.             080813ma
048400 01 VAR-VALUE                PIC 9(3)       VALUE ZERO.           080813ma
048500 01 VAR-NAME                PIC X(15)       VALUE SPACES.         080813ma
048600 01 VAR-STATUS              PIC S9(9)  COMP VALUE 0.              080813ma
048700 01 VAR-VALUE-I             PIC S9(9)  COMP VALUE 0.              080813ma
048800 01 VAR-VALUE-S             PIC X(20)       VALUE SPACES.         080813ma
048900 01 VAR-VALUE-S-SIZE        PIC S9(9)  COMP VALUE 20.             080813ma
049000 01 FLDIDX                 PIC S9(4) COMP.                        080813ma
049100 01 FRMIDX                 PIC S9(4) COMP.                        080813ma
049200 01 MY-NEW-FILCNT          pic s9(9) comp value 0.                080828MA
049300 01 MY-NEW-frmCNT          pic s9(9) comp value 0.                080828MA
049400 01 MY-NEW-fldCNT          pic s9(9) comp value 0.                080828MA
049500 01 MY-NEW-spcCNT          pic s9(9) comp value 0.                080828MA
049600 01 DISP-N2                PIC ZZZ9.                              080813ma
049700 01  FULL-CURRENT-DATE.                                           080813ma
049800         05  C-DATE.                                              080813ma
049900             10  C-YEAR       PIC 9(4).                           080813ma
050000             10  C-MONTH      PIC 99.                             080813ma
050100             10  C-DAY        PIC 99.                             080813ma
050200         05  C-TIME.                                              080813ma
050300             10  C-HOUR       PIC 99.                             080813ma
050400             10  C-MINUTES    PIC 99.                             080813ma
050500             10  C-SECONDS    PIC 99.                             080813ma
050600             10  C-SEC-HUND   PIC 99.                             080813ma
050700         05  C-TIME-DIFF.                                         080813ma
050800             10  O-GMT-DIR    PIC X.                              080813ma
050900             10  O-HOUR       PIC 99.                             080813ma
051000             10  O-MINUTES    PIC 99.                             080813ma
051100 01 ERROR-MSG                PIC X(80) VALUE SPACES.              080813ma
051200 01 CALLTYPE                 PIC X(20) VALUE SPACES.              080813ma
051300                                                                  080813ma
051400 01 NUMDEC                 PIC S9(4) COMP.                        080813ma
051500 01 NUMERR                 PIC S9(4) COMP.                        080813ma
051600 01 NUM1                   PIC X(14).                             080813ma
051700 01 NUM2                   PIC S9(14). 01  DB-MISC.               080813ma
051800     02  RE-READ           PIC S9(4) COMP VALUE 1.                080813ma
051900     02  MAX-DB            PIC S9(4) COMP VALUE 100.              080813ma
052000     02  SERIAL            PIC S9(4) COMP VALUE 2.                080813ma
052100     02  BACKWARD          PIC S9(4) COMP VALUE 3.                080813ma
052200     02  DIRECT            PIC S9(4) COMP VALUE 4.                080813ma
052300     02  CHAINED           PIC S9(4) COMP VALUE 5.                080813ma
052400     02  BACK-CHAINED      PIC S9(4) COMP VALUE 6.                080813ma
052500     02  KEYED             PIC S9(4) COMP VALUE 7.                080813ma
052600     02  MODE-3            PIC S9(4) COMP VALUE 3.                080813ma
052700     02  MODE-4            PIC S9(4) COMP VALUE 4.                080813ma
052800     02  MODE-20           PIC S9(4) COMP VALUE 20.               080813ma
052900     02  MODE-104          PIC S9(4) COMP VALUE 104.              080813ma
053000     02  MODE-102          PIC S9(4) COMP VALUE 102.              080813ma
053100     02  MODE-103          PIC S9(4) COMP VALUE 103.              080813ma
053200     02  MODE-202          PIC S9(4) COMP VALUE 202.              080813ma
053300     02  MODE-203          PIC S9(4) COMP VALUE 203.              080813ma
053400     02  MODE-301          PIC S9(4) COMP VALUE 301.              080813ma
053500     02  MODE-406          PIC S9(4) COMP VALUE 406.              080813ma
053600     02  MODE-N            PIC S9(4) COMP VALUE 0.                080813ma
053700     02  IREAD-LEN         PIC S9(4) COMP VALUE 0.                080813ma
053800     02  VPLUS-ERRNUM      PIC S9(4) COMP VALUE 0.                080813ma
053900     02  CALL-STRING       PIC X(80) VALUE SPACES.                080813ma
054000     02  CSLEN             PIC S9(4) COMP VALUE 0.                080813ma
054100     02  ERROR-STRING      PIC X(80) VALUE SPACES.                080813ma
054200     02  ESLEN             PIC S9(4) COMP VALUE 0.                080813ma
054300     02  ALL-ITEMS         PIC XX VALUE "@;".                     080813ma
054400     02  SEARCH-ITEM       PIC X(18).                             080813ma
054500     02  STATUS-AREA.                                             080813ma
054600         03  CONDITION-WORD    PIC S9(4) COMP VALUE  0.           080813ma
054700             88  NO-IMAGE-ERRORS         VALUE  0.                080813ma
054800             88  IMAGE-ERRORS                                     080813ma
054900                 VALUES ARE -9999 THRU -1, 1 THRU  9999.          080813ma
055000             88  END-OF-FILE             VALUE 11.                080813ma
055100             88  BEG-OF-FILE             VALUE 12.                080813ma
055200             88  BEG-OF-CHAIN            VALUE 14.                080813ma
055300             88  END-OF-CHAIN            VALUE 15.                080813ma
055400             88  NO-ENTRY                VALUE 17.                080813ma
055500         03  RECORD-LENGTH     PIC S9(4) COMP VALUE  0.           080813ma
055600         03  RECORD-NUMBER     PIC S9(9) COMP VALUE  0.           080813ma
055700         03  ENTRIES-IN-CHAIN  PIC S9(9) COMP VALUE  0.           080813ma
055800         03  PREV-RECORD-NO    PIC S9(9) COMP VALUE  0.           080813ma
055900         03  NEXT-RECORD-NO    PIC S9(9) COMP VALUE  0.           080813ma
056000 01  FIRST-TIME-SW         PIC X.                                 080813ma
056100     88  FIRST-TIME        VALUE "1".                             080813ma
056200                                                                  080820MA
056300 01  E-Record-Found-Sw     Pic X Value "0".                       080820MA
056400     88 E-Record-Found           Value "1".                       080820MA
056500                                                                  080820MA
056600 01  POINTER-LINK-SW         PIC X.                               080813ma
056700     88  POINTERS-LINKED        VALUE "1".                        080813ma
056800                                                                  080813ma
056900 01  VALID-T-SW         PIC X.                                    080813ma
057000     88  VALID-T        VALUE "1".                                080813ma
057100                                                                  080813ma
057200 01  VALID-D-SW         PIC X.                                    080813ma
057300     88  VALID-D        VALUE "1".                                080813ma
057400                                                                  080813ma
057500 01  VALID-G-SW         PIC X.                                    080813ma
057600     88  VALID-G        VALUE "1".                                080813ma
057700                                                                  080813ma
057800 01  FIRST-TIME-SW         PIC X.                                 080813ma
057900     88  FIRST-TIME        VALUE "1".                             080813ma
058000 01  infield-sw         PIC X.                                    080813ma
058100     88  infield        VALUE "1".                                080813ma
058200                                                                  080813ma
058300*01  ERRORS-SW             PIC X.                                 080813ma
058400*    88  ERRORS            VALUE "1".                             080813ma
058500                                                                  080813ma
058600 01  NONBLANK-SW         PIC X.                                   080813ma
058700     88  NONBLANK        VALUE "1".                               080813ma
058800                                                                  080813ma
058900 01  MATCH-SW        PIC X.                                       080813ma
059000     88  MATCH-FOUND       VALUE "1".                             080813ma
059100                                                                  080813ma
059200 01  EDIT-ERRORS-SW        PIC X.                                 080813ma
059300     88  EDIT-ERRORS       VALUE "1".                             080813ma
059400                                                                  080813ma
059500 01  BAD-KEY-SW            PIC X.                                 080813ma
059600     88  BAD-KEY           VALUE "1".                             080813ma
059700                                                                  080813ma
059800 01  Last-Column-SW       PIC X.                                  080813ma
059900     88  Last-Column      VALUE "1".                              080813ma
060000                                                                  080813ma
060100 01  X-FLOWTEST-JCW          PIC X(8) VALUE "FLOWTEST".           080813ma
060200 01  X-FLOWTEST-VALUE        PIC S9(4) COMP VALUE 0.              080813ma
060300     88  X-FLOWTEST          VALUE 1.                             080813ma
060400                                                                  080813ma
060500 01 TARGET-FIELD                    PIC X(64) VALUE SPACES.       080813ma
060600 01 DWNSHFT-SW                      PIC X.                        080813ma
060700    88 OK-TO-DOWNSHIFT VALUE "1".                                 080813ma
060800 01 MYIDX                           PIC S9(4) COMP VALUE 0.       080813ma
060900 01 SOURCE-FIELD                    PIC X(64) VALUE SPACES.       080813ma
061000 01 ASCII-CHARACTERS.                                             080813ma
061100    02 TWO-BYTES                    PIC XX VALUE SPACES.          080813ma
061200    02 SIXTEEN-BITS REDEFINES TWO-BYTES.                          080813ma
061300       05 ASCII-INT                 PIC S9(4) COMP.               080813ma
061400    02 TWO-CHARS    REDEFINES TWO-BYTES.                          080813ma
061500       05 FILLER                    PIC X.                        080813ma
061600       05 ASCII-CHAR                PIC X.                        080813ma
061700                                                                  080813ma
061800 01  MY-TIMESTAMP             PIC X(28) VALUE SPACES.             ma080814
061900                                                                  ma080814
062000 01 ABORT-SWITCHES.                                               080813ma
062100    02 ON-VPLUS-ERRORS     PIC X VALUE "0".                       080813ma
062200       88 ABORT-ON-VPLUS-ERRORS  VALUE "9".                       080813ma
062300                                                                  080813ma
062400     01  SAVE-STATUS.                                             080813ma
062500         03  CONDITION-SAVED   PIC S9(4) COMP.                    080813ma
062600         03  SAVED-LENGTH      PIC S9(4) COMP.                    080813ma
062700         03  SAVED-NUMBER      PIC S9(9) COMP.                    080813ma
062800         03  SAVED-IN-CHAIN    PIC S9(9) COMP.                    080813ma
062900         03  PREV-SAVED-NO     PIC S9(9) COMP.                    080813ma
063000         03  NEXT-SAVED-NO     PIC S9(9) COMP.                    080813ma
063100                                                                  080813ma
063200 01 A-TABLE-SW               PIC X VALUE "0".                     080813ma
063300    88 ITS-A-TABLE    VALUE "1".                                  080813ma
063400 01 DOW                      PIC S9(4) COMP  VALUE 0.             080813ma
063500 01  MIGDB    PIC S9(4) COMP VALUE  9.                            080813ma
063600 01  MYDB     PIC S9(4) COMP VALUE  9.                            080813ma
063700 01  MIGDB-STATUS.                                                080813ma
063800     03  FILLER    PIC S9(4) COMP VALUE  0.                       080813ma
063900     03  FILLER    PIC S9(4) COMP VALUE  0.                       080813ma
064000     03  FILLER    PIC S9(9) COMP VALUE  0.                       080813ma
064100     03  FILLER    PIC S9(9) COMP VALUE  0.                       080813ma
064200     03  FILLER    PIC S9(9) COMP VALUE  0.                       080813ma
064300     03  FILLER    PIC S9(9) COMP VALUE  0.                       080813ma
064400 01 INSPECT-IDX              PIC S9(4) COMP  VALUE 0.             080813ma
064500 01 NUMDATE                  PIC S9(9) COMP  VALUE 0.             080813ma
064600                                                                  080813ma
064700 01 WHO-INTRINSIC-PARMS.                                          080813ma
064800    15  WHO-TERM-DEV-NO        PIC S9999 COMP.                    080813ma
064900    15  WHO-MODE               PIC S9999 COMP.                    080813ma
065000    15  WHO-CAPABILITY         PIC S9(6) COMP.                    080813ma
065100    15  WHO-LATTR              PIC S9(6) COMP.                    080813ma
065200    15  WHO-USERN.                                                080813ma
065300        20 BYTE1-6             PIC X(6).                          080813ma
065400        20 SCHOOL-NUMBER       PIC XX.                            080813ma
065500    15  WHO-GROUPN             PIC X(8).                          080813ma
065600    15  WHO-ACCTN              PIC X(8).                          080813ma
065700    15  WHO-HOMEN              PIC X(8).                          080813ma
065800 COPY SRVMST OF J3KLIB.                                           080813ma
065900 01 FRMSTR-BUFFER.                                                080813ma
066000    02 FRMSTR-SVR-UNIQUE                 PIC S9(09) COMP VALUE 0. 080813ma
066100    02 FRMSTR-FM-UNIQUE                  PIC S9(09) COMP VALUE 0. 080813ma
066200    02 FRMSTR-FM-NAME                    PIC X(028) VALUE SPACES. 080813ma
066300    02 FRMSTR-FM-CREATOR                 PIC X(008) VALUE SPACES. 080813ma
066400    02 FRMSTR-FM-ACCT                    PIC X(008) VALUE SPACES. 080813ma
066500    02 FRMSTR-FM-GROUP                   PIC X(008) VALUE SPACES. 080813ma
066600    02 FRMSTR-FM-BYTES                   PIC S9(18) COMP VALUE 0. 080813ma
066700    02 FRMSTR-SRC-NAME                   PIC X(032) VALUE SPACES. 080813ma
066800    02 FRMSTR-VERSION                    PIC S9(9)  COMP VALUE 0. 080813ma
066900    02 FRMSTR-LOGPATH                    PIC X(128) VALUE SPACES. 080813ma
067000    02 FRMSTR-FM-FRMCNT                  PIC S9(18) COMP VALUE 0. 080813ma
067100    02 FRMSTR-FM-FLDCNT                  PIC S9(18) COMP VALUE 0. 080813ma
067200    02 FRMSTR-FM-MIG                     PIC X(002) VALUE SPACES. 080813ma
067300    02 FRMSTR-FM-COST                    PIC S9(18) COMP VALUE 0. 080813ma
067400  COPY NXUNIQ OF J3KLIB.                                          080813ma
067500                                                                  080813ma
067600 01 DP-IDX                  PIC S9(9) COMP  VALUE 0.              080813ma
067700 01 MyHpSusan               PIC S9(9) COMP  VALUE 0.              080813ma
067800 01 MyCREATOR               PIC X(8)   VALUE SPACES.              080813ma
067900 01 MYACCOUNT               PIC X(8)   VALUE SPACES.              080813ma
068000 01 MYGROUP               PIC X(8)   VALUE SPACES.                080813ma
068100 01 LINK-USER  PIC X(8) VALUE SPACES.                             080813ma
068200 01 LINK-UPASS PIC X(8) VALUE SPACES.                             080813ma
068300 01 LINK-ACCT  PIC X(8) VALUE SPACES.                             080813ma
068400 01 LINK-APASS PIC X(8) VALUE SPACES.                             080813ma
068500 01 LINK-GROUP PIC X(8) VALUE SPACES.                             080813ma
068600 01 LINK-GPASS PIC X(8) VALUE SPACES.                             080813ma
068700 01  speclen               PIC S9(4) COMP.                        080813ma
068800 01  specidx               pic s9(4) comp.                        080828MA
068900 01 chrcnt                 pic s9(4) comp.                        080828MA
069000 01 chridx                 pic s9(4) comp.                        080828MA
069100 01  DATA-LEN              PIC S9(4) COMP.                        080813ma
069200                                                                  080813ma
069300 01 MYCOST      PIC S9(18) COMP VALUE 0.                          080813ma
069400 01 TOTAL-FILES      PIC S9(18) COMP VALUE 0.                     080813ma
069500 01 TOTAL-FORMS       PIC S9(18) COMP VALUE 0.                    080813ma
069600 01 TOTAL-FIELDS     PIC S9(18) COMP VALUE 0.                     080813ma
069700 01 CAPACITY-FILES   PIC S9(18) COMP VALUE 0.                     080813ma
069800 01 CAPACITY-SPECS   pic s9(18) comp value 0.                     080828MA
069900 01 CAPACITY-FORMS    PIC S9(18) COMP VALUE 0.                    080813ma
070000 01 CAPACITY-FIELDS  PIC S9(18) COMP VALUE 0.                     080813ma
070100 01 MYMONEY     PIC S9(18) COMP VALUE 0.                          080813ma
070200 01 MYBYTES     PIC S9(18) COMP VALUE 0.                          080813ma
070300 01 MYMSG                   PIC X(79) VALUE SPACES.               080813ma
070400 01 SI-IDX                  PIC S9(9) COMP  VALUE 0.              080813ma
070500 01 CMD                     PIC X(255)      VALUE SPACES.         080813ma
070600 01 M               Pic X(78) Value Spaces.                       080813ma
070700 01 CSTR                     PIC X(255)      VALUE SPACES.        080813ma
070800 01 CERR                     PIC S9(4) COMP  VALUE 0.             080813ma
070900 01 CPARM                    PIC S9(4) COMP  VALUE 0.             080813ma
071000 01 CMSG                     PIC S9(4) COMP  VALUE 2.             080813ma
071100 01 STR-PTR                  PIC S9(4) COMP  VALUE 0.             080813ma
071200 01 OCCURS-VALUE             PIC S9(4) COMP  VALUE 0.             080813ma
071300 01  EXTFILE-STATUS            PIC X   VALUE "0".                 080813ma
071400     88 EXTFILE-EOF                    VALUE "9".                 080813ma
071500 01 OCCURS-LAST              PIC S9(4) COMP  VALUE 0.             080813ma
071600 01 My-BaseName              Pic X(6) Value Spaces.               080813ma
071700 01 OCCURS-PTR               PIC S9(4) COMP  VALUE 0.             080813ma
071800 01 NUM-X                    PIC S9(4) COMP  VALUE 0.             080813ma
071900 01 MYINCREMENT              PIC S9(4) COMP  VALUE 0.             080813ma
072000                                                                  080813ma
072100 01 My-Bytes                  pic S9(4) Comp  Value 0.            080813ma
072200 01 DASH-PTR                 PIC S9(4) COMP  VALUE 0.             080813ma
072300 01 VAR-LEN                  PIC S9(4) COMP  VALUE 0.             080813ma
072400 01 SHOWTIME-STR.                                                 080813ma
072500    02 FILLER PIC X(8) VALUE "SHOWTIME".                          080813ma
072600    02 FILLER PIC X    VALUE %15.                                 080813ma
072700 01 DATE-EDITING.                                                 080813ma
072800    05 RAW-DATE.                                                  080813ma
072900       10 D1     PIC X   VALUE SPACES.                            080813ma
073000       10 D2     PIC X   VALUE SPACES.                            080813ma
073100       10 D3     PIC X   VALUE SPACES.                            080813ma
073200       10 D4     PIC X   VALUE SPACES.                            080813ma
073300       10 D5     PIC X   VALUE SPACES.                            080813ma
073400       10 D6     PIC X   VALUE SPACES.                            080813ma
073500       10 D7     PIC X   VALUE SPACES.                            080813ma
073600       10 D8     PIC X   VALUE SPACES.                            080813ma
073700    05 EDITED-DATE.                                               080813ma
073800       10 D5     PIC X   VALUE SPACES.                            080813ma
073900       10 D6     PIC X   VALUE SPACES.                            080813ma
074000       10 FILLER PIC X   VALUE "/".                               080813ma
074100       10 D7     PIC X   VALUE SPACES.                            080813ma
074200       10 D8     PIC X   VALUE SPACES.                            080813ma
074300       10 FILLER PIC X   VALUE "/".                               080813ma
074400       10 D1     PIC X   VALUE SPACES.                            080813ma
074500       10 D2     PIC X   VALUE SPACES.                            080813ma
074600       10 D3     PIC X   VALUE SPACES.                            080813ma
074700       10 D4     PIC X   VALUE SPACES.                            080813ma
074800                                                                  080813ma
074900                                                                  080813ma
075000 01 Db-Info-406-Word-17.                                          080813ma
075100    05  BIT1             PIC 9.                                   080813ma
075200    05  BIT2             PIC 9.                                   080813ma
075300    05  BIT3             PIC 9.                                   080813ma
075400    05  BIT4             PIC 9.                                   080813ma
075500    05  BIT5             PIC 9.                                   080813ma
075600    05  BIT6             PIC 9.                                   080813ma
075700    05  BIT7             PIC 9.                                   080813ma
075800    05  BIT8             PIC 9.                                   080813ma
075900    05  BIT9             PIC 9.                                   080813ma
076000        88 Database-Newlimits Value 1.                            080813ma
076100        88 Database-Oldlimits Value 0.                            080813ma
076200    05  BIT10            PIC 9.                                   080813ma
076300        88 Database-Entrynumber-Format Value 1.                   080813ma
076400        88 Database-Entryname-Format   Value 0.                   080813ma
076500    05  BIT11            PIC 9.                                   080813ma
076600    05  BIT12            PIC 9.                                   080813ma
076700        88 Expandable-Master-Dataset     Value 1.                 080813ma
076800        88 No-Expandable-Master-Dataset   Value 0.                080813ma
076900    05  BIT13            PIC 9.                                   080813ma
077000        88 B-Tree      Value 1.                                   080813ma
077100        88 No-B-Tree   Value 0.                                   080813ma
077200    05  BIT14            PIC 9.                                   080813ma
077300    05  BIT15            PIC 9.                                   080813ma
077400    05  BIT16            PIC 9.                                   080813ma
077500 01  BINARY-VALUE.                                                080813ma
077600     05 BIT-ZERO                     PIC 9.                       080813ma
077700     05 BIT OCCURS 15 TIMES          PIC 9.                       080813ma
077800 01 REPORT-BUFFER.                                                080813ma
077900    05 RPT-VFLD-NAME       PIC X(15).                             080813ma
078000    05 FILLER PIC XX VALUE SPACE.                                 080813ma
078100    05 RPT-BUF-X           PIC ZZZ9.                              080813ma
078200    05 FILLER PIC XX VALUE SPACE.                                 080813ma
078300    05 RPT-BUF-Y           PIC ZZZ9.                              080813ma
078400    05 FILLER PIC XX VALUE SPACE.                                 080813ma
078500    05 RPT-SRN-X           PIC Z9.                                080813ma
078600    05 FILLER PIC XX VALUE SPACE.                                 080813ma
078700    05 RPT-SRN-Y           PIC Z9.                                080813ma
078800    05 FILLER PIC XX VALUE SPACE.                                 080813ma
078900    05 RPT-SRN-ORD-NUM     PIC ZZ9.                               080813ma
079000    05 FILLER PIC XX VALUE SPACE.                                 080813ma
079100    05 RPT-VFLD-NUM        PIC ZZ9.                               080813ma
079200    05 FILLER PIC XX VALUE SPACE.                                 080813ma
079300    05 RPT-VFLD-LENGTH     PIC ZZ9.                               080813ma
079400    05 FILLER PIC XX VALUE SPACE.                                 080813ma
079500    05 RPT-VFLD-POSITION   PIC ZZZ9.                              080813ma
079600    05 FILLER PIC XX VALUE SPACE.                                 080813ma
079700    05 RPT-VFLD-ENHANCE    PIC XXXX.                              080813ma
079800    05 FILLER PIC XX VALUE SPACE.                                 080813ma
079900    05 RPT-VFLD-TYPE       PIC XX.                                080813ma
080000    05 FILLER PIC XX VALUE SPACE.                                 080813ma
080100    05 RPT-VFLD-DATATYPE   PIC XXXX.                              080813ma
080200 01 REPORT-HEADER.                                                080813ma
080300    05 FILLER       PIC X(15) VALUE "FIELD NAME".                 080813ma
080400    05 FILLER PIC XX VALUE SPACE.                                 080813ma
080500    05 FILLER           PIC XXXX VALUE " BFX".                    080813ma
080600    05 FILLER PIC XX VALUE SPACE.                                 080813ma
080700    05 FILLER           PIC XXXX VALUE " BFY".                    080813ma
080800    05 FILLER PIC XX VALUE SPACE.                                 080813ma
080900    05 FILLER           PIC XX VALUE " X".                        080813ma
081000    05 FILLER PIC XX VALUE SPACE.                                 080813ma
081100    05 FILLER           PIC XX VALUE "Y".                         080813ma
081200    05 FILLER PIC XX VALUE SPACE.                                 080813ma
081300    05 FILLER     PIC XXX VALUE "ORD".                            080813ma
081400    05 FILLER PIC XX VALUE SPACE.                                 080813ma
081500    05 FILLER        PIC XXX VALUE "NUM".                         080813ma
081600    05 FILLER PIC XX VALUE SPACE.                                 080813ma
081700    05 FILLER     PIC XXX VALUE "LEN".                            080813ma
081800    05 FILLER PIC XX VALUE SPACE.                                 080813ma
081900    05 FILLER   PIC XXXX VALUE " POS".                            080813ma
082000    05 FILLER PIC XX VALUE SPACE.                                 080813ma
082100    05 FILLER    PIC XXXX VALUE "ENH".                            080813ma
082200    05 FILLER PIC XX VALUE SPACE.                                 080813ma
082300    05 FILLER       PIC XX VALUE "TY".                            080813ma
082400    05 FILLER PIC XX VALUE SPACE.                                 080813ma
082500    05 FILLER   PIC XXXX VALUE "DATA".                            080813ma
082600                                                                  080813ma
082700 01 NUMERIC-EDITS.                                                080813ma
082800    02 Split-Word        Pic S9(4) Comp.                          080813ma
082900    02 Splating-a-word Redefines Split-Word.                      080813ma
083000       05 Split-Word-1 Pic x.                                     080813ma
083100       05 Split-Word-2 Pic x.                                     080813ma
083200    02 CHR3              PIC XXX.                                 080813ma
083300    02 Y1                PIC 9.                                   080813ma
083400    02 Y2                PIC 99.                                  080813ma
083500    02 Y3                PIC 999.                                 080813ma
083600    02 Y4                PIC 9999.                                080813ma
083700    02 Y5                PIC 99999.                               080813ma
083800    02 CHR6              PIC XXXXXX.                              080813ma
083900    02 Z1                PIC 9.                                   080813ma
084000    02 Z2                PIC 99.                                  080813ma
084100    02 Z3                PIC 999.                                 080813ma
084200    02 Z4                PIC 9999.                                080813ma
084300    02 Z5                PIC 99999.                               080813ma
084400    02 COLUMN-BYTES    PIC S9(4) COMP.                            080813ma
084500                                                                  080813ma
084600 01 FILE-INFOBUF.                                                 080813ma
084700    05 FILE-NUMBER-OF-ENTRIES      PIC S9(4) COMP.                080813ma
084800    05 FILE-ENTRY-LENGTH           PIC S9(4) COMP.                080813ma
084900    05 FILE-ENTRY-TABLE OCCURS 1 TIMES.                           080813ma
085000       10 IN-FILE-VERSION          PIC S9(8) COMP.                080813ma
085100       10 FILE-NUMBER-OF-FORMS     PIC S9(4) COMP.                080813ma
085200       10 FILE-MAX-FIELDS          PIC S9(4) COMP.                080813ma
085300       10 FILE-MAX-BUFSIZE         PIC S9(4) COMP.                080813ma
085400       10 FILE-SAVE-FIELDS         PIC S9(4) COMP.                080813ma
085500       10 FILE-HEAD-FORM           PIC X(15).                     080813ma
085600       10 FILE-FILLER              PIC X.                         080813ma
085700       10 FILE-ERROR-ENHANCE       PIC X(4).                      080813ma
085800       10 FILE-WINDOW-ENHANCE      PIC X(4).                      080813ma
085900       10 FILE-WINDOW-POSITION     PIC S9(4) COMP.                080813ma
086000 01 FILE-INFOBUFLEN           PIC S9(4) COMP VALUE 21.            080813ma
086100***************************************** VGETFILEINFO EXAMPLE    080813ma
086200*     MOVE SPACES TO FILE-INFOBUF.                                080813ma
086300*     MOVE 1 TO FILE-NUMBER-OF-ENTRIES.                           080813ma
086400*     MOVE 19 TO FILE-ENTRY-LENGTH.                               080813ma
086500*     CALL "VGETFILEINFO" USING SCREEN-COMAREA,                   080813ma
086600*                               FILE-INFOBUF, FILE-INFOBUFLEN.    080813ma
086700*     IF VPLUS-ERRORS PERFORM 9000-VPLUS-ERROR.                   080813ma
086800                                                                  080813ma
086900 01 FORM-INFOBUF.                                                 080813ma
087000   05 FORM-NUMBER-OF-ENTRIES  PIC S9(4) COMP.                     080813ma
087100   05 FORM-ENTRY-LENGTH       PIC S9(4) COMP.                     080813ma
087200   05 FORM-ENTRY-TABLE OCCURS 256 TIMES.                          080813ma
087300      10 FORM-FORM-NAME            PIC X(15).                     080813ma
087400      10 FORM-FILLER1              PIC X.                         080813ma
087500      10 FORM-FORM-NUMBER          PIC S9(4) COMP.                080813ma
087600      10 FORM-NUMBER-OF-FIELDS     PIC S9(4) COMP.                080813ma
087700      10 FORM-BUF-LENGTH           PIC S9(4) COMP.                080813ma
087800      10 FORM-NEXT-FORM            PIC X(15).                     080813ma
087900      10 FORM-FILLER2              PIC X.                         080813ma
088000      10 FORM-REPEAT-OPTION        PIC X.                         080813ma
088100      10 FORM-NFORM-OPTION         PIC X.                         080813ma
088200 01 FORM-INFOBUFLEN            PIC S9(4) COMP VALUE 62.           080813ma
088300                                                                  080813ma
088400 01 ACTUAL-FORM-COUNT pic s9(4) comp value 0.                     ma080814
088500                                                                  080813ma
088600***************************************** VGETFORMINFO EXAMPLE    080813ma
088700*MOVE SPACES TO FORM-INFOBUF.                                     080813ma
088800*:                                                                080813ma
088900*MOVE 3 TO FORM-NUMBER-OF-ENTRIES.                                080813ma
089000*MOVE 20 TO FORM-ENTRY-LENGTH.                                    080813ma
089100*MOVE "FORM1 " TO FORM-FORM-NAME.                                 080813ma
089200*CALL "VGETFORMINFO" USING SCREEN-COMAREA,                        080813ma
089300*                          FORM-INFOBUF, FORM-INFOBUFLEN.         080813ma
089400                                                                  080813ma
089500                                                                  080813ma
089600 01 SPECIDX1              PIC S9(4) COMP VALUE 0.                 080813ma
089700 01 SPECIDX2              PIC S9(4) COMP VALUE 0.                 080813ma
089800 01 SPECIDX3              PIC S9(4) COMP VALUE 0.                 080813ma
089900 01 FIELD-SPECBUFLEN      PIC S9(4) COMP VALUE 0.                 080813ma
090000 01 FIELD-SPECBUF.                                                080813ma
090100    05 SPECBUFF-ENTRIES OCCURS 512 TIMES.                         080813ma
090200       10 SCRN-ODR-FLDNBR PIC S9(4) COMP.                         080813ma
090300       10 CHGTYP          PIC S9(4) COMP.                         080813ma
090400       10 FLD-SPEC        PIC XXXX.                               080813ma
090500                                                                  080813ma
090600 01 FIELD-INFOBUF.                                                080813ma
090700    05 FIELD-NUMBER-OF-ENTRIES PIC S9(4) COMP.                    080813ma
090800    05 FIELD-ENTRY-LENGTH      PIC S9(4) COMP.                    080813ma
090900    05 FIELD-FORM-NAME         PIC X(15).                         080813ma
091000    05 FIELD-FILLER            PIC X.                             080813ma
091100    05 FIELD-ENTRY-TABLE OCCURS 128 TIMES.                        080813ma
091200       10 FIELD-FIELD-NAME     PIC X(15).                         080813ma
091300       10 FIELD-FILLER         PIC X.                             080813ma
091400       10 FIELD-SCREEN-ORD-NUM PIC S9(4) COMP.                    080813ma
091500       10 FIELD-NUM            PIC S9(4) COMP.                    080813ma
091600       10 FIELD-LENGTH         PIC S9(4) COMP.                    080813ma
091700       10 FIELD-POSITION       PIC S9(4) COMP.                    080813ma
091800       10 FIELD-ENHANCE        PIC X(4).                          080813ma
091900 01 FIELD-INFOBUFLEN           PIC S9(4) COMP VALUE 80.           080813ma
092000 01  THIS-TIMESTAMP.                                              ma080814
092100     05 TS-LAYOUT.                                                ma080814
092200        10 VTIMESTAMP     PIC S9(9) COMP.                         ma080814
092300        10 VTS-BYTES REDEFINES VTIMESTAMP.                        ma080814
092400         12 VTS-WORD1 PIC S9(4) COMP.                             ma080814
092500         12 VTS-WORD1-BIT REDEFINES VTS-WORD1 PIC XX.             ma080814
092600         12 VTS-WORD2 PIC S9(4) COMP.                             ma080814
092700         12 VTS-WORD2-BIT REDEFINES VTS-WORD2 PIC XX.             ma080814
092800        10 CALENDAR-PARM.                                         ma080814
092900            15 CAL-INT    PIC S9(4) COMP.                         ma080814
093000        10 CLOCK-PARM.                                            ma080814
093100            15 CLOCK-DINT PIC S9(9) COMP.                         ma080814
093200        10 THIS-CLOCK REDEFINES  CLOCK-PARM.                      ma080814
093300         12 CLK-WORD1 PIC S9(4) COMP.                             ma080814
093400         12 CLK-WORD1-BIT REDEFINES CLK-WORD1 PIC XX.             ma080814
093500         12 CLK-WORD2 PIC S9(4) COMP.                             ma080814
093600         12 CLK-WORD1-BIT REDEFINES CLK-WORD2 PIC XX.             ma080814
093700                                                                  ma080814
093800                                                                  ma080814
093900 01 Collate-Str          Pic x(64).                               080813ma
094000 01  TDAY                PIC X(8)  VALUE SPACES.                  080813ma
094100 01  TNUMDAY             PIC S9(9) COMP VALUE 0.                  080813ma
094200 01  TDOW                PIC S9(4) COMP VALUE 0.                  080813ma
094300 01  DDAY                PIC X(8)  VALUE SPACES.                  080813ma
094400 01  DNUMDAY             PIC S9(9) COMP VALUE 0.                  080813ma
094500 01  DDOW                PIC S9(4) COMP VALUE 0.                  080813ma
094600 01  DCNT                PIC S9(4) COMP VALUE 0.                  080813ma
094700 01  PICZ5 PIC Z,ZZZ.                                             080813ma
094800 01  WS-LOGON-DESC                       VALUE SPACES.            080813ma
094900     05  WS-LD-JOB-NAME      PIC  X(16).                          080813ma
095000     05  WS-LD-ACCT-NAME     PIC  X(16).                          080813ma
095100     05  WS-LD-ACCT-PASS     PIC  X(16).                          080813ma
095200     05  WS-LD-USER-NAME     PIC  X(16).                          080813ma
095300     05  WS-LD-USER-PASS     PIC  X(16).                          080813ma
095400     05  WS-LD-GROUP-NAME    PIC  X(16).                          080813ma
095500     05  WS-LD-GROUP-PASS    PIC  X(16).                          080813ma
095600 01  WS-ERR PIC S9(4) COMP VALUE 0.                               080813ma
095700 01  WS-ERR-MSG PIC X(80) VALUE SPACES.                           080813ma
095800 01  LAST-CREATOR  PIC X(30) VALUE SPACES.                        080813ma
095900 01  THIS-CREATOR  PIC X(30) VALUE SPACES.                        080813ma
096000 01  IDX           PIC S9(4) COMP VALUE 0.                        080813ma
096100 01  DBMSTR-RECNO  PIC S9(9) COMP VALUE 0.                        080813ma
096200 01  MYTALLY             PIC S9(9) COMP VALUE 0.                  080813ma
096300* 01  TDAY                PIC X(8)  VALUE SPACES.                 080813ma
096400* 01  TNUMDAY             PIC S9(9) COMP VALUE 0.                 080813ma
096500* 01  TDOW                PIC S9(4) COMP VALUE 0.                 080813ma
096600* 01  DDAY                PIC X(8)  VALUE SPACES.                 080813ma
096700* 01  DNUMDAY             PIC S9(9) COMP VALUE 0.                 080813ma
096800* 01  DDOW                PIC S9(4) COMP VALUE 0.                 080813ma
096900 01 OLD-FDFCNT PIC S9(4) COMP VALUE 0.                            080813ma
097000 01  Y                PIC S9(4) COMP VALUE 0.                     080813ma
097100 01 clearscreen.                                                  080813ma
097200    02 filler pic x value %33.                                    080813ma
097300    02 filler pic x value "E".                                    080813ma
097400 01 FKEY-TEST1 PIC X(100) VALUE SPACES.                           080813ma
097500 01 FKEY-TEST2 PIC X(100) VALUE SPACES.                           080813ma
097600 01  DECIMAL-VALUE         PIC S9(4) COMP VALUE 0.                080813ma
097700 01  DISP-N                PIC ZZZ9 VALUE ZERO.                   080813ma
097800 01 EDIT-MESSAGE           PIC X(120).                            080813ma
097900 01 THISFORM-FLDCNT   PIC S9(18) COMP VALUE 0.                    ma080814
098000 01 THISFILE-FRMCNT   PIC S9(18) COMP VALUE 0.                    ma080814
098100 01 IROW                  PIC S9(4) COMP  VALUE 0.                ma080814
098200 01 XCOL                  PIC S9(4) COMP  VALUE 0.                ma080814
098300                                                                  ma080814
098400 COPY FFFLDS  OF J3KLIB.                                          080813ma
098500 COPY FFMSTR  OF J3KLIB.                                          080813ma
098600 COPY FMMSTR  OF J3KLIB.                                          080828MA
098700 COPY prspec  OF J3KLIB.                                          080828MA
098800 COPY AMSCOMM OF J3KLIB.                                          080813ma
098900                                                                  080813ma
099000*=================================================================080813ma
099100$PAGE  "Main logical flow"                                        080813ma
099200*=================================================================080813ma
099300 PROCEDURE DIVISION.                                              080813ma
099400 BEGIN-0000.                                                      080813ma
099500     CALL   INTRINSIC "WHO"                                       080813ma
099600     USING  WHO-MODE WHO-CAPABILITY WHO-LATTR WHO-USERN           080813ma
099700            WHO-GROUPN WHO-ACCTN WHO-HOMEN WHO-TERM-DEV-NO.       080813ma
099800     MOVE WHO-MODE TO USER-MODE.                                  080813ma
099900     IF WHO-ACCTN(1:3) <> "SYS" OR                                080813ma
100000        WHO-USERN(1:7) <> "MANAGER" OR                            080813ma
100100        WHO-GROUPN(1:3) <> "J3K"                                  080813ma
100200       DISPLAY "PLEASE LOGON AS MANAGER.SYS,J3K"                  080813ma
100300       DISPLAY "This program will not run as "                    080813ma
100400               WHO-USERN "." WHO-ACCTN "," WHO-GROUPN             080813ma
100500       STOP RUN.                                                  080813ma
100600     MOVE "VPLUS Documentation Tool version C.7.3" TO M.          080813ma
100700     PERFORM MSG-PROCESS                                          080813ma
100800     MOVE "------------------------------------------------" TO M.080813ma
100900     PERFORM MSG-PROCESS                                          080813ma
101000     MOVE "***            MIG898.PUB.J3K                ***" TO M.080902ma
101100     PERFORM MSG-PROCESS                                          080813ma
101200     MOVE "***                                          ***" TO M.080813ma
101300     PERFORM MSG-PROCESS                                          080813ma
101400     MOVE "***  Calulating capacities for MIGDB.PUB.J3K ***" TO M.080813ma
101500     PERFORM MSG-PROCESS                                          080813ma
101600     MOVE "***                                          ***" TO M.080813ma
101700     PERFORM MSG-PROCESS                                          080813ma
101800     MOVE "------------------------------------------------" TO M.080813ma
101900     PERFORM MSG-PROCESS                                          080813ma
102000     CALL "GETCURRENT" USING TDAY TNUMDAY TDOW.                   080813ma
102100     PERFORM INITIALIZATION.                                      080813ma
102200     PERFORM Process-File.                                        ma080814
102300     PERFORM PROCESS-COMPLETION.                                  080831ma
102400*---------------------------------------------------------------- 080831ma
102500 Process-Completion.                                              080831ma
102600     DISPLAY "files:     " MY-NEW-FILCNT.                         080828MA
102700     DISPLAY "forms:     " MY-NEW-frmCNT.                         080828MA
102800     DISPLAY "fields:    " MY-NEW-fldCNT.                         080828MA
102900     DISPLAY "Procspecs: " MY-NEW-spcCNT.                         080828MA
103000     COMPUTE CAPACITY-FILES                                       080813ma
103100     = (MY-NEW-FILCNT * 0.2) + MY-NEW-FILCNT.                     080828MA
103200     COMPUTE CAPACITY-FORMS                                       080813ma
103300     = (MY-NEW-frmCNT * 0.2) + MY-NEW-frmCNT.                     080828MA
103400     COMPUTE CAPACITY-FIELDS                                      080828MA
103500     = (MY-NEW-fldCNT * 0.2) + MY-NEW-fldCNT.                     080828MA
103600     COMPUTE CAPACITY-SPECS                                       080828MA
103700     = (MY-NEW-spcCNT * 0.2) + MY-NEW-spcCNT.                     080828MA
103800     MOVE "MIG_FM_FILES~" TO VAR-NAME.                            080813ma
103900     MOVE CAPACITY-FILES TO VAR-VALUE-I.                          080813ma
104000     DISPLAY CAPACITY-FILES.                                      080828MA
104100     PERFORM PUT-NUMVAR.                                          080813ma
104200     DISPLAY CAPACITY-FORMS.                                      080813ma
104300     MOVE "MIG_FM_FORMS~" TO VAR-NAME.                            080813ma
104400     MOVE CAPACITY-FORMS TO VAR-VALUE-I.                          080813ma
104500     PERFORM PUT-NUMVAR.                                          080813ma
104600     DISPLAY CAPACITY-FIELDS.                                     080813ma
104700     MOVE "MIG_FM_FIELDS~" TO VAR-NAME.                           080813ma
104800     MOVE CAPACITY-FIELDS TO VAR-VALUE-I.                         080813ma
104900     PERFORM PUT-NUMVAR.                                          080813ma
105000     MOVE "MIG_FM_SPECS~" TO VAR-NAME.                            080828MA
105100     MOVE CAPACITY-SPECS TO VAR-VALUE-I.                          080828MA
105200     DISPLAY CAPACITY-SPECS.                                      080828MA
105300     PERFORM PUT-NUMVAR.                                          080828MA
105400     Go To 9999-RETURN.                                           080813ma
105500*=================================================================080813ma
105600$PAGE  "Major SubParagraphs"                                      080813ma
105700*=================================================================080813ma
105800 INITIALIZATION.                                                  080813ma
105900D    DISPLAY "INITIALIZATION".                                    080831ma
106000     MOVE FUNCTION CURRENT-DATE TO FULL-CURRENT-DATE.             080813ma
106100     OPEN OUTPUT DMG01A3-FILE.                                    080813ma
106200     MOVE C-DATE TO RAW-DATE.                                     080813ma
106300     MOVE CORR RAW-DATE TO EDITED-DATE.                           080813ma
106400     CALL   INTRINSIC "WHO"                                       080813ma
106500     USING  WHO-MODE WHO-CAPABILITY WHO-LATTR WHO-USERN           080813ma
106600            WHO-GROUPN WHO-ACCTN WHO-HOMEN WHO-TERM-DEV-NO.       080813ma
106700     INITIALIZE TOTAL-FILES TOTAL-FORMS TOTAL-FIELDS CSTR.        080813ma
106800     Perform ShowTime.                                            080813ma
106900     PERFORM GET-HPSUSAN.                                         080813ma
107000     Initialize DATABASE-TABLE My-BaseName.                       080813ma
107100     MOVE 128 TO GINFO-LEN.                                       080813ma
107200     INITIALIZE GINFO-STR GINFO-PARM.                             080813ma
107300     INITIALIZE GINFO-STR GINFO-PARM.                             080831ma
107400     CALL INTRINSIC "GETINFO" USING GINFO-STR GINFO-LEN           080831ma
107500                                    GINFO-PARM.                   080831ma
107600     IF GINFO-LEN > 0                                             080831ma
107700D       DISPLAY "INFO LEN= [" GINFO-LEN  "]"                      080831ma
107800        MOVE GINFO-STR(1:GINFO-LEN) TO SCREEN-FORMS-FILE          080831ma
107900        PERFORM VGETINFO                                          080831ma
108000        PERFORM Process-Completion                                080831ma
108100        Go To 9999-RETURN.                                        080831ma
108200                                                                  080831ma
108300     Initialize MYCOST MYMONEY MYBYTES CSTR CERR CPARM CMSG.      080813ma
108400     Initialize Script-Str.                                       080813ma
108500     Initialize CSTR CERR CPARM CMSG.                             080813ma
108600     MOVE "Purge DMG01A1,Temp" to CMD.                            080813ma
108700     Perform MPE-COMMAND.                                         080813ma
108800                                                                  080813ma
108900     MOVE "Purge DMG01A1" to CMD.                                 080813ma
109000     Perform MPE-COMMAND.                                         080813ma
109100                                                                  080813ma
109200     MOVE "Purge DMG01A2" to CMD.                                 080813ma
109300     Perform MPE-COMMAND.                                         080813ma
109400                                                                  080813ma
109500     MOVE "Purge DMG01A2,Temp" to CMD.                            080813ma
109600     Perform MPE-COMMAND.                                         080813ma
109700                                                                  080813ma
109800     MOVE "File DMG01A1;rec=-62,1,f,ascii;disc=16384;save" to CMD.080813ma
109900     Perform MPE-COMMAND.                                         080813ma
110010     STRING "LISTFILE @.@.@;Seleq=[CODE=1035]"                    100304ma
110110            ";format=qualify >>*DMG01A1"                          081215ma
110120      DELIMITED BY SIZE INto CMD.                                 081215ma
110300     Perform MPE-COMMAND.                                         080813ma
110400     MOVE "File DMG01A1=DMG01A1,OLD" TO CMD.                      080813ma
110500     Perform MPE-COMMAND.                                         080813ma
110600*    MOVE                                                         080813ma
110700*     "LISTFILE @.@.@;Seleq=[CODE=1035];format=qualify >>*DMG01A1"080813ma
110800*     to CMD.                                                     080813ma
110900*    Perform MPE-COMMAND.                                         080813ma
111000     Initialize CMD.                                              080813ma
111100                                                                  080813ma
111200     Sort SortFile ASCENDING KEY SORT-KEY                         080813ma
111300       Using ExtFile1 Giving ExtFile2.                            080813ma
111400                                                                  080813ma
111500     Open Input ExtFile2.                                         080813ma
111600                                                                  080813ma
111700*-----------------------------------------------------------------080813ma
111800 Process-File.                                                    ma080814
111900D    DISPLAY "Process-File".                                      080831ma
112000     MOVE 1 TO Db-Ptr.                                            080813ma
112100     MOVE 0 TO DB-CNT.                                            080813ma
112200     Perform varying DB-Idx From 1 By 1                           080813ma
112300       Until ( EXTFILE-EOF ) Or ( DB-Idx > 9999 )                 080813ma
112400      READ EXTFILE2                                               080813ma
112500       AT END                                                     080813ma
112600        MOVE "9" TO EXTFILE-STATUS                                080813ma
112700       NOT AT END                                                 080813ma
112800       ADD 1 TO DB-CNT                                            080813ma
112900       INITIALIZE FFMSTR-BUFFER                                   080813ma
113000       Move EXT-REC2 To SCREEN-FORMS-FILE                         ma080814
113100       Display SCREEN-FORMS-FILE WITH NO ADVANCING                080902ma
113300       MOVE "SHOWTIME" TO CMD                                     080831ma
113400       PERFORM MPE-COMMAND                                        080831ma
113500       PERFORM VGETINFO                                           080820MA
114000* N O T E:  The above perform "VGETINFO" has loaded the           080820MA
114100*           Forms-File-Data area using the VGET__INFO intrinsics. 080820MA
114200       If SCREEN-CSTATUS <> 0                                     080820MA
114300        Display "*  Error occured " SCREEN-CSTATUS                080820MA
114400        Display "* Skipping FORMSFILE"                            080820MA
114500        MOVE 0 TO SCREEN-CSTATUS                                  080820MA
114600       END-IF                                                     080830ma
114700      End-Read                                                    080830ma
114800     End-Perform.                                                 080813ma
114900*=================================================================080813ma
115000$page "MISC SubParagraphs"                                        080813ma
115100*=================================================================080813ma
115200 GET-NUM.                                                         080813ma
115300D    DISPLAY "GET-NUM".                                           080813ma
115400     INITIALIZE NUM2 NUMDEC NUMERR.                               080813ma
115500     CALL "NUMGET" USING NUM1 NUM2 NUMDEC NUMERR.                 080813ma
115600     IF NUMERR NOT = 0 MOVE 0 TO NUM2.                            080813ma
115700     IF NUMDEC NOT = 0 MOVE 0 TO NUM2.                            080813ma
115800*---------------------------------------------------------        080813ma
115900 MPE-COMMAND.                                                     080813ma
116000D    DISPLAY "MPE-COMMAND".                                       080813ma
116100     INITIALIZE CSTR.                                             080813ma
116200     STRING CMD DELIMITED BY "  " %15 DELIMITED BY SIZE INTO CSTR.080813ma
116300     Move 2 To CMSG.                                              080813ma
116400D    DISPLAY CMD(1:79).                                           080813ma
116500     CALL INTRINSIC "HPCICOMMAND" USING                           080813ma
116600          CSTR CERR CPARM CMSG.                                   080813ma
116700*     IF CERR <> 0                                                080813ma
116800*      DISPLAY CERR                                               080813ma
116900*      DISPLAY CMSG.                                              080813ma
117000     INITIALIZE CMD.                                              080813ma
117100*---------------------------------------------------------        080813ma
117200 SHOWTIME.                                                        080813ma
117300     CALL INTRINSIC "HPCICOMMAND" USING                           080813ma
117400          SHOWTIME-STR CERR CPARM CMSG.                           080813ma
117500*--------------------------------------------------------         080813ma
117600 GET-HPSUSAN.                                                     080813ma
117700     MOVE "HPSUSAN~" TO HPVAR-NAME.                               080813ma
117800     MOVE 1 TO HPVAR-ITEMNUM.                                     080813ma
117900     INITIALIZE MYHPSUSAN HPVAR-ITEM HPVAR-STAT.                  080813ma
118000     CALL INTRINSIC "HPCIGETVAR" USING HPVAR-NAME                 080813ma
118100         HPVAR-STAT HPVAR-ITEMNUM MYHPSUSAN.                      080813ma
118200*     DISPLAY "HPSUSAN: " MYHPSUSAN.                              080813ma
118300*------------------------------------------------------------     080813ma
118400 MSG-PROCESS.                                                     080813ma
118500*      DISPLAY "MSG-PROCESS".                                     080831ma
118600     DISPLAY M.                                                   080813ma
118700     INITIALIZE CSTR.                                             080813ma
118800     STRING "TELLOP " M  %15 DELIMITED BY SIZE INTO CSTR.         080813ma
118900     Move 2 To CMSG.                                              080813ma
119000     IF BATCH-PROCESS OR NOT-INTERACTIVE                          080813ma
119100      CALL INTRINSIC "HPCICOMMAND" USING                          080813ma
119200           CSTR CERR CPARM CMSG.                                  080813ma
119300     INITIALIZE M CMD.                                            080813ma
119400*--------------------------------------------------------------   080813ma
119500 PUT-NUMVAR.                                                      080813ma
119600     MOVE ZEROS TO VAR-STATUS.                                    080813ma
119700     CALL INTRINSIC "HPCIPUTVAR" USING VAR-NAME VAR-STATUS ITEM-1 080813ma
119800       VAR-VALUE-I.                                               080813ma
119900     IF VAR-STATUS NOT = ZERO                                     080813ma
120000       DISPLAY "Error calling HPCIPUTVAR: " VAR-STATUS.           080813ma
120100*----------------------------                                     080813ma
120200 Load-Form-Source.                                                ma080814
120300D    Display " Load-Form-Source.".                                090323ma
120400     INITIALIZE CMD forms-data.                                   080813ma
120500     Perform Fopen-Formsfile.                                     080813ma
120600     MOVE 256 TO DATA-LEN.                                        080813ma
120700     Perform varying DB-Idx From 1 By 1                           080813ma
120800       Until ( EXTFILE-EOF ) Or ( DB-Idx > 32766 )                080813ma
120900      Read Forma-File                                             080813ma
121000          At End     Move '1' To Formsfile-Sw                     080813ma
121100          Not At End                                              080813ma
121200       Move '0' To Formsfile-Sw                                   080813ma
121300       Add 1 to frdcnt                                            080813ma
121400       Move Form-Rec to frdstr(frdcnt)                            080813ma
121500       Move Frdstr(frdcnt)(1:2) To Ascii-Character                080813ma
121600       MOVE Frdstr(frdcnt)(3:1) TO FORMFILES-REC-TYPE-SW          080813ma
121700      End-Read                                                    080813ma
121800     End-Perform.                                                 080813ma
121900     CLOSE FORMA-FILE.                                            080813ma
122000     Display SCREEN-FORMS-FILE "Records : " frdcnt.               ma080814
122100*--------------------------------                                 080813ma
122200 Fopen-Formsfile.                                                 080813ma
122300D    DISPLAY "Fopen-Formsfile".                                   081007ma
122400     MOVE 1 TO S1.                                                080813ma
122500     INSPECT SCREEN-FORMS-FILE                                    ma080814
122600      TALLYING S1 FOR CHARACTERS BEFORE ' '.                      080813ma
122700     IF S1 > 28 MOVE 28 TO S1.                                    080813ma
122800     MOVE 'FILE FORM='           TO CMD.                          080813ma
122900     MOVE SCREEN-FORMS-FILE(1:S1) TO CMD(11:).                    ma080814
123000     Perform MPE-COMMAND.                                         080813ma
123100     MOVE "FORMFILE" TO FNAME.                                    080813ma
123200     OPEN INPUT FORMA-FILE.                                       080813ma
123300     IF FORMFILE-STATUS <> "00"                                   080813ma
123400        PERFORM 9001-FILE-ERROR.                                  080813ma
123500     MOVE ZERO TO FORMFILE-COUNT.                                 080813ma
123600     MOVE "01" TO  FORMFILE-FLAG.                                 080813ma
123700*--------------------------------                                 080830ma
123800 OPEN-GFILE-OUTPUT.                                               080830ma
123900*    DISPLAY "OPEN-GFILE-OUTPUT".                                 080831ma
124000     MOVE 'FILE GFILE=GFILE,OLD'  TO CMD.                         080830ma
124100     Perform MPE-COMMAND.                                         080830ma
124200     MOVE 'PURGE GFILE'           TO CMD.                         080830ma
124300     Perform MPE-COMMAND.                                         080830ma
124400     MOVE 'PURGE GFILE'           TO CMD.                         080830ma
124500     Perform MPE-COMMAND.                                         080830ma
124600     MOVE 'BUILD GFILE;REC=-1540,1,F,BINARY;DISC=16384' TO CMD.   080830ma
124700     Perform MPE-COMMAND.                                         080830ma
124800     MOVE "GFILE" TO FNAME.                                       080830ma
124900     OPEN OUTPUT G-FILE.                                          080830ma
125000     IF GFILE-STATUS <> "00" PERFORM 9001-FILE-ERROR.             080830ma
125100     MOVE ZERO TO GFILE-RCOUNT GFILE-COUNT.                       080830ma
125200     MOVE "02" TO GFILE-FLAG.                                     080830ma
125300*--------------------------------                                 080830ma
125400 OPEN-GFILE-INPUT.                                                080830ma
125500*    DISPLAY "OPEN-GFILE-INPUT ".                                 080831ma
125600     MOVE "GFILE" TO FNAME.                                       080830ma
125700     OPEN INPUT G-FILE.                                           080830ma
125800     IF GFILE-STATUS <> "00" PERFORM 9001-FILE-ERROR.             080830ma
125900     MOVE ZERO   TO GFILE-RCOUNT.                                 080830ma
126000     MOVE "01" TO GFILE-FLAG.                                     080830ma
126100*--------------------------------                                 080830ma
126200 READ-GFILE.                                                      080830ma
126300*    DISPLAY "READ-GFILE ".                                       080831ma
126400     MOVE "GFILE" TO FNAME.                                       080830ma
126500     Read G-File                                                  080830ma
126600      At End                                                      080830ma
126700          INITIALIZE G-RECORD                                     080831ma
126800          Move '99' To GFILE-FLAG                                 080830ma
126900      Not At End                                                  080830ma
127000        IF GFILE-STATUS <> "00"                                   080830ma
127100         PERFORM 9001-FILE-ERROR                                  080830ma
127200        END-IF                                                    080830ma
127300        ADD 1 TO GFILE-RCOUNT                                     080830ma
127400        Move G-REC TO G-RECORD.                                   080831ma
127500*--------------------------------                                 080830ma
127600 WRITE-GFILE.                                                     080830ma
127700*    DISPLAY "WRITE-GFILE ".                                      080831ma
127800     MOVE "GFILE" TO FNAME.                                       080830ma
127900     MOVE G-RECORD TO G-REC.                                      080831ma
128000     WRITE G-REC.                                                 080830ma
128100     IF GFILE-STATUS <> "00" PERFORM 9001-FILE-ERROR.             080830ma
128200     ADD 1 TO GFILE-COUNT.                                        080830ma
128300*--------------------------------                                 080830ma
128400 CLOSE-GFILE.                                                     080830ma
128500*    DISPLAY "CLOSE-GFILE ".                                      080831ma
128600     MOVE "GFILE" TO FNAME.                                       080830ma
128700     CLOSE G-FILE.                                                080830ma
128800     MOVE SPACES TO GFILE-FLAG.                                   080830ma
128900                                                                  080820MA
129000*                                                                 080813ma
129100*---------------------------------------------------------------  080820MA
129200 Link-VF-Pointers.                                                080820MA
129300*                                                                 080830ma
129400* If an "E" record type is found, then this is a valid form.      080830ma
129500*                                                                 080830ma
129600*           Now go get the design form records.                   080830ma
129700*                                                                 080830ma
129800* The design form screen in formspec stores the screen data       080830ma
129900* in two separate records, the "V" and "F" record types.          080830ma
130000* If both records are not found with the same record length       080830ma
130100* then this is not a valid form.                                  080830ma
130200*                                                                 080830ma
130300* -- N O T E --                                                   080813ma
130400*            If FDATA-REPRODUCED-FR is not blank, then this       080813ma
130500*            form will not have a "V" and "F" record type.        080813ma
130600*            Instead find the "V" and "F" records where the       080813ma
130700*            Design-Name matches the value in FDATA-REPRODUCED-FR.080813ma
130800*                                                                 080813ma
130900*                                                                 080813ma
131000* L O A D    F D E S I G N    P O I N T E R S                     080813ma
131100d    display "load fdesign".                                      080831ma
131200D    DISPLAY "FMMSTR-REPRODUCED-FR: [" FMMSTR-REPRODUCED-FR "]".  080831ma
131300D    DISPLAY "FMMSTR-FRM-NAME:      [" FMMSTR-FRM-NAME "]".       080831ma
131400     If FMMSTR-REPRODUCED-FR > SPACES                             080831ma
131500      Move FMMSTR-REPRODUCED-FR to Design-name                    080830ma
131600     ELSE                                                         080820MA
131700      MOVE FMMSTR-FRM-NAME TO Design-name.                        080831ma
131800     Move 16 To i.                                                080831ma
131900     Perform varying i from 16 by -1                              080831ma
132000       until i < 2 or Design-name(i:1) > " "                      080831ma
132100      Continue                                                    080831ma
132200     End-Perform                                                  080831ma
132300     Move i To deslen.                                            080831ma
132400     IF DESLEN < 1 MOVE 1 TO DESLEN.                              080831ma
132500     IF DESLEN < 15 MOVE 15 TO DESLEN.                            080831ma
132600     INITIALIZE F-DESIGN-POINTERS.                                080813ma
132700D    DISPLAY "DESIGN-NAME(1:DESLEN):      ["                      080831ma
132800D             DESIGN-NAME(1:DESLEN) "]".                          080831ma
132900     Perform Varying Frdidx From 1 By 1                           080813ma
133000       Until ( Frdidx > Frdcnt ) or (FDPCNT > 109)                080813ma
133100      Move Frdstr(Frdidx)(1:2) To Ascii-Character                 080813ma
133200      If (Frdstr(Frdidx)(4:deslen) = Design-name(1:deslen))       080813ma
133300          And (Frdstr(Frdidx)(3:1) = "F")                         080813ma
133400          And ( Ascii-Value > 0 )                                 080813ma
133500       ADD 1 TO FDPCNT                                            080813ma
133600       Compute FDP-STRT(FDPCNT) =                                 080813ma
133700        18 + ((Frdidx * 256) - 255 )                              080813ma
133800       End-compute                                                080813ma
133900       Compute FDP-END(FDPCNT) =                                  080813ma
134000        FDP-STRT(FDPCNT) + (Ascii-Value - 20)                     080813ma
134100       End-Compute                                                080813ma
134200       Move Ascii-Value To FDP-LEN(FDPCNT)                        080813ma
134300D       DISPLAY Design-name(1:deslen) "  "                        080831ma
134400D        " F S=" FDP-STRT(FDPCNT)                                 080831ma
134500D        " F E=" FDP-END(FDPCNT)                                  080831ma
134600D        " F L=" FDP-LEN(FDPCNT)                                  080831ma
134700      END-IF                                                      080813ma
134800     END-Perform.                                                 080813ma
134900*                                                                 080813ma
135000* L O A D    V D E S I G N    P O I N T E R S                     080813ma
135100*                                                                 080813ma
135200d    display "load Vdesign".                                      080831ma
135300     INITIALIZE V-DESIGN-POINTERS.                                080813ma
135400     Perform Varying Frdidx From 1 By 1                           080813ma
135500       Until ( Frdidx > Frdcnt ) or (VDPCNT > 109)                080813ma
135600      Move Frdstr(Frdidx)(1:2) To Ascii-Character                 080813ma
135700      If (Frdstr(Frdidx)(4:deslen) = Design-name(1:deslen))       080813ma
135800          And (Frdstr(Frdidx)(3:1) = "V")                         080813ma
135900          And ( Ascii-Value > 0 )                                 080813ma
136000       ADD 1 TO VDPCNT                                            080813ma
136100       Compute VDP-STRT(VDPCNT) =                                 080813ma
136200        18 + ((Frdidx * 256) - 255 )                              080813ma
136300       End-compute                                                080813ma
136400       Compute VDP-END(VDPCNT) =                                  080813ma
136500        VDP-STRT(VDPCNT) + (Ascii-Value - 20)                     080825MA
136600       End-Compute                                                080813ma
136700       Move Ascii-Value To VDP-LEN(VDPCNT)                        080813ma
136800D       DISPLAY Design-name(1:deslen) "  "                        080831ma
136900D        " V S=" VDP-STRT(VDPCNT)                                 080831ma
137000D        " V E=" VDP-END(VDPCNT)                                  080831ma
137100D        " V L=" VDP-LEN(VDPCNT)                                  080831ma
137200      END-IF                                                      080813ma
137300     END-Perform.                                                 080813ma
137400*                                                                 080813ma
137500* L I N K   " F "   A N D    " V "   P O I N T E R S              080813ma
137600*                                                                 080813ma
137700     MOVE "0" TO POINTER-LINK-SW.                                 080825MA
137800     If FDPCNT > 0 and VDPCNT > 0                                 080825MA
137900      PERFORM VARYING FDPIDX FROM 1 BY 1                          080825MA
138000        UNTIL (POINTERS-LINKED) OR (FDPIDX > FDPCNT)              080825MA
138100       PERFORM VARYING VDPIDX FROM 1 BY 1                         080825MA
138200         UNTIL (POINTERS-LINKED) OR (VDPIDX > VDPCNT)             080825MA
138300        IF FDP-LEN(FDPIDX) = VDP-LEN(VDPIDX)                      080825MA
138400         MOVE "1" TO POINTER-LINK-SW                              080825MA
138500         MOVE FDPIDX TO FDPCNT                                    080825MA
138600        END-IF                                                    080825MA
138700       END-PERFORM                                                080825MA
138800      END-PERFORM.                                                080825MA
138900*---------------------------------------------------------        080813ma
139000 GET-SCREEN-OBJECTS.                                              ma080814
139100D    display "GET-SCREEN-OBJECTS.".                               080828MA
139200     Initialize TEXT-BUTTONS.                                     080821MA
139300     MOVE FDP-STRT(FDPCNT) TO startx.                             080813ma
139400     MOVE FDP-END(FDPCNT)  TO endx.                               080813ma
139500     Move FDP-LEN(FDPCNT)  To F-Design-Len.                       080813ma
139600     Initialize F-xlen F-Design.                                  080813ma
139700     Perform Varying xidx from Startx by 1                        080813ma
139800       Until ( xidx > Endx )                                      080813ma
139900          OR ( F-xlen > 16382 )                                   080830ma
140000      Add 1 to F-xlen                                             080813ma
140100      Move frd-table(xidx:1) to F-Design(F-xlen:1)                080813ma
140200D     display f-xlen "[" F-Design(F-xlen:1) "]"                   080831ma
140300     End-Perform.                                                 080813ma
140400*    ACCEPT NUM1.                                                 081007ma
140500D    COMPUTE Y = F-xlen * -1.                                     080831ma
140600D    CALL INTRINSIC "FWRITE" USING \1\ clearscreen \-2\ \0\.      080831ma
140700D    MOVE "PAUSE 2" TO CMD.                                       080831ma
140800D    PERFORM MPE-COMMAND.                                         080831ma
140900D    CALL INTRINSIC "FWRITE" USING \1\ F-Design Y \0\.            080831ma
141000*    ACCEPT NUM1.                                                 081007ma
141100D    Display " ".                                                 080902ma
141200D    Display "Formsfile: [" FFMSTR-VFIL-NAME "]".                 080902ma
141220D    Display "FORM:      [" FMMSTR-FRM-NAME "]".                  080902ma
141300     Perform GET-ROWS.                                            080813ma
141400                                                                  080813ma
141500* // Now find the Function Key values, if any!                    080813ma
141600     Initialize FKEY-TEST1 FKEY-TEST2 FDATA-FUNCTION-KEYS.        080830ma
141700     If FMMSTR-FKEY-DEF = "X" AND BRWCNT < 8                      080830ma
141800      Perform Varying Frdidx From 1 By 1                          080813ma
141900        Until ( Frdidx > Frdcnt )                                 080813ma
142000       Move Frdstr(Frdidx)(1:2) To Ascii-Character                080813ma
142100       If   (Frdstr(Frdidx)(4:S1) = FMMSTR-FRM-NAME(1:S1))        080830ma
142200             And (Frdstr(Frdidx)(3:1) = "H")                      080813ma
142300             And (Ascii-Value  >  140)                            080813ma
142400             And (Ascii-Value  <  180)                            080813ma
142500        Move Frdstr(Frdidx)(19:128) To FDATA-FUNCTION-KEYS        080830ma
142600       End-If                                                     080813ma
142700      End-Perform                                                 080813ma
142800     ELSE                                                         080813ma
142900      PERFORM VARYING X FROM 1 BY 1 UNTIL X > 8                   080820MA
143000       Move Text-BtnStr(x) To Fkey(x)                             080830ma
143100      END-PERFORM.                                                080820MA
143200     PERFORM VARYING X FROM 1 BY 1 UNTIL X > 8                    080821MA
143300D      Display " _______ "                                        080831ma
143400D      Display "|" FKEY-LINE1(x) "|"                              080831ma
143500D      Display "|" FKEY-LINE2(x) "|"                              080831ma
143600D      Display " _______ "                                        080831ma
143700     Perform ADD-OBJ-FKEY                                         080828MA
143800     END-PERFORM.                                                 080821MA
143900*----------------                                                 080813ma
144000 GET-FIELD-DATA.                                                  ma080814
144100D   display " GET-FIELD-DATA.".                                   080828MA
144200     Move 0 To i.                                                 080813ma
144300     Perform varying i from 15 by -1                              080813ma
144400       until i < 2 or FMMSTR-FRM-NAME(i:1) > " "                  080830ma
144500      Continue                                                    080813ma
144600     End-Perform.                                                 080813ma
144700     Move i To S1.                                                080813ma
144800     Move 0 To i.                                                 080813ma
144900     Perform varying i from 15 by -1                              080813ma
145000       until i < 2 or FFFLDS-VFLD-NAME(i:1) > " "                 080830ma
145100      Continue                                                    080813ma
145200     End-Perform.                                                 080813ma
145300     Move i To S2.                                                080813ma
145400     IF S1 > 15 MOVE 15 TO S1.                                    080813ma
145500     IF S2 > 15 MOVE 15 TO S2.                                    080813ma
145600*    Display "SCREEN-NAME [" FMMSTR-FRM-NAME(1:s1) "]"            080831ma
145700*    Display "FIELD-FIELD-NAME [" FFFLDS-VFLD-NAME(1:s2) "]"      080831ma
145710     MOVE "0" TO VALID-G-SW.                                      080831ma
145810     Perform Varying GSIDX From 1 By 1                            080831ma
145900       Until VALID-G OR ( GSIDX > GSCNT )                         080831ma
146000      MOVE GS-FIELD(GSIDX) TO G-FIELD-FORMAT                      080831ma
146100      Move GS-HEADER(GSIDX) to G-HEADER-FORMAT                    080831ma
146200      MOVE 0 TO MYTALLY                                           080831ma
146300*       DISPLAY "GFF " GFF-FORM GFF-FIELD GFF-NUM                 080831ma
146400*       DISPLAY GFF-ENH GFF-FTYPE GFF-DTYPE                       080831ma
146500*       DISPLAY FMMSTR-FRM-NAME FFFLDS-VFLD-NUM                   080831ma
146600      Initialize  num2 numdec numerr                              080831ma
146700      MOVE GFF-NUM TO num1                                        080831ma
146800      call "numget" using num1 num2 numdec numerr                 080831ma
146900      If (NUMERR = 0)                                             080831ma
147000        And (GFF-FORM = FMMSTR-FRM-NAME(1:S1))                    080831ma
147100        And (num2 = FFFLDS-VFLD-NUM)                              080831ma
147200       Initialize  num2 numdec numerr                             080831ma
147300       MOVE GFF-LEN  TO num1                                      080831ma
147400       call "numget" using num1 num2 numdec numerr                080831ma
147500       IF NUM2 = FFFLDS-VFLD-LENGTH                               080831ma
147600        IF GHF-LENGTH < 1540                                      080831ma
147700         MOVE "1" TO VALID-G-SW                                   080831ma
147800         MOVE GFF-FTYPE          TO FFFLDS-VFLD-TYPE              080831ma
147900         MOVE GFF-DTYPE          TO FFFLDS-VFLD-DATATYPE          080831ma
148000         move GFF-INIT           to FFFLDS-VFLD-INITVAL           080831ma
148100         Perform Get-ProcSpecs                                    080831ma
148200        end-if                                                    080831ma
148300       END-IF                                                     080831ma
148400      End-If                                                      080831ma
148500     End-Perform.                                                 080813ma
148600     Add 1 to FFFLDS-VFLD-POSITION.                               080830ma
148700     MOVE  FFFLDS-VFLD-POSITION   TO FFFLDS-BUF-X.                080830ma
148800     MOVE  OBJ-STRTCOL(Irow,Xcol) TO FFFLDS-SRN-X RPT-SRN-X.      080830ma
148900     MOVE  OBJ-STRTROW(Irow,Xcol) TO FFFLDS-SRN-Y RPT-SRN-Y.      080830ma
149000     Compute                                                      080830ma
149100      FFFLDS-BUF-Y = FFFLDS-BUF-X + (FFFLDS-VFLD-LENGTH - 1).     080830ma
149300     perform add-field.                                           080828MA
149400     IF VALID-G AND Speclen > 1                                   080830ma
149500      COMPUTE Y = Speclen * -1 END-COMPUTE                        ma080814
149600*     CALL INTRINSIC "FWRITE" USING \1\ GFF-PROCSPECS Y \0\       080831ma
149700      Perform Add-ProcSpecs.                                      080828MA
149800*---------------------------------------------------              080813ma
149900 Get-ProcSpecs.                                                   080813ma
150000D    Display "Get-ProcSpecs".                                     080831ma
150100     move 1280 to Speclen.                                        080831ma
150200     Move "0" to nonblank-sw.                                     080813ma
150300     If Speclen > 1                                               080831ma
150400      Initialize xidx                                             080831ma
150500      Perform Varying xidx from Speclen by -1                     080831ma
150600        Until ( GFF-PROCSPECS(xidx:1) > Spaces )                  080831ma
150700           or ( xidx < 2 )                                        080831ma
150800       Continue                                                   080831ma
150900      End-Perform.                                                080831ma
151000     Move xidx to Speclen.                                        ma080814
151100*-----------------------------------------------------------      080813ma
151200 GET-ROWS.                                                        080813ma
151300D    Display "GET-ROWS".                                          080831ma
151400* //                                                              080813ma
151500*    The screen image is processed 1 character at a time. As each 080813ma
151600*    character is processed 1 is added to the column value.       080813ma
151700*    In this paragraph F-idx is used to point to 1 character.     080813ma
151800*                                                                 080813ma
151900*    When terminal commands are incountered the appropriate value 080813ma
152000*    will be subtracted from the column value, because commands   080813ma
152100*    do not use any space on the screen.                          080813ma
152200*    When CR/LF is incountered or the column value reaches 80,    080813ma
152300*    then 1 is added to the row value, and the column value is    080813ma
152400*    set to zero.                                                 080813ma
152500*                                                                 080813ma
152600*    Maximum of 32 rows, and 80 columns.                          080813ma
152700*                                                                 080813ma
152800* NOTE: The V/Plus message window, is inserted into the           080813ma
152900*       screen based on the forms file window position setting.   080813ma
153000*                                                                 080813ma
153100* ****  Terminal commands supported in this paragraph:  ****      080821MA
153200                                                                  080821MA
153300*    1.ESC [  Start of a data field                               080821MA
153400*    2.ESC ]  End of a data field                                 080821MA
153500*    3.Ascii decimal value 14; Start line drawing character set.  080821MA
153600*    4.Ascii decimal value 15; End line drawing character set.    080821MA
153700*    5.ESC &d < and one of the following upper case characters >  080821MA
153800*                                                                 080813ma
153900*      CHAR Description                        V/Plus Equivalence 080813ma
154000*         @ End Enhancement                     NONE              080813ma
154100*         A Blink                               B                 080813ma
154200*         B Inverse                             I                 080813ma
154300*         C Blink, Inverse                      BI                080813ma
154400*         D Underline                           U                 080813ma
154500*         E Blink, Underline                    BU                080813ma
154600*         F Inverse, Underline                  IU                080813ma
154700*         G Blink, Inverse, Underline           BIU               080813ma
154800*         H HalfBright                          H                 080813ma
154900*         I Blink, Half Bright                  BH                080813ma
155000*         J Inverse, Half Bright                IH                080813ma
155100*         K Blink, Inverse, Half Bright         BIH               080813ma
155200*         L Underline, Half Bright              UH                080813ma
155300*         M Blink, Underine, HBright            BUH               080813ma
155400*         N Inverse, Underline, HBright         IUH               080813ma
155500*         O Blink, Inverse, Underline, HBright  BIUH              080813ma
155600*         S Secure Field {Newer terminals HP700/XX}               080813ma
155700*                                                                 080813ma
155800     Initialize ALL-ROWS.                                         080813ma
155900     MOVE 32 TO ROWMAX.                                           080813ma
156000     MOVE 1  TO ROWCNT ROWSTART.                                  080813ma
156100* Check if window position is before all rows.                    080813ma
156200     IF FILE-WINDOW-POSITION(1) = 0                               ma080814
156300      PERFORM ADD-OBJ-SCRNMSG                                     080813ma
156400      ADD 1 TO ROWCNT                                             080813ma
156500     END-IF                                                       080813ma
156600* Start iterations through screen image                           080813ma
156700     Perform Varying F-idx from 1 by 1                            080813ma
156800       until (F-idx > F-xlen)                                     080813ma
156900          or (ROWCNT > 39)                                        080813ma
157000      ADD 1 TO ROW-COLUMN                                         080813ma
157100* Check for end of line conditions                                080813ma
157200      IF ((F-Design(F-idx:1) = %15)                               080813ma
157300          AND (F-Design(F-idx + 1:1) = %12))                      080813ma
157400        OR ROW-COLUMN > 80                                        080813ma
157500*      DISPLAY "SAVING ROW"                                       080813ma
157600       MOVE F-idx TO ROWEND                                       080813ma
157700       COMPUTE ROWLEN =  ROWEND - ROWSTART END-COMPUTE            080813ma
157800       IF ROWLEN < 1 MOVE 1 TO ROWLEN END-IF                      080813ma
157900       MOVE F-Design(ROWSTART:ROWLEN) TO ROWSTR(ROWCNT)           080813ma
158000       PERFORM GET-TEXT                                           080813ma
158100       COMPUTE ROWSTART = F-idx + 2 END-COMPUTE                   080813ma
158200       move 0 to ROW-COLUMN                                       080813ma
158300D      DISPLAY "START NEW ROW"                                    080831ma
158310       IF ROWCNT > 38                                             080831ma
158320        DISPLAY "MORE THAN 38 ROWS; NOT SUPPORTED"                080831ma
158330       ELSE                                                       080831ma
158400        ADD 1 TO ROWCNT F-idx                                     080831ma
158410       END-IF                                                     080831ma
158500* NEW ROW: Check window position                                  080813ma
158600       INITIALIZE ROW-ENTRIES(ROWCNT)                             080813ma
158700      END-IF                                                      080813ma
158800* NOT AT END OF LINE                                              080813ma
158900*                                                                 080813ma
159000* Check for Escaped DATA FIELD                                    080813ma
159100*                                                                 080813ma
159200      IF ((F-Design(F-idx:1) = %33)                               080831ma
159300          AND (F-Design(F-idx + 1:1) = "[" OR "]"))               080831ma
159301*       OR (F-Design(F-idx:1) = "[")                              080831ma
159400       SUBTRACT 2 FROM ROW-COLUMN                                 080813ma
159410      IF (((F-Design(F-idx:1) = %33)                              080831ma
159510       AND (F-Design(F-idx + 1:1) = "[" ))                        080831ma
159600          OR (F-Design(F-idx:1) = "[" ))                          080831ma
159620       AND F-Design(F-idx + 2:1) <> "."                           080813ma
159700        PERFORM ADD-OBJ-DATAFIELD                                 080813ma
159800       END-IF                                                     080813ma
159900      ELSE                                                        080813ma
160000       IF (F-Design(F-idx:1) = %33)                               080813ma
160100        PERFORM GET-ESCAPE-SEQ-LENGTH                             080813ma
160200        SUBTRACT ESC-LEN FROM ROW-COLUMN                          080813ma
160300       END-IF                                                     080813ma
160400      END-IF                                                      080813ma
160500*                                                                 080813ma
160600* Check for Line Drawing Character set                            080813ma
160700*                                                                 080813ma
160800      IF (F-Design(F-idx:1) = %17 OR %16)                         080813ma
160900        SUBTRACT 1 FROM ROW-COLUMN                                080813ma
161000      END-IF                                                      080813ma
161100      IF (F-Design(F-idx:1) = %17)                                080813ma
161200        PERFORM GET-Linedrawing                                   080813ma
161300      END-IF                                                      080813ma
161400*     DISPLAY "SHOW CHAR DATA"                                    080813ma
161500     Move LOW-VALUE          to ASCII-BYTE1                       080828MA
161600     Move  F-Design(F-idx:1) To ASCII-BYTE2                       080828MA
161700*    Display "Chr [" F-Design(F-idx:1) "] idx=" f-idx             080828MA
161800*     " row=" rowcnt  " col=" ROW-COLUMN " ASCII= " Ascii-Value   080828MA
161900     End-Perform.                                                 080828MA
162000                                                                  080828MA
162100     MOVE F-idx TO ROWEND.                                        080825MA
162200     COMPUTE ROWLEN =  ROWEND - ROWSTART                          080825MA
162300     If ROWLEN > 1                                                080825MA
162400      MOVE F-Design(ROWSTART:ROWLEN) TO ROWSTR(ROWCNT)            080825MA
162500      PERFORM GET-TEXT                                            080825MA
162600      COMPUTE ROWSTART = F-idx + 2 END-COMPUTE                    080825MA
162700      move 0 to ROW-COLUMN.                                       080825MA
162800* End iterations through screen image                             080813ma
162900     If FILE-WINDOW-POSITION(1) > 1                               ma080814
163000      ADD 1 TO ROWCNT                                             080813ma
163100      IF ROWCNT <= FILE-WINDOW-POSITION(1)                        ma080814
163200       Move FILE-WINDOW-POSITION(1) to ROWCNT                     ma080814
163300      End-If                                                      080813ma
163400      PERFORM ADD-OBJ-SCRNMSG.                                    080813ma
163500*------------------------------------------------                 080813ma
163600 GET-TEXT.                                                        080813ma
163700D    DISPLAY "GET-TEXT".                                          080828MA
163800     INITIALIZE next-string NEW-TEXT-AREA.                        080828MA
163900     MOVE "0"        TO END-ROW-SW.                               080813ma
164000     MOVE "0"        TO NON-TEXT-SW.                              080813ma
164100     MOVE 1          TO TEXT-COLUMN.                              080813ma
164200     MOVE 1          TO TXPTR-START.                              080813ma
164300     MOVE "@"        TO TEXT-ENH.                                 080813ma
164301     Initialize INSPECT-IDX.                                      080831ma
164320     Inspect ROWSTR(ROWCNT) tallying INSPECT-IDX for all %33.     080831ma
164410     If (FILE-WINDOW-POSITION(1) > 22) and                        080831ma
164420        (rowcnt = 2 or 3) AND                                     080831ma
164430        (INSPECT-IDX >= 7)                                        080831ma
164500      Move "1" to End-Row-Sw                                      080813ma
164800     If rowcnt = 2                                                080831ma
164900       move RowStr(Rowcnt) To next-string                         080825MA
165000       Perform Extract-Labels                                     080825MA
165100       Move btn(1) To Txkey1-1                                    080825MA
165200       Move btn(2) To Txkey2-1                                    080825MA
165300       Move btn(3) To Txkey3-1                                    080825MA
165400       Move btn(4) To Txkey4-1                                    080825MA
165500       Move btn(5) To Txkey5-1                                    080825MA
165600       Move btn(6) To Txkey6-1                                    080825MA
165700       Move btn(7) To Txkey7-1                                    080825MA
165800       Move btn(8) To Txkey8-1                                    080831ma
165810     END-IF                                                       080831ma
165900     If rowcnt = 3                                                080831ma
166000       move RowStr(Rowcnt) To next-string                         080825MA
166100       Perform Extract-Labels                                     080825MA
166200       Move btn(1) To Txkey1-2                                    080825MA
166300       Move btn(2) To Txkey2-2                                    080825MA
166400       Move btn(3) To Txkey3-2                                    080825MA
166500       Move btn(4) To Txkey4-2                                    080825MA
166600       Move btn(5) To Txkey5-2                                    080825MA
166700       Move btn(6) To Txkey6-2                                    080825MA
166800       Move btn(7) To Txkey7-2                                    080825MA
166900       Move btn(8) To Txkey8-2                                    080831ma
166910     END-IF                                                       080831ma
167000     If (FILE-WINDOW-POSITION(1) > 22) and (rowcnt = 2 or 3)      ma080814
167100      String Txkey1-1 Txkey1-2                                    080813ma
167200       Delimited by size into TEXT-BTNSTR(1)                      080813ma
167300       End-String                                                 080813ma
167400      String Txkey2-1 Txkey2-2                                    080813ma
167500       Delimited by size into TEXT-BTNSTR(2)                      080813ma
167600       End-String                                                 080813ma
167700      String Txkey3-1 Txkey3-2                                    080813ma
167800       Delimited by size into TEXT-BTNSTR(3)                      080813ma
167900       End-String                                                 080813ma
168000      String Txkey4-1 Txkey4-2                                    080813ma
168100       Delimited by size into TEXT-BTNSTR(4)                      080813ma
168200       End-String                                                 080813ma
168300      String Txkey5-1 Txkey5-2                                    080813ma
168400       Delimited by size into TEXT-BTNSTR(5)                      080813ma
168500       End-String                                                 080813ma
168600      String Txkey6-1 Txkey6-2                                    080813ma
168700       Delimited by size into TEXT-BTNSTR(6)                      080813ma
168800       End-String                                                 080813ma
168900      String Txkey7-1 Txkey7-2                                    080813ma
169000       Delimited by size into TEXT-BTNSTR(7)                      080813ma
169100       End-String                                                 080813ma
169200      String Txkey8-1 Txkey8-2                                    080813ma
169300       Delimited by size into TEXT-BTNSTR(8)                      080813ma
169400       End-String.                                                080813ma
169500                                                                  080813ma
169600     PERFORM VARYING TXPTR FROM TXPTR-START BY 1                  080813ma
169700        UNTIL END-OF-ROW                                          080813ma
169800           OR (TXPTR > ROWLEN)                                    080813ma
169900           Or (text-char > 80)                                    080813ma
170010      MOVE "0" TO NEW-TEXT-FOUND-SW                               080813ma
170100      IF ((ROWSTR(ROWCNT)(TXPTR:1) = %15)                         080813ma
170200          AND (ROWSTR(ROWCNT)(TXPTR + 1:1) = %12))                080813ma
170300        OR (ROWSTR(ROWCNT)(TXPTR:1) = %0)                         080813ma
170400        OR (TXPTR > ROWLEN)                                       080813ma
170500        Or (text-char > 80)                                       080813ma
170600       MOVE "1" TO END-ROW-SW                                     080813ma
170700      END-IF                                                      080813ma
170800      IF NOT END-OF-ROW                                           080813ma
170900       IF  ( ROWSTR(ROWCNT)(TXPTR:1)     = %33 ) AND              080813ma
171000           ( ROWSTR(ROWCNT)(TXPTR + 1:1) = %46 ) AND              080813ma
171100           ( ROWSTR(ROWCNT)(TXPTR + 2:1) = %144)                  080813ma
171200        MOVE ROWSTR(ROWCNT)(TXPTR + 3:1) TO TEXT-ENH              080813ma
171300        ADD 4 TO TXPTR                                            080813ma
171400        IF TXPTR > ROWLEN                                         080813ma
171500         MOVE ROWLEN TO TXPTR                                     080813ma
171600        END-IF                                                    080813ma
171700       END-IF                                                     080813ma
171800       IF  ( ROWSTR(ROWCNT)(TXPTR:1)     = %33 ) AND              080828MA
171900           ( ROWSTR(ROWCNT)(TXPTR + 1:1) = ")" ) AND              080828MA
172000           ( ROWSTR(ROWCNT)(TXPTR + 2:1) = "B")                   080828MA
172100        ADD 3 TO TXPTR                                            080828MA
172200        IF TXPTR > ROWLEN                                         080828MA
172300         MOVE ROWLEN TO TXPTR                                     080828MA
172400        END-IF                                                    080828MA
172500       END-IF                                                     080828MA
172600       IF ((ROWSTR(ROWCNT)(TXPTR:1) = %33) AND                    080831ma
172700            (ROWSTR(ROWCNT)(TXPTR + 1:1) = %133 ))                080831ma
172710         OR (ROWSTR(ROWCNT)(TXPTR:1) = %133)                      080831ma
172810        If text-char > 0                                          080813ma
172900         MOVE "1" TO NEW-TEXT-FOUND-SW                            080813ma
173000         MOVE TEXT-CHAR TO TEXT-FLDLEN(TEXT-FLDCNT)               080813ma
173100         MOVE ROWCNT    TO TEXT-FLDROW(TEXT-FLDCNT)               080813ma
173200*         DISPLAY "TEXT: " TEXT-FLDCOL(TEXT-FLDCNT)               080828MA
173300*                          TEXT-FLDROW(TEXT-FLDCNT)               080828MA
173400*                     " "  TEXT-FLDENH(TEXT-FLDCNT)               080828MA
173500*         " [" TEXT-FLDSTR(TEXT-FLDCNT)(1:TEXT-CHAR) "]"          080828MA
173600         perform ADD-OBJ-text                                     ma080814
173700         MOVE 0 TO TEXT-CHAR                                      080813ma
173800        End-If                                                    080813ma
173900        MOVE "1" TO NON-TEXT-SW                                   080813ma
174000        Add 2 To TxPtr                                            080813ma
174100       END-IF                                                     080813ma
174200       IF ((ROWSTR(ROWCNT)(TXPTR:1) = %33)                        080831ma
174300           AND (ROWSTR(ROWCNT)(TXPTR + 1:1) = %135 ))             080831ma
174310          OR (ROWSTR(ROWCNT)(TXPTR:1) = %135)                     080831ma
174410         MOVE "0" TO NON-TEXT-SW                                  080813ma
174500         Add 2 To TxPtr                                           080813ma
174600       END-IF                                                     080813ma
174700       IF (ROWSTR(ROWCNT)(TXPTR:1) = %16)                         080813ma
174800        If text-char > 0                                          080813ma
174900         MOVE "1" TO NEW-TEXT-FOUND-SW                            080813ma
175000         MOVE TEXT-CHAR TO TEXT-FLDLEN(TEXT-FLDCNT)               080813ma
175100         MOVE ROWCNT    TO TEXT-FLDROW(TEXT-FLDCNT)               080813ma
175200*         DISPLAY "TEXT: " TEXT-FLDCOL(TEXT-FLDCNT)               080828MA
175300*                          TEXT-FLDROW(TEXT-FLDCNT)               080828MA
175400*                     " "  TEXT-FLDENH(TEXT-FLDCNT)               080828MA
175500*         " [" TEXT-FLDSTR(TEXT-FLDCNT)(1:TEXT-CHAR) "]"          080828MA
175600         perform ADD-OBJ-text                                     ma080814
175700         MOVE 0 TO TEXT-CHAR                                      080813ma
175800        End-If                                                    080813ma
175900        MOVE "1" TO NON-TEXT-SW                                   080813ma
176000        Add 1 To TxPtr                                            080813ma
176100       END-IF                                                     080813ma
176200       IF (ROWSTR(ROWCNT)(TXPTR:1) = %17)                         080813ma
176300        MOVE "0" TO NON-TEXT-SW                                   080813ma
176400        Add 1 To TxPtr                                            080813ma
176500       END-IF                                                     080813ma
176600       IF (IN-TEXT-AREA) AND ( TEXT-CHAR > 0 ) AND                080813ma
176700         ( (( ROWSTR(ROWCNT)(TXPTR:1)     = %40 ) AND             080813ma
176800           ( ROWSTR(ROWCNT)(TXPTR + 1:1) = %40 ))                 080813ma
176900          or                                                      080813ma
177000           (( ROWSTR(ROWCNT)(TXPTR:1)     = %0 ) AND              080813ma
177100           ( ROWSTR(ROWCNT)(TXPTR + 1:1) = %0 ))                  080813ma
177200          or                                                      080813ma
177300           ( text-char > 79 ) )                                   080813ma
177400        MOVE "1" TO NEW-TEXT-FOUND-SW                             080813ma
177500        MOVE TEXT-CHAR TO TEXT-FLDLEN(TEXT-FLDCNT)                080813ma
177600        MOVE ROWCNT    TO TEXT-FLDROW(TEXT-FLDCNT)                080813ma
177700*       DISPLAY "TEXT: " TEXT-FLDCOL(TEXT-FLDCNT)                 080828MA
177800*                        TEXT-FLDROW(TEXT-FLDCNT)                 080828MA
177900*                   " "  TEXT-FLDENH(TEXT-FLDCNT)                 080828MA
178000*       " [" TEXT-FLDSTR(TEXT-FLDCNT)(1:TEXT-CHAR) "]"            080828MA
178100         perform ADD-OBJ-text                                     ma080814
178200        MOVE 0 TO TEXT-CHAR                                       080813ma
178300       END-IF                                                     080813ma
178400       IF (IN-TEXT-AREA) AND ( NOT NEW-TEXT-FOUND ) AND           080813ma
178500          (((ROWSTR(ROWCNT)(TXPTR:1) > %37) AND TEXT-CHAR > 0)    080813ma
178600           OR                                                     080813ma
178700           ((ROWSTR(ROWCNT)(TXPTR:1) > %40) AND TEXT-CHAR = 0))   080813ma
178800        ADD 1 TO TEXT-CHAR                                        080813ma
178900        IF TEXT-CHAR = 1                                          080813ma
179000         ADD 1 TO TEXT-FLDCNT                                     080813ma
179100         MOVE TEXT-COLUMN TO TEXT-FLDCOL(TEXT-FLDCNT)             080813ma
179200         MOVE ROWCNT      TO TEXT-FLDROW(TEXT-FLDCNT)             080813ma
179300         MOVE TEXT-ENH    TO TEXT-FLDENH(TEXT-FLDCNT)             080813ma
179400        END-IF                                                    080813ma
179500        IF TEXT-CHAR < 81                                         080828MA
179600         MOVE ROWSTR(ROWCNT)(TXPTR:1)                             080828MA
179700           TO TEXT-FLDSTR(TEXT-FLDCNT)(TEXT-CHAR:1)               080828MA
179800        End-If                                                    080828MA
179900       END-IF                                                     080813ma
180000*      display "in=" NON-TEXT-SW "[" ROWSTR(ROWCNT)(TXPTR:1)      080828MA
180100*        "] txptr=" txptr                                         080828MA
180200*        " text column=" TEXT-COLUMN " text char=" TEXT-CHAR      080828MA
180300       ADD 1 TO TEXT-COLUMN                                       080813ma
180400      END-IF                                                      080813ma
180500     END-PERFORM.                                                 080813ma
180600     IF TEXT-CHAR > 0                                             080813ma
180700      MOVE TEXT-CHAR TO TEXT-FLDLEN(TEXT-FLDCNT)                  080813ma
180800      COMPUTE TEXT-FLDROW(TEXT-FLDCNT)= (ROWCNT - 1) END-COMPUTE  090512ma
180900      perform ADD-OBJ-text.                                       080828MA
181000*      DISPLAY "TEXT: " TEXT-FLDCOL(TEXT-FLDCNT)                  080828MA
181100*                       TEXT-FLDROW(TEXT-FLDCNT)                  080828MA
181200*                  " "  TEXT-FLDENH(TEXT-FLDCNT)                  080828MA
181300*        " [" TEXT-FLDSTR(TEXT-FLDCNT)(1:TEXT-CHAR) "]".          080828MA
181400*------------------------------------------------                 080813ma
181500 ADD-OBJ-DATAFIELD.                                               080813ma
181600D    DISPLAY "ADD-OBJ-DATAFIELD".                                 080828MA
181700     ADD 1 TO OBJCNT(ROWCNT).                                     080813ma
181800     ADD 1 TO FORM-SCRNORD.                                       080813ma
181900     COMPUTE ODF = F-idx + 2.                                     080813ma
182000     PERFORM VARYING ODF FROM ODF BY 1                            080813ma
182100       UNTIL ODF > F-xlen                                         080813ma
182200            or F-Design(ODF:1) > ' '                              080813ma
182300      CONTINUE                                                    080813ma
182400     END-PERFORM.                                                 080813ma
182500     PERFORM VARYING ODF FROM ODF BY 1                            080813ma
182600       UNTIL ODF > F-xlen                                         080813ma
182700            or F-Design(ODF:1) = %33                              080813ma
182800            or F-Design(ODF:1) = ' '                              080813ma
182900            or F-Design(ODF:1) = ']'                              080813ma
183000            or F-Design(ODF:1) = '.'                              080813ma
183100            or F-Design(ODF:1) = %0                               080813ma
183200      CONTINUE                                                    080813ma
183300     END-PERFORM.                                                 080813ma
183400     COMPUTE ODFLEN = (ODF - (F-idx + 2)).                        080813ma
183500     COMPUTE ODF = F-idx + 2.                                     080813ma
183510D    DISPLAY "ODFLEN=" ODFLEN.                                    080902ma
183520D    DISPLAY "ODF=" ODF.                                          080902ma
183530     IF ODF > 0 AND ODFLEN > 0                                    080831ma
183540D     DISPLAY "F-Design(ODF:ODFLEN) [" F-Design(ODF:ODFLEN) "]"   080902ma
183600      MOVE OBJCNT(ROWCNT) TO X                                    080831ma
183700      MOVE "DA"                 TO OBJ-TYPE(ROWCNT,X)             080831ma
183800      MOVE F-Design(ODF:ODFLEN) TO OBJ-NAME(ROWCNT,X)             080831ma
183900      MOVE FORM-SCRNORD         TO OBJ-SRNORD(ROWCNT,X)           080831ma
184000      MOVE ROWCNT               TO OBJ-STRTROW(ROWCNT,X)          080831ma
184100      COMPUTE OBJ-STRTCOL(ROWCNT,X) = ROW-COLUMN + 2              080831ma
184200      INITIALIZE OBJ-VALUE(ROWCNT,X) OBJ-FLDNUM(ROWCNT,X)         080831ma
184300      Move 1 to OBJ-LEN(ROWCNT,X).                                080831ma
184400*------------------------------------------------                 080813ma
184500 ADD-OBJ-SCRNMSG.                                                 080813ma
184600D    DISPLAY "ADD-OBJ-SCRNMSG".                                   080828MA
184700     ADD 1 TO OBJCNT(ROWCNT).                                     080813ma
184800     MOVE OBJCNT(ROWCNT) TO X.                                    080813ma
184900     MOVE "MW"                 TO OBJ-TYPE(ROWCNT,X).             080813ma
185000     MOVE "SCREEN-MSG"         TO OBJ-NAME(ROWCNT,X).             080813ma
185100     MOVE 0                    TO OBJ-SRNORD(ROWCNT,X).           080813ma
185200     MOVE ROWCNT               TO OBJ-STRTROW(ROWCNT,X)           080813ma
185300     MOVE 1                    TO OBJ-STRTCOL(ROWCNT,X).          080813ma
185400     INITIALIZE OBJ-VALUE(ROWCNT,X) OBJ-FLDNUM(ROWCNT,X) .        080813ma
185500     Move 80 to OBJ-LEN(ROWCNT,X).                                ma080814
185600                                                                  ma080814
185700*------------------------------------------------                 080813ma
185800 ADD-OBJ-ENHANCEMENT.                                             080813ma
185900D    DISPLAY "ADD-OBJ-ENHANCEMENT".                               080828MA
186000     ADD 1 TO OBJCNT(ROWCNT).                                     080813ma
186100     MOVE OBJCNT(ROWCNT) TO X.                                    080813ma
186200     MOVE "EN"                 TO OBJ-TYPE(ROWCNT,X).             080813ma
186300     MOVE "ENHANCEMENT"        TO OBJ-NAME(ROWCNT,X).             080813ma
186400     MOVE 0                    TO OBJ-SRNORD(ROWCNT,X).           080813ma
186500     MOVE ROWCNT               TO OBJ-STRTROW(ROWCNT,X)           080813ma
186600     MOVE ROW-COLUMN TO OBJ-STRTCOL(ROWCNT,X).                    080813ma
186700     PERFORM VARYING ENHIDX FROM 1 BY 1                           080813ma
186800      UNTIL HPENH(ENHIDX) = PARSED-STRING(4:1)                    080813ma
186900         OR ENHIDX > 18                                           090512ma
187000      CONTINUE                                                    080813ma
187100     END-PERFORM.                                                 080813ma
187200     MOVE VPLUSENH(ENHIDX) TO OBJ-VALUE(ROWCNT,X)                 080813ma
187300     INITIALIZE OBJ-FLDNUM(ROWCNT,X).                             080813ma
187400     Move 4 to OBJ-LEN(ROWCNT,X).                                 ma080814
187500*------------------------------------------------                 ma080814
187600 ADD-OBJ-text.                                                    ma080814
187700D    DISPLAY "ADD-OBJ-text".                                      080828MA
187800     ADD 1 TO OBJCNT(ROWCNT).                                     ma080814
187900     MOVE OBJCNT(ROWCNT) TO X.                                    ma080814
188000     MOVE "TX"                     TO OBJ-TYPE(ROWCNT,X).         ma080814
188100     MOVE "TEXT"                   TO OBJ-NAME(ROWCNT,X).         ma080814
188200     MOVE 0                        TO OBJ-SRNORD(ROWCNT,X).       ma080814
188300     MOVE TEXT-FLDROW(TEXT-FLDCNT) TO OBJ-STRTROW(ROWCNT,X)       ma080814
188400     MOVE TEXT-FLDCOL(TEXT-FLDCNT) TO OBJ-STRTCOL(ROWCNT,X)       ma080814
188500     MOVE TEXT-FLDLEN(TEXT-FLDCNT) TO OBJ-LEN(ROWCNT,X)           ma080814
188600     move TEXT-FLDENH(TEXT-FLDCNT) TO OBJ-ENH(ROWCNT,X)           ma080814
188700     If Text-Char > 80 Move 80 To Text-Char End-If                080828MA
188800     MOVE TEXT-FLDSTR(TEXT-FLDCNT)(1:TEXT-CHAR)                   ma080814
188900       TO OBJ-VALUE(ROWCNT,X)                                     ma080814
189000     INITIALIZE OBJ-FLDNUM(ROWCNT,X).                             ma080814
189100     Move TEXT-CHAR to OBJ-LEN(ROWCNT,X).                         ma080814
189200*------------------------------------------------                 080825MA
189300 ADD-OBJ-FKEY.                                                    080825MA
189400D    DISPLAY "ADD-OBJ-FKEY".                                      080828MA
189500     MOVE 25 TO ROWCNT.                                           080828MA
189600     ADD 1 TO OBJCNT(ROWCNT).                                     080825MA
189700     MOVE "FK"                     TO OBJ-TYPE(ROWCNT,X).         080828MA
189800     MOVE "FKEY"                   TO OBJ-NAME(ROWCNT,X).         080828MA
189900     MOVE 0                        TO OBJ-SRNORD(ROWCNT,X).       080828MA
190000     STRING FKEY-LINE1(x) FKEY-LINE2(x)                           080830ma
190100      DELIMITED BY SIZE          INTO OBJ-VALUE(ROWCNT,X).        080828MA
190200     MOVE ROWCNT                   TO OBJ-STRTROW(ROWCNT,X).      080828MA
190300     IF X < 5                                                     080825MA
190400      COMPUTE OBJ-STRTCOL(ROWCNT,X) = ((X * 8) - ( 8 - X))        080828MA
190500     ELSE                                                         080825MA
190600      COMPUTE OBJ-STRTCOL(ROWCNT,X) = ((X * 8) +  X).             080828MA
190700     MOVE 16                       TO OBJ-LEN(ROWCNT,X)           080828MA
190800     move "HI"                     TO OBJ-ENH(ROWCNT,X)           080828MA
190900     INITIALIZE OBJ-FLDNUM(ROWCNT,X).                             080828MA
191000                                                                  080825MA
191100                                                                  080825MA
191200*------------------------------------------------                 080813ma
191300 ADD-OBJ-LINEDRAW.                                                080813ma
191400D    DISPLAY "ADD-OBJ-LINEDRAW".                                  080831ma
191500     ADD 1 TO OBJCNT(ROWCNT).                                     080813ma
191600     MOVE OBJCNT(ROWCNT) TO X.                                    080813ma
191700     MOVE "LD"                 TO OBJ-TYPE(ROWCNT,X).             080813ma
191800     MOVE "Line"               TO OBJ-NAME(ROWCNT,X).             080813ma
191900     MOVE 0                    TO OBJ-SRNORD(ROWCNT,X).           080813ma
192000     MOVE ROWCNT               TO OBJ-STRTROW(ROWCNT,X)           080813ma
192100     MOVE ROW-COLUMN TO OBJ-STRTCOL(ROWCNT,X).                    080813ma
192200     MOVE PARSED-STRING(1:ld-len) TO OBJ-VALUE(ROWCNT,X)          080813ma
192300     INITIALIZE OBJ-FLDNUM(ROWCNT,X).                             080813ma
192400     Move ld-len to OBJ-LEN(ROWCNT,X).                            ma080814
192500*-----------------------------------------------------------      080813ma
192600 GET-ESCAPE-SEQ-LENGTH.                                           080813ma
192700D     Display "GET-ESCAPE-SEQ-LENGTH".                            080831ma
192800*                                                                 080813ma
192900* The octal value 101 thru 132 define the upper case alpha        080813ma
193000* characters in the ASCII Collating Sequence.                     080813ma
193100*                                                                 080813ma
193200* All escape sequences sent to HP teminals are terminated         080813ma
193300* with an upper case alpha character.                             080813ma
193400*                                                                 080813ma
193500     Perform Varying Esc-len from F-idx by 1                      080813ma
193600       until (Esc-len > F-xlen)                                   080813ma
193700          or (F-Design(Esc-len:1) >= %101 and                     080813ma
193800              F-Design(Esc-len:1) <= %132)                        080813ma
193900          or (F-Design(Esc-len:1) = "@" )                         080813ma
194000          or (F-Design(Esc-len:1) = %15 AND                       080813ma
194100              F-Design(Esc-len + 1:1) = %12 )                     080813ma
194200      CONTINUE                                                    080813ma
194300     End-Perform.                                                 080813ma
194400     COMPUTE ESC-LEN = (ESC-LEN - F-IDX) + 1.                     080813ma
194500     MOVE F-Design(F-idx:Esc-len) TO PARSED-STRING.               080813ma
194600     INSPECT PARSED-STRING REPLACING ALL %33 BY ".".              080813ma
194700*    Display "ESCAPE-SEQ [" PARSED-STRING(1:Esc-len) "]".         080813ma
194800     IF ESC-LEN = 4                                               080813ma
194900      IF PARSED-STRING(2:2) = "&d"                                080813ma
195000       PERFORM ADD-OBJ-ENHANCEMENT.                               080813ma
195100                                                                  080813ma
195200*-----------------------------------------------------------      080813ma
195300 GET-Linedrawing.                                                 080813ma
195400D    Display "GET-Linedrawing".                                   080831ma
195500*                                                                 080813ma
195600* The octal value 16 begins the line drawing character set.       080813ma
195700* The octal value 17 ends the line drawing character set.         080813ma
195800*    Add 1 To F-idx.                                              080828MA
195900     INITIALIZE PARSED-STRING.                                    080828MA
196000     Perform Varying LD-IDX from F-idx by 1                       080828MA
196100       until (LD-IDX > F-xlen)                                    080828MA
196200          or (F-Design(LD-IDX:1) = %0 OR %12 OR %15 OR %17)       080828MA
196300                                                                  080828MA
196400      IF (F-DESIGN(LD-IDX:1) <> %0 OR %12 OR %15 OR %17) AND      080828MA
196500         (F-DESIGN(LD-IDX:1) >= " ")                              080828MA
196600       ADD 1 TO LD-LEN                                            080828MA
196700       MOVE F-Design(F-idx:LD-IDX) TO PARSED-STRING(LD-LEN:1)     080828MA
196800      END-IF                                                      080828MA
196900     End-Perform.                                                 080813ma
197000     If ld-len > 0 and ld-len < 128                               080828MA
197100      INSPECT PARSED-STRING REPLACING ALL %16 BY "."              080828MA
197200      INSPECT PARSED-STRING REPLACING ALL %17 BY "."              080828MA
197300D     Display "Line Draw [" PARSED-STRING(1:ld-len) "]"           090323ma
197400      PERFORM ADD-OBJ-LINEDRAW.                                   080828MA
197500                                                                  080813ma
197600*---------------------------------------------------------------- 080813ma
197700 GET-T-RECORDS.                                                   080813ma
197800D    DISPLAY "GET-T-RECORDS".                                     080828MA
197900*                                                                 080813ma
198000* L O A D    "T"    R E C O R D S                                 080813ma
198100*                                                                 080813ma
198200     INITIALIZE T-RECORD.                                         080813ma
198300     MOVE "0" TO VALID-T-SW.                                      080813ma
198400     Perform Varying Frdidx From 1 By 1                           080813ma
198500       Until (VALID-T) OR ( Frdidx > Frdcnt )                     080813ma
198600      Move Frdstr(Frdidx)(1:2) To Ascii-Character                 080813ma
198700      If (Frdstr(Frdidx)(4:deslen) = Design-name(1:deslen))       080813ma
198800          And (Frdstr(Frdidx)(3:1) = "T")                         080813ma
198900          And ( Ascii-Value > 0 )                                 080813ma
199000       Compute T-STRT = ((Frdidx * 256) - 255 ) End-compute       080813ma
199100       Compute T-END  = T-STRT + (Ascii-Value - 1) End-Compute    080813ma
199200       Move Ascii-Value To T-LEN                                  080813ma
199300       Move frd-table(T-STRT:T-LEN) to T-RECORD                   080813ma
199400       MOVE T-HEADER TO T-HEADER-FORMAT                           080813ma
199500       IF (( THF-LENGTH = T-LEN)) AND                             080813ma
199600          (((( THF-CNT1 * 62) + 40) = THF-LENGTH )                080813ma
199700           OR ((( THF-CNT2 * 62) + 40) = THF-LENGTH ))            080813ma
199800        MOVE "1" TO VALID-T-SW                                    080813ma
199900        PERFORM VARYING TIDX FROM 1 BY 1                          080813ma
200000          UNTIL TIDX > THF-CNT1                                   080813ma
200100         MOVE T-FIELD(TIDX) TO T-FIELD-FORMAT                     080813ma
200200         ADD 1 TO TFF-ROW                                         080813ma
200300         ADD 1 TO TFF-COL                                         080813ma
200400         MOVE T-FIELD-FORMAT TO T-FIELD(TIDX)                     080813ma
200500         MOVE %0 TO ASCII-BYTE1                                   080813ma
200600         MOVE TFF-A TO ASCII-BYTE2                                080813ma
200700*        DISPLAY TFF-FLD1 " " TFF-ENH " " TFF-ESCVAL " "          080828MA
200800*                Ascii-Value " " TFF-FLDNUM " " TFF-SCRNODR       080828MA
200900*                " " TFF-LEN " " TFF-ROW " " TFF-COL              080828MA
201000        END-PERFORM                                               080813ma
201100       END-IF                                                     080813ma
201200      END-IF                                                      080813ma
201300     END-PERFORM.                                                 080813ma
201400*---------------------------------------------------------------- 080813ma
201500 GET-D-RECORDS.                                                   080813ma
201600D    DISPLAY "GET-D-RECORDS".                                     080828MA
201700*                                                                 080813ma
201800* L O A D    "D"    R E C O R D S                                 080813ma
201900*                                                                 080813ma
202000     INITIALIZE D-RECORD DIDX D-LEN D-STRT D-END.                 080813ma
202100     MOVE "0" TO VALID-D-SW.                                      080813ma
202200     Perform Varying Frdidx From 1 By 1                           080813ma
202300       Until ( Frdidx > Frdcnt )                                  080813ma
202400      Move Frdstr(Frdidx)(1:2) To Ascii-Character                 080813ma
202500      If (Frdstr(Frdidx)(3:1) = "D") AND (Ascii-Value > 0)        080813ma
202600       Compute D-STRT = ((Frdidx * 256) - 255 ) End-compute       080813ma
202700       Compute D-END  = D-STRT + (Ascii-Value - 1) End-Compute    080813ma
202800       Move Ascii-Value To D-LEN                                  080813ma
202900       ADD 1 TO DIDX                                              080813ma
203000*      DISPLAY "Frdidx      =" Frdidx                             ma080814
203100*      DISPLAY "D-STRT      =" D-STRT                             ma080814
203200*      DISPLAY "D-END       =" D-END                              ma080814
203300*      DISPLAY "Ascii-Value =" Ascii-Value                        ma080814
203400*      DISPLAY "D-LEN       =" D-LEN                              ma080814
203500       Move frd-table(D-STRT:D-LEN) to D-RECORD-ENTRIES(DIDX)     080813ma
203600       MOVE D-HEADER(DIDX) TO D-HEADER-FORMAT                     080813ma
203700       IF DHF-LENGTH = 102                                        080813ma
203800        MOVE "1" TO VALID-D-SW                                    080813ma
203900        MOVE D-FIELD(DIDX) TO D-FIELD-FORMAT                      080813ma
204000        INITIALIZE NUM1 NUM2 NUMDEC NUMERR                        080813ma
204100        MOVE DFF-LEN TO NUM1                                      080813ma
204200*       DISPLAY "DFF-LEN       =" DFF-LEN                         ma080814
204300        CALL "NUMGET" USING NUM1 NUM2 NUMDEC NUMERR               080813ma
204400        IF NUM2 > 0 AND NUM2 < 62                                 080813ma
204500         DISPLAY "S A V E    F I E L D:  "                        080813ma
204600           DFF-FLD1 " " DFF-LEN " " DFF-DTYPE                     080813ma
204700           " Init [" DFF-INIT(1:NUM2) "]"                         080813ma
204800        ELSE                                                      080813ma
204900         DISPLAY "S A V E    F I E L D:  "                        080813ma
205000           DFF-FLD1 " " DFF-LEN " " DFF-DTYPE                     080813ma
205100           " Init []"                                             080813ma
205200        END-IF                                                    080813ma
205300       END-IF                                                     080813ma
205400      END-IF                                                      080813ma
205500     END-PERFORM.                                                 080813ma
205600*---------------------------------------------------------------- 080813ma
205700 GET-G-RECORDS.                                                   080813ma
205800D    DISPLAY "GET-G-RECORDS".                                     080828MA
205900*                                                                 080813ma
206000* L O A D    "G"    R E C O R D S                                 080813ma
206100*                                                                 080813ma
206200     INITIALIZE G-DATA-STORAGE.                                   080831ma
206300     IF NOT GFILE-CLOSED PERFORM CLOSE-GFILE.                     080830ma
206400     PERFORM OPEN-GFILE-OUTPUT.                                   080830ma
206500     MOVE "0" TO VALID-G-SW.                                      080813ma
206600     Perform Varying Frdidx From 1 By 1                           080813ma
206700       Until ( Frdidx > Frdcnt )                                  080813ma
206800      Move Frdstr(Frdidx)(1:2) To Ascii-Character                 080813ma
206900      If (Frdstr(Frdidx)(3:1) = "G")                              080813ma
207000       Compute G-STRT = ((Frdidx * 256) - 255 ) End-compute       080813ma
207100       Compute G-END  = G-STRT + (Ascii-Value - 1) End-Compute    080813ma
207200       Move Ascii-Value To G-LEN                                  080813ma
207300       If G-Len > 0 and G-Len < 1540                              080830ma
207400        ADD 1 TO GIDX                                             080830MA
207500        Move frd-table(G-STRT:G-LEN) to G-RECORD                  080831ma
207600        MOVE G-HEADER TO G-HEADER-FORMAT                          080830ma
207700        IF GHF-LENGTH < 1536                                      080830MA
207800         MOVE "1" TO VALID-G-SW                                   080830MA
207900         MOVE G-FIELD TO G-FIELD-FORMAT                           080830ma
208000         INITIALIZE NUM1 NUM2 NUMDEC NUMERR                       080830MA
208100         MOVE GFF-LEN TO NUM1                                     080830MA
208200         CALL "NUMGET" USING NUM1 NUM2 NUMDEC NUMERR              080830MA
208300         IF NUM2 < 1                                              080830MA
208400          MOVE 1 TO NUM2                                          080830MA
208500         END-IF                                                   080830MA
208600         IF NUM2 > 62                                             080830MA
208700          MOVE 62 TO NUM2                                         080830MA
208800         END-IF                                                   080830MA
208900         PERFORM WRITE-GFILE                                      080830ma
209000*        DISPLAY "DATA FIELD:  "                                  080830MA
209100*          GFF-FORM " " GFF-FIELD " " GFF-NUM GFF-LEN             080830MA
209200*          GFF-ENH " " GFF-FTYPE " " GFF-DTYPE                    080830MA
209300*          " Init [" GFF-INIT(1:NUM2) "]"                         080830MA
209400        END-IF                                                    080830MA
209500       End-If                                                     080830MA
209600      END-IF                                                      080813ma
209700     END-PERFORM.                                                 080813ma
209800     MOVE GIDX TO GCNT.                                           080813ma
209900*----------------------------------------------------             080813ma
210000 CHKALL-G-STRINGS.                                                080813ma
210100D    DISPLAY "CHKALL-G-STRINGS".                                  080831ma
210200     MOVE "0" TO MATCH-SW.                                        080813ma
210300     IF NOT GFILE-CLOSED PERFORM CLOSE-GFILE.                     080830ma
210400     PERFORM OPEN-GFILE-INPUT.                                    080830ma
210500     PERFORM VARYING GIDX FROM 1 BY 1                             080813ma
210600       UNTIL MATCH-FOUND OR GIDX > GCNT                           080813ma
210700      PERFORM READ-GFILE                                          080830ma
210800      IF NOT GFILE-EOF                                            080830ma
210900       MOVE G-HEADER TO G-HEADER-FORMAT                           080830ma
211000       MOVE G-FIELD  TO G-FIELD-FORMAT                            080830ma
211100       INITIALIZE NUM1 NUM2 NUMDEC NUMERR                         080830ma
211200       MOVE GFF-LEN TO NUM1                                       080830ma
211300       CALL "NUMGET" USING NUM1 NUM2 NUMDEC NUMERR                080830ma
211400       MOVE FUNCTION UPPER-CASE(FFFLDS-VFLD-NAME)                 080830ma
211500         TO NEXT-STRING                                           080830ma
211600       MOVE FUNCTION UPPER-CASE(GFF-FIELD) TO PARSED-STRING       080830ma
211700       IF  NEXT-STRING = PARSED-STRING        AND                 080830ma
211800           FFFLDS-VFLD-LENGTH  = NUM2     AND                     080830ma
211900           FFFLDS-VFLD-ENHANCE = GFF-ENH                          080830ma
212000*        DISPLAY "MATCH FOUND:  "                                 080830ma
212100*           GFF-FORM " " GFF-FIELD " " GFF-NUM GFF-LEN            080830ma
212200*           GFF-ENH " " GFF-FTYPE " " GFF-DTYPE                   080830ma
212300        MOVE "1" TO MATCH-SW                                      080830ma
212400       END-IF                                                     080830ma
212500      END-IF                                                      080813ma
212600     END-PERFORM.                                                 080813ma
212700*---------------------------------------------------------------- 080813ma
212800 GET-E-RECORDS.                                                   080813ma
212900D    DISPLAY "GET-E-RECORDS".                                     080831ma
213000*                                                                 080813ma
213100* L O A D    "E"    R E C O R D S                                 080813ma
213200*                                                                 080813ma
213300     INITIALIZE E-RECORD.                                         080813ma
213400     MOVE "0" TO VALID-G-SW.                                      080813ma
213500     Perform Varying Frdidx From 1 By 1                           080813ma
213600       Until ( Frdidx > Frdcnt )                                  080813ma
213700      Move Frdstr(Frdidx)(1:2) To Ascii-Character                 080813ma
213800      If (Frdstr(Frdidx)(3:1) = "E")                              080813ma
213900            And (Ascii-Value  > 113 and Ascii-Value < 150)        080813ma
214000       Compute E-STRT = ((Frdidx * 256) - 255 ) End-compute       080813ma
214100       Compute E-END  = E-STRT + (Ascii-Value - 1) End-Compute    080813ma
214200       Move Ascii-Value To E-LEN                                  080813ma
214300       ADD 1 TO EIDX                                              080813ma
214400       Move frd-table(E-STRT:E-LEN) to E-RECORD-ENTRIES(EIDX)     080813ma
214500       If (E-FORM1(EIDX) <> E-FORM2(EIDX)) and                    ma080814
214600          (E-FORM2(EIDX)(1:1) <= " ")                             ma080814
214700        Initialize E-RECORD-ENTRIES(EIDX)                         ma080814
214800        Subtract 1 from Eidx                                      ma080814
214900*      Else                                                       080828MA
215000*       DISPLAY E-FORM1(EIDX)                                     080828MA
215100*              E-REPEAT-OPTION(EIDX)                              080828MA
215200*              E-NFORM-OPTION(EIDX)                               080828MA
215300*              E-NFORM(EIDX)                                      080828MA
215400*              E-FKEY-DEF(EIDX)                                   080828MA
215500*              E-REPRODUCED-FR(EIDX)                              080828MA
215600*              E-COMMENTS(EIDX)(1:30)                             080828MA
215700       End-If                                                     080828MA
215800      END-IF                                                      080813ma
215900     END-PERFORM.                                                 080813ma
216000     MOVE EIDX TO ECNT.                                           080813ma
216100$PAGE "MISC. ERROR CONDITION SUBROUTINES"                         080813ma
216200 9001-FILE-ERROR.                                                 080813ma
216300D    DISPLAY "9001-FILE-ERROR".                                   080813ma
216400     MOVE SPACES TO FILE-ERROR-RECORD.                            080813ma
216500     MOVE "00" TO ERROR-NUMBER.                                   080813ma
216600*     IF FNAME = "PRINTER" MOVE PRINTER-STATUS TO ERROR-NUMBER.   080813ma
216700     IF FNAME = "FORMFILE" MOVE FORMFILE-STATUS TO ERROR-NUMBER.  080830ma
216800     IF FNAME = "GFILE"    MOVE GFILE-STATUS TO ERROR-NUMBER.     080830ma
216900     EVALUATE ERROR-NUMBER                                        080813ma
217000     WHEN "00" MOVE "0" TO ERRORS-SW                              080813ma
217100     WHEN "04" MOVE "1" TO ERRORS-SW                              080813ma
217200               STRING "Read length of record  doesn't match "     080813ma
217300                      FNAME " length."                            080813ma
217400                      DELIMITED BY SIZE INTO FILE-ERROR-RECORD    080813ma
217500     WHEN "05" MOVE "0" TO ERRORS-SW                              080813ma
217600               STRING "OPEN " FNAME " not present,  created."     080813ma
217700                      DELIMITED BY SIZE INTO FILE-ERROR-RECORD    080813ma
217800     WHEN "07" MOVE "1" TO ERRORS-SW                              080813ma
217900               STRING FNAME " is not a tape as the OPEN/CLOSE "   080813ma
218000                      "phrase implies."                           080813ma
218100                      DELIMITED BY SIZE INTO FILE-ERROR-RECORD    080813ma
218200     WHEN "30" MOVE "1" TO ERRORS-SW                              080813ma
218300               STRING FNAME " error.  problem unknown! "          080813ma
218400                      DELIMITED BY SIZE INTO FILE-ERROR-RECORD    080813ma
218500     WHEN "34" MOVE "1" TO ERRORS-SW                              080813ma
218600               STRING FNAME " boundary violation."                080813ma
218700                      DELIMITED BY SIZE INTO FILE-ERROR-RECORD    080813ma
218800     WHEN "35" MOVE "1" TO ERRORS-SW                              080813ma
218900               STRING FNAME " not found."                         080813ma
219000                      DELIMITED BY SIZE INTO FILE-ERROR-RECORD    080813ma
219100     WHEN "37" MOVE "1" TO ERRORS-SW                              080813ma
219200               STRING FNAME " error.  Inconsistent operation "    080813ma
219300                      "during file I/O !"                         080813ma
219400                      DELIMITED BY SIZE INTO FILE-ERROR-RECORD    080813ma
219500     WHEN "39" MOVE "1" TO ERRORS-SW                              080813ma
219600               STRING "OPEN " FNAME " failed due to fixed file"   080813ma
219700                      " attribute conflict."                      080813ma
219800                      DELIMITED BY SIZE INTO FILE-ERROR-RECORD    080813ma
219900     WHEN "41" MOVE "0" TO ERRORS-SW                              080813ma
220000               STRING FNAME " was already opened."                080813ma
220100                      DELIMITED BY SIZE INTO FILE-ERROR-RECORD    080813ma
220200     WHEN "42" MOVE "0" TO ERRORS-SW                              080813ma
220300               STRING "CLOSE " FNAME " without openning first."   080813ma
220400                      DELIMITED BY SIZE INTO FILE-ERROR-RECORD    080813ma
220500     WHEN "44" MOVE "1" TO ERRORS-SW                              080813ma
220600               STRING FNAME " error.   boundary violation, "      080813ma
220700                      " Record too big or record too small."      080813ma
220800                      DELIMITED BY SIZE INTO FILE-ERROR-RECORD    080813ma
220900     WHEN "46" MOVE "1" TO ERRORS-SW                              080813ma
221000               STRING "READ " FNAME " after AT END  or   after"   080813ma
221100                      " unsuccessful READ."                       080813ma
221200                      DELIMITED BY SIZE INTO FILE-ERROR-RECORD    080813ma
221300     WHEN "47" MOVE "1" TO ERRORS-SW                              080813ma
221400               STRING "READ on " FNAME " not open for INPUT."     080813ma
221500                      DELIMITED BY SIZE INTO FILE-ERROR-RECORD    080813ma
221600     WHEN "48" MOVE "1" TO ERRORS-SW                              080813ma
221700               STRING "WRITE on " FNAME " not open for OUTPUT."   080813ma
221800                      DELIMITED BY SIZE INTO FILE-ERROR-RECORD    080813ma
221900     WHEN "49" MOVE "1" TO ERRORS-SW                              080813ma
222000               STRING "REWRITE on " FNAME                         080813ma
222100                      " not open for I-O."                        080813ma
222200                      DELIMITED BY SIZE INTO FILE-ERROR-RECORD    080813ma
222300     WHEN OTHER MOVE "1" TO ERRORS-SW                             080813ma
222400                MOVE ERROR-NUMBER TO DECIMAL-VALUE                080813ma
222500                STRING FNAME " ERROR #" ERROR-NUMBER              080813ma
222600                             " MESSAGE UNDEFINED ."               080813ma
222700                DELIMITED BY SIZE INTO FILE-ERROR-RECORD.         080813ma
222800     MOVE ERROR-NUMBER TO ASCII-CHARACTER.                        080813ma
222900     IF ASCII-BYTE1 = "9"                                         080813ma
223000        MOVE ASCII-BYTE2 TO Ascii-Value                           080813ma
223100        MOVE Ascii-Value TO DISP-N                                080813ma
223200        DISPLAY "MPE FILE ERROR #" DISP-N                         080813ma
223300        MOVE "1" TO ERRORS-SW                                     080813ma
223400        MOVE SPACES TO FILE-ERROR-RECORD                          080813ma
223500        CALL INTRINSIC "FERRMSG" USING                            080813ma
223600            Ascii-Value FILE-ERROR-RECORD I.                      080813ma
223700     IF NOT ERRORS DISPLAY FILE-ERROR-RECORD                      080813ma
223800     ELSE GO TO 9900-ABEND.                                       080813ma
223900     MOVE FILE-ERROR-RECORD TO EDIT-MESSAGE.                      080813ma
224000     PERFORM 7805-LOG-EDIT-MESSAGE.                               080813ma
224100*--------------------------                                       080813ma
224200 7805-LOG-EDIT-MESSAGE.                                           080813ma
224300     DISPLAY EDIT-MESSAGE.                                        080813ma
224400***************************************************************** 080813ma
224500 9900-ABEND.                                                      080813ma
224600     DISPLAY "----------------------------------------".          080813ma
224700     DISPLAY "-MIG898- ABNORMAL END OF PROGRAM".                  080902ma
224800     DISPLAY "----------------------------------------".          080813ma
224900*---------------------------------------------------------------  080813ma
225000 9999-RETURN.                                                     080813ma
225010     Display " END OF PROGRAM "  WITH NO ADVANCING.               080902ma
225120     MOVE "SHOWTIME" TO CMD.                                      080902ma
225130     PERFORM MPE-COMMAND.                                         080902ma
225140     IF FILE-ERROR-RECORD NOT = SPACES DISPLAY FILE-ERROR-RECORD. 080813ma
225200     IF NOT FORMFILE-CLOSED  CLOSE FORMA-FILE.                    080813ma
225300     GOBACK.                                                      080813ma
225400*---------------------------------------------------------------- ma080814
225500 VGETINFO.                                                        ma080814
225600D    DISPLAY "VGETINFO".                                          ma080814
225700D    STRING  "Adding: " SCREEN-FORMS-FILE                         080820MA
225800D     DELIMITED BY SIZE INTO M.                                   080820MA
225900D    PERFORM MSG-PROCESS.                                         080820MA
226000     INITIALIZE SCREEN-COMAREA.                                   080820MA
226100     MOVE 60 TO SCREEN-COMAREALEN.                                080820MA
226200     CALL "VOPENFORMF" USING SCREEN-COMAREA, SCREEN-FORMS-FILE.   080820MA
226300     IF  SCREEN-CSTATUS <> 0 PERFORM 9000-VPLUS-ERROR.            080820MA
226400     MOVE SPACES TO FILE-INFOBUF.                                 ma080814
226500     MOVE 60 TO SCREEN-COMAREALEN.                                ma080814
226600     MOVE 1 TO FILE-NUMBER-OF-ENTRIES.                            ma080814
226700     MOVE 19 TO FILE-ENTRY-LENGTH.                                ma080814
226800     INITIALIZE SCREEN-CSTATUS.                                   ma080814
226900     CALL "VGETFILEINFO" USING SCREEN-COMAREA FILE-INFOBUF        ma080814
227000                               FILE-INFOBUFLEN.                   ma080814
227100     MOVE in-FILE-VERSION(1) TO VTIMESTAMP.                       080820MA
227200     MOVE 0 TO CLOCK-DINT.                                        080820MA
227300     MOVE VTS-WORD2 TO CLK-WORD1.                                 080820MA
227400     CALL INTRINSIC "FMTDATE"   USING VTS-WORD1                   080820MA
227500                                      CLOCK-DINT                  080820MA
227600                                      MY-TIMESTAMP.               080820MA
227700     Perform Store-File-Data.                                     080820MA
227800*---- Get form info -------*                                      ma080814
227900     MOVE SPACES TO FORM-INFOBUF.                                 ma080814
228000     MOVE FILE-NUMBER-OF-FORMS(1) TO FORM-NUMBER-OF-ENTRIES       ma080814
228100     MOVE 20                      TO FORM-ENTRY-LENGTH            ma080814
228200     COMPUTE FORM-INFOBUFLEN =                                    ma080814
228300       2 + ( FORM-NUMBER-OF-ENTRIES * FORM-ENTRY-LENGTH)          ma080814
228400       END-COMPUTE                                                ma080814
228500     MOVE 1 TO FORM-FORM-NUMBER(1)                                ma080814
228600     INITIALIZE SCREEN-CSTATUS                                    ma080814
228700     CALL "VGETFORMINFO" USING SCREEN-COMAREA FORM-INFOBUF        ma080814
228800                               FORM-INFOBUFLEN.                   ma080814
228900*/\/\/\/\/\/\ WORK-AROUND                                         ma080814
229000*                                                                 ma080814
229100*   VPLUS VGETFORMINFO BUG THAT RETURNS BLANK FORM NAMES          ma080814
229200                                                                  ma080814
229300     MOVE FILE-NUMBER-OF-FORMS(1) TO ACTUAL-FORM-COUNT.           ma080814
229400     PERFORM VARYING FRMIDX FROM 1 BY 1                           ma080814
229500       UNTIL (FRMIDX > FILE-NUMBER-OF-FORMS(1))                   ma080814
229600      IF FORM-FORM-NAME(FRMIDX) = SPACES                          ma080814
229700       MOVE "!@#$%^&*()_+" TO FORM-FORM-NAME(FRMIDX)              ma080814
229800       SUBTRACT 1  FROM ACTUAL-FORM-COUNT                         ma080814
229900      END-IF                                                      ma080814
230000     END-PERFORM                                                  ma080814
230100*                                                                 ma080814
230200*\/\/\/\/\/\/ END WORK-AROUND                                     ma080814
230300     PERFORM VARYING FRMIDX FROM 1 BY 1                           ma080814
230400       UNTIL (FRMIDX > FILE-NUMBER-OF-FORMS(1))                   ma080814
230500D     DISPLAY "PROCESSING NEXT FORM IN " SCREEN-FORMS-FILE        080831ma
230600D     DISPLAY "FORM NUMBER " FRMIDX                               080831ma
230700      IF FORM-FORM-NAME(FRMIDX) <> "!@#$%^&*()_+"                 ma080814
230800       PERFORM Store-Form-Data                                    080820MA
230900       MOVE SPACES TO FIELD-INFOBUF                               ma080814
231000       MOVE FORM-NUMBER-OF-FIELDS(FRMIDX)                         ma080814
231100         TO FIELD-NUMBER-OF-ENTRIES                               ma080814
231200       MOVE 14 TO FIELD-ENTRY-LENGTH                              ma080814
231300D      DISPLAY "228.91  PROCESSING FIELDS IN "                    080831ma
231400D              FORM-FORM-NAME(FRMIDX)                             080831ma
231500       COMPUTE FIELD-INFOBUFLEN =                                 ma080814
231600        10 + ( FIELD-NUMBER-OF-ENTRIES * FIELD-ENTRY-LENGTH)      ma080814
231700        END-COMPUTE                                               ma080814
231800       MOVE FORM-FORM-NAME(FRMIDX) TO FIELD-FORM-NAME             ma080814
231900       INITIALIZE SCREEN-CSTATUS                                  ma080814
232000D      DISPLAY "229.41 CALLING VGETFIELDINFO"                     080831ma
232100       CALL "VGETFIELDINFO" USING SCREEN-COMAREA,                 080831ma
232200                          FIELD-INFOBUF, FIELD-INFOBUFLEN         ma080814
232300       MOVE FORM-FORM-NAME(FRMIDX) TO SCREEN-NFNAME SCREEN-NAME   ma080814
232400D      DISPLAY "229.8  PROCESSING FIELDS IN "                     080831ma
232500D              FORM-FORM-NAME(FRMIDX)                             080831ma
232600       PERFORM Store-Field-Data                                   080820MA
232700       ADD FORM-NUMBER-OF-FIELDS(FRMIDX) TO TOTAL-FIELDS          ma080814
232800D      DISPLAY "ROWCNT: " ROWCNT                                  080831ma
232900       PERFORM VARYING IROW FROM 1 BY 1                           080831ma
233000         UNTIL ( IROW > ROWCNT )                                  080831ma
233100D       DISPLAY "OBJCNT(IROW): " OBJCNT(IROW)                     080831ma
233200        PERFORM VARYING XCOL FROM 1 BY 1                          080831ma
233300          UNTIL ( XCOL > OBJCNT(IROW) )                           080831ma
233400D        DISPLAY "NEXT NON DATA FIELD"                            080831ma
233500D        DISPLAY "IROW " IROW                                     080831ma
233600D        DISPLAY "XCOL " XCOL                                     080831ma
233700         If (OBJ-TYPE(IROW,XCOL) <> "DA")                         080831ma
233800          Initialize FFFLDS-BUFFER                                080831ma
233900          Move OBJ-NAME(Irow,Xcol)    To FFFLDS-VFLD-NAME         080831ma
234000          Move 0                      To FFFLDS-BUF-X             080831ma
234100          Move 0                      To FFFLDS-BUF-Y             080831ma
234200          Move OBJ-STRTCOL(Irow,Xcol) To FFFLDS-SRN-X             080831ma
234300          Move OBJ-STRTROW(Irow,Xcol) To FFFLDS-SRN-Y             080831ma
234400          Move OBJ-SRNORD(Irow,Xcol)  To FFFLDS-SRN-ORD-NUM       080831ma
234500          Move 0                      To FFFLDS-VFLD-NUM          080831ma
234600          Move OBJ-LEN(Irow,Xcol)     To FFFLDS-VFLD-LENGTH       080831ma
234700          Move 0                      To FFFLDS-VFLD-POSITION     080831ma
234800          Move OBJ-Enh(Irow,Xcol)     To FFFLDS-VFLD-ENHANCE      080831ma
234900          Move OBJ-TYPE(IROW,XCOL)    To FFFLDS-VFLD-TYPE         080831ma
235000          Move "CHAR"                 To FFFLDS-VFLD-DATATYPE     080831ma
235100          if OBJ-LEN(Irow,Xcol) > 80                              080831ma
235200           Move 80 To OBJ-LEN(Irow,Xcol)                          080831ma
235300          End-IF                                                  080831ma
235400          IF OBJ-LEN(Irow,Xcol) > 0                               080831ma
235500           Move OBJ-VALUE(Irow,Xcol)(1:OBJ-LEN(Irow,Xcol))        080831ma
235600                                      To FFFLDS-VFLD-INITVAL      080831ma
235700          END-IF                                                  080831ma
235900D         DISPLAY "ADDING NON DATA FIELD"                         080831ma
236000          perform add-field                                       080831ma
236100D         DISPLAY "BACK FGROM ADDING NON DATA FIELD"              080831ma
236200         End-If                                                   080831ma
236300        END-PERFORM                                               080831ma
236400       END-PERFORM                                                080831ma
236500      END-IF                                                      080831ma
236600     END-PERFORM.                                                 080831ma
236700D    DISPLAY "LEAVING VGETINFO".                                  081007ma
236800     ADD ACTUAL-FORM-COUNT TO TOTAL-FORMS.                        ma080814
236900     CALL "VCLOSEFORMF" USING SCREEN-COMAREA.                     ma080814
237000*---------------------------------------------------------        ma080814
237100*---------------------------------------------------------        ma080814
237200 9000-VPLUS-ERROR.                                                ma080814
237300D    DISPLAY "9000-VPLUS-ERROR" SCREEN-CSTATUS.                   ma080814
237400     INITIALIZE SCRIPT-STR CSTR CERR CPARM.                       ma080814
237500     MOVE 80 TO CPARM.                                            ma080814
237600     CALL "VERRMSG" USING SCREEN-COMAREA ERROR-MSG CPARM CERR.    ma080814
237700     INITIALIZE SCREEN-CSTATUS.                                   ma080814
237800     MOVE SCREEN-FORMS-FILE TO SCRIPT-STR.                        ma080814
237900     MOVE ERROR-MSG(1:CERR) TO SCRIPT-STR(30:80).                 ma080814
238000     MOVE CALLTYPE TO SCRIPT-STR(111:20).                         ma080814
238100     WRITE Script-File.                                           ma080814
238200     INITIALIZE CALLTYPE SCRIPT-STR CSTR CERR CPARM.              ma080814
238300*-------------------------------------------------------------    080820MA
238400 Store-File-Data.                                                 080820MA
238500D    Display "Store-File-Data".                                   080820MA
238600     Initialize ffmstr-buffer.                                    080830ma
238700     PERFORM Load-Form-Source                                     080830ma
238800     MOVE SCREEN-FORMS-FILE        TO FFMSTR-VFIL-NAME.           080830ma
238900     Compute FFMSTR-VFIL-BYTES =  frdcnt * 256.                   080830ma
239000     MOVE IN-FILE-VERSION(1)       TO FFMSTR-VERSION.             080830ma
239100     MOVE FILE-NUMBER-OF-FORMS(1)  TO FFMSTR-NBR-OF-FORMS.        080830ma
239200     MOVE FILE-MAX-FIELDS(1)       TO FFMSTR-MAX-FLDS.            080830ma
239300     MOVE FILE-MAX-BUFSIZE(1)      TO FFMSTR-MAX-BUF.             080830ma
239400     MOVE FILE-SAVE-FIELDS(1)      TO FFMSTR-SAVE-FLDS.           080830ma
239500     MOVE FILE-HEAD-FORM(1)        TO FFMSTR-HEAD-FRM.            080830ma
239600     MOVE FILE-ERROR-ENHANCE(1)    TO FFMSTR-ERR-ENH.             080830ma
239700     MOVE FILE-WINDOW-ENHANCE(1)   TO FFMSTR-WIN-ENH.             080830ma
239800     MOVE FILE-WINDOW-POSITION(1)  TO FFMSTR-WIN-POS.             080830ma
239900     ADD 1 TO MY-NEW-FILCNT.                                      080830ma
240000     If FILE-SAVE-FIELDS(1) > 0 PERFORM GET-D-RECORDS.            080830ma
240100     PERFORM GET-E-RECORDS.                                       080830ma
240200     PERFORM GET-G-RECORDS.                                       080830ma
240300D    Display "VERSION         : " IN-FILE-VERSION(1).             081007ma
240400D    Display "NUMBER-OF-FORMS : " FILE-NUMBER-OF-FORMS(1).        081007ma
240500D    Display "MAX-FIELDS      : " FILE-MAX-FIELDS(1).             081007ma
240600D    Display "MAX-BUFSIZE     : " FILE-MAX-BUFSIZE(1).            081007ma
240700D    Display "SAVE-FIELDS     : " FILE-SAVE-FIELDS(1).            081007ma
240800D    Display "HEAD-FORM       : " FILE-HEAD-FORM(1).              081007ma
240900D    Display "FILLER          : " FILE-FILLER(1).                 081007ma
241000D    Display "ERROR-ENHANCE   : " FILE-ERROR-ENHANCE(1).          081007ma
241100D    Display "WINDOW-ENHANCE  : " FILE-WINDOW-ENHANCE(1).         081007ma
241200D    Display "WINDOW-POSITION : " FILE-WINDOW-POSITION(1).        081007ma
241300D    display  "Compiled       : " MY-TIMESTAMP.                   081007ma
241400     Display FFMSTR-VFIL-NAME  "Compiled       : " MY-TIMESTAMP.  081007ma
241500*--------------------------------------------------------------   080820MA
241600 Store-Form-Data.                                                 080820MA
241700D    Display "Store-Form-Data".                                   080820MA
241800     Move FORM-FORM-NAME(FrmIdx)        To FMMSTR-FRM-NAME        080830ma
241900                                           SCREEN-NAME.           080830ma
242000     Move FORM-FORM-NUMBER(FrmIdx)      To FMMSTR-FRM-NUMBER.     080830ma
242100     Move FORM-NUMBER-OF-FIELDS(FrmIdx) To FMMSTR-FLDCNT.         080830ma
242200     Move FORM-BUF-LENGTH(FrmIdx)       To FMMSTR-BUF-LEN.        080830ma
242300     Move FORM-NEXT-FORM(FrmIdx)        To FMMSTR-NEXT-FRM.       080830ma
242400     Move FORM-REPEAT-OPTION(FrmIdx)    To FMMSTR-REPEAT-OPT.     080830ma
242500     Move FORM-NFORM-OPTION(FrmIdx)     To FMMSTR-NFORM-OPT.      080830ma
242600     Add 1 to My-New-FRMCNT.                                      080830ma
242700     MOVE 15 TO S1.                                               080830ma
242800     Perform varying S1 from 16 by -1                             080830ma
242900       until S1 < 2 or FMMSTR-FRM-NAME(S1:1) > " "                080830ma
243000      Continue                                                    080830ma
243100     End-Perform.                                                 080830ma
243200     Initialize Design-Area.                                      080830ma
243300     Move FMMSTR-FRM-NAME to Design-Name.                         080830ma
243400     Move "0" To E-Record-Found-Sw.                               080830ma
243500     Perform Varying eidx From 1 By 1                             080830ma
243600       Until ( eidx > ecnt )                                      080830ma
243700*     DISPLAY                                                     080831ma
243800*      "[ " E-FORM1(eidx)(1:S1) "]=[" FMMSTR-FRM-NAME(1:S1) "]"   080831ma
243900*     DISPLAY                                                     080831ma
244000*      "[" E-REPEAT-OPTION(eidx) "]=[" FMMSTR-REPEAT-OPT "]"      080831ma
244100*     DISPLAY                                                     080831ma
244200*      "[" E-NFORM-OPTION(eidx) "]=[" FMMSTR-NFORM-OPT "]"        080831ma
244300*     DISPLAY                                                     080831ma
244400*      "[" E-NFORM(eidx) "]=[" FMMSTR-NEXT-FRM "]"                080831ma
244500      If   ((E-FORM1(eidx)(1:S1)   = FMMSTR-FRM-NAME(1:S1))       080830ma
244600        And (E-REPEAT-OPTION(eidx) = FMMSTR-REPEAT-OPT)           080830ma
244700        And (E-NFORM-OPTION(eidx)  = FMMSTR-NFORM-OPT)            080830ma
244800        And (E-NFORM(eidx)         = FMMSTR-NEXT-FRM))            080830ma
244900       Move E-FKEY-DEF(eidx)       To FMMSTR-FKEY-DEF             080830ma
245000       Move E-REPRODUCED-FR(eidx)  To FMMSTR-REPRODUCED-FR        080830ma
245100       Move E-COMMENTS(eidx)       To FMMSTR-COMMENT              080830ma
245200       Move "1" To E-Record-Found-Sw                              080830ma
245300      End-If                                                      080830ma
245400     End-Perform.                                                 080830ma
245500     If E-Record-Found                                            080830ma
245600      Perform Link-VF-Pointers                                    080830ma
245700      IF POINTERS-LINKED                                          080830ma
245800D      DISPLAY "VF LINKED ok"                                     080831ma
245900*      ACCEPT NUM1                                                081007ma
246000       PERFORM GET-T-RECORDS                                      080830ma
246100       PERFORM GET-SCREEN-OBJECTS                                 080830ma
246200      ELSE                                                        080830ma
246300       Display "Unable to find form design records!  "            080830ma
246400               "V= " V-DESIGN-LEN ", F= " F-DESIGN-LEN            080830ma
246500               "Form: " Design-name                               080830ma
246600      End-if                                                      080830ma
246700     Else                                                         080830ma
246800      Display "NO E-Record for Form: " Design-name.               080830ma
246900                                                                  080830ma
247000                                                                  080830ma
247100*---------------------------------------------------------------- 080820MA
247200 Store-Field-Data.                                                080820MA
247300D    Display "Store-Field-Data".                                  080820MA
247400     INITIALIZE FFFLDS-BUFFER FLDIDX THISFORM-FLDCNT.             080831ma
247500D    DISPLAY REPORT-HEADER                                        080902ma
247600     PERFORM LOAD-G-SCREEN.                                       080831ma
247700     Perform Varying Fx From 1 By 1 Until Fx > FMMSTR-FLDCNT      080830ma
247800      Move FIELD-FIELD-NAME(Fx)     To FFFLDS-VFLD-NAME           080830ma
247900      Move FIELD-SCREEN-ORD-NUM(Fx) To FFFLDS-SRN-ORD-NUM         080830ma
248000      Move FIELD-NUM(Fx)            To FFFLDS-VFLD-NUM            080830ma
248100      Move FIELD-LENGTH(Fx)         To FFFLDS-VFLD-LENGTH         080830ma
248200      Move FIELD-POSITION(Fx)       To FFFLDS-VFLD-POSITION       080830ma
248300      Move FIELD-ENHANCE(Fx)        To FFFLDS-VFLD-ENHANCE        080830ma
248400      INITIALIZE IROW XCOL                                        080830ma
248500      PERFORM VARYING IROW FROM 1 BY 1                            080830ma
248600        UNTIL ( IROW > ROWCNT )                                   080830ma
248700       PERFORM VARYING XCOL FROM 1 BY 1                           080830ma
248800         UNTIL ( XCOL > OBJCNT(IROW) )                            080830ma
248900        If (OBJ-TYPE(IROW,XCOL) = "DA") And                       080830ma
249000        (OBJ-SRNORD(Irow,Xcol) = FFFLDS-SRN-ORD-NUM)              080830ma
249100         PERFORM GET-FIELD-DATA                                   080830ma
249200        End-If                                                    080830ma
249300       END-PERFORM                                                080830ma
249400      END-PERFORM                                                 080830ma
249500     End-Perform.                                                 080820MA
249600*-----------------------------------------------------------      080825MA
249700 Extract-Labels.                                                  080825MA
249800d    Display "Extract-Labels".                                    080825MA
249900     Initialize btnrow-data.                                      080825MA
250000     Perform varying brwidx from 1 by 1                           080825MA
250100       Until brwcnt >= 8 or brwidx > 256                          080825MA
250200      If  Next-String(brwidx:1) = %33                             080828MA
250300       Add 1 to Brwidx                                            080825MA
250400       If Next-String(brwidx:1) = "&"                             080825MA
250500        Add 1 to Brwidx                                           080825MA
250600        If Next-String(brwidx:1) = "d"                            080825MA
250700         Add 1 to Brwidx                                          080825MA
250800         If Next-String(brwidx:1) = "J" or "B"                    080825MA
250900          Compute nxkey-x = brwidx + 1 End-Compute                080825MA
251000          Move Next-String(nxkey-x:16) to NxLbl                   080825MA
251100          Initialize nxchr-cnt Next-Label                         080825MA
251200          Perform Varying nxkey-y from 1 by 1                     080825MA
251300            until nxkey-y > 30 or nxchr-cnt >= 8                  080828MA
251400           if (NxLbl(nxkey-y:1) = %33 And                         080825MA
251500               NxLbl(nxkey-y + 1:1) = "[")                        080825MA
251600           or (NxLbl(nxkey-y:1) = %33 And                         080825MA
251700               NxLbl(nxkey-y + 1:1) = "]")                        080825MA
251800            Display "Painted FK Lbls are supported; "             080825MA
251900                    "Data fields imbedded into them is not!"      080825MA
252000            Add 2 to nxkey-y                                      080825MA
252100            If (NxLbl(nxkey-y:1) = %33 And                        080825MA
252200                NxLbl(nxkey-y + 1:1) = "&" And                    080825MA
252300                NxLbl(nxkey-y + 2:1) = "d")                       080825MA
252400            Display "Painted FK Lbls are supported; "             080828MA
252500                    "Esc Seq's imbedded into them is not!"        080828MA
252600             Add 4 TO nxkey-y                                     080825MA
252700            End-If                                                080825MA
252800           Else                                                   080825MA
252900            Add 1 To nxchr-cnt                                    080825MA
253000            Move NxLbl(nxkey-y:1) To Next-Label(nxchr-cnt:1)      080825MA
253100           End-If                                                 080825MA
253200          End-Perform                                             080825MA
253300          Add 1 to brwcnt                                         080825MA
253400          Move Next-Label To btn(brwcnt)                          080825MA
253500D         Display "                    [" btn(brwcnt) " ]"        080902ma
253600         End-If                                                   080825MA
253700        End-If                                                    080825MA
253800       End-If                                                     080825MA
253900      End-If                                                      080825MA
254000     End-Perform.                                                 080825MA
254100*---------------------------------------------------------------  080828MA
254200 Add-ProcSpecs.                                                   080828MA
254300D    Display "Add-ProcSpecs".                                     080828MA
254400     Initialize chrcnt chridx PRSPEC-BUFFER.                      080828MA
254500     Move "0" To end-of-specs-sw.                                 080828MA
254600     Perform Varying chridx from 1 by 1                           080831ma
254700      Until end-of-specs OR CHRIDX > SPECLEN                      080831ma
254800       If (GFF-PROCSPECS(chridx:1) = %15 or                       080830ma
254900           GFF-PROCSPECS(chridx:1) = %12 or                       080830ma
255000           CHRCNT > 79)  and  chrcnt > 0                          080828MA
255100        Add 1 To PRSPEC-PRSPEC-SEQ                                080828MA
255200        If PRSPEC-PRSPEC-TEXT(1:chrcnt) > Spaces                  080828MA
255300D        display PRSPEC-PRSPEC-SEQ " "                            080902ma
255400D                PRSPEC-PRSPEC-TEXT(1:chrcnt)                     080902ma
255500         Add 1 to MY-NEW-spcCNT                                   080828MA
255600        End-If                                                    080828MA
255700        Initialize chrcnt PRSPEC-PRSPEC-TEXT                      080828MA
255800       End-If                                                     080828MA
255900       IF GFF-PROCSPECS(chridx:1) >= space                        080830ma
256000        Add 1 To chrcnt                                           080828MA
256100        Move GFF-PROCSPECS(chridx:1)                              080830ma
256200          to PRSPEC-PRSPEC-TEXT(chrcnt:1)                         080828MA
256300       End-If                                                     080828MA
256400       If chridx >= speclen                                       080828MA
256500        Move "1" To end-of-specs-sw                               080828MA
256600        If  chrcnt > 0                                            080828MA
256700         Add 1 To PRSPEC-PRSPEC-SEQ                               080828MA
256800         If PRSPEC-PRSPEC-TEXT(1:chrcnt) > Spaces                 080828MA
256900D         display PRSPEC-PRSPEC-SEQ " "                           080902ma
257000D                 PRSPEC-PRSPEC-TEXT(1:chrcnt)                    080902ma
257100          Add 1 to MY-NEW-spcCNT                                  080828MA
257200         End-If                                                   080828MA
257300         Initialize chrcnt PRSPEC-PRSPEC-TEXT                     080828MA
257400        End-IF                                                    080828MA
257500       End-if                                                     080828MA
257600     End-Perform.                                                 080828MA
257700*                                                                 080828MA
257800*---------------------------------------------------------------- 080828MA
257900 add-field.                                                       080828MA
258000D    DISPLAY "ADD-FIELD".                                         080831ma
258010     Add 1 To My-New-fldcnt.                                      080831ma
258110     Initialize REPORT-BUFFER.                                    080828MA
258120                                                                  080902ma
258200     MOVE  FFFLDS-VFLD-NAME         TO RPT-VFLD-NAME.             080828MA
258300     MOVE  FFFLDS-BUF-X             TO RPT-BUF-X.                 080828MA
258400     MOVE  FFFLDS-BUF-Y             TO RPT-BUF-Y.                 080828MA
258500     MOVE  FFFLDS-SRN-X             TO RPT-SRN-X.                 080828MA
258600     MOVE  FFFLDS-SRN-Y             TO RPT-SRN-Y.                 080828MA
258700     MOVE  FFFLDS-SRN-ORD-NUM       TO RPT-SRN-ORD-NUM.           080828MA
258800     MOVE  FFFLDS-VFLD-NUM          TO RPT-VFLD-NUM.              080828MA
258900     MOVE  FFFLDS-VFLD-LENGTH       TO RPT-VFLD-LENGTH.           080828MA
259000     MOVE  FFFLDS-VFLD-POSITION     TO RPT-VFLD-POSITION.         080828MA
259100     MOVE  FFFLDS-VFLD-ENHANCE      TO RPT-VFLD-ENHANCE.          080828MA
259200     Move  FFFLDS-VFLD-TYPE         TO RPT-VFLD-TYPE.             080828MA
259300     Move  FFFLDS-VFLD-DATATYPE     TO RPT-VFLD-DATATYPE.         080828MA
259310D    DISPLAY FFMSTR-VFIL-NAME FMMSTR-FRM-NAME RPT-VFLD-NAME %15   081007ma
259400D      WITH NO ADVANCING.                                         081007ma
259500D    If FFFLDS-VFLD-LENGTH > 0 and                                080902ma
259600D       FFFLDS-VFLD-LENGTH < 81                                   080902ma
259700D    display "init: ["                                            080902ma
259800D     FFFLDS-VFLD-INITVAL(1:FFFLDS-VFLD-LENGTH) "]".              080902ma
259900*-----------------------------------------------------------------080831ma
260000 LOAD-G-SCREEN.                                                   080831ma
260100D     DISPLAY "LOAD-G-SCREEN".                                    080831ma
260200D     Display "FMMSTR-FRM-NAME [" FMMSTR-FRM-NAME "]"             080831ma
260300     IF NOT GFILE-CLOSED PERFORM CLOSE-GFILE.                     080831ma
260400     PERFORM OPEN-GFILE-INPUT.                                    080831ma
260500     MOVE "0" TO VALID-G-SW.                                      080831ma
260600     INITIALIZE G-SCREEN-ARRAY GSIDX GSCNT.                       080831ma
260700D     DISPLAY "GFILE COUNT: " GFILE-COUNT.                        080831ma
260800     Perform Varying GSIDX From 1 By 1                            080831ma
260900       Until ( GSIDX > GFILE-COUNT )                              080831ma
261000          OR ( GSCNT > 259 )                                      080831ma
261020      PERFORM READ-GFILE                                          080831ma
261100      IF NOT GFILE-EOF                                            080831ma
261200       MOVE G-FIELD TO G-FIELD-FORMAT                             080831ma
261300       Move G-HEADER to G-HEADER-FORMAT                           080831ma
261400       If (GFF-FORM = FMMSTR-FRM-NAME)                            080831ma
261500        ADD 1 TO GSCNT                                            080831ma
261600        MOVE G-FIELD TO GS-FIELD(GSCNT)                           080831ma
261610D        DISPLAY GFF-FORM GFF-FIELD GFF-NUM                       080831ma
261730        MOVE G-HEADER TO GS-HEADER(GSCNT)                         080831ma
261800       End-If                                                     080831ma
261900      End-If                                                      080831ma
262000     End-Perform.                                                 080831ma
262100D     DISPLAY "LOADED G-SCREEN REC: " GSCNT.                      080831ma
