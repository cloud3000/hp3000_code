000100$CONTROL POST85, BOUNDS, LINES=59, LIST, MAP, CROSSREF                    
000200******************************************************************        
000300*   COPYRIGHT 2007 - 2009 J3K Solutions All rights reserved.              
000400*                                                                         
000500*                ****************************                             
000600*                  FORMSPEC export utility                                
000700*                ****************************                             
000800*                                                                         
000900*  This program will add the following VPLUS data to MIGDB.               
001000*                                                                         
001100*  Data Fields and all their properties.                                  
001200*  Processing Specs for each field.                                       
001300*  Screen enhancements.                                                   
001400*  Line Drawing characters.                                               
001500*  Descriptive Text on the screen, and text properties.                   
001600*  The Function Keys that were painted as text on the screen              
001700*  design (row 1 and 2) using screen escape sequences.                    
001800*  The Function Key Labels (f1 thru f8) as entered in the                 
001900*  FKEY screen in formspec.                                               
002000*                                                                         
002100*   http://www.j3ksolutions.com                                           
002200*   mailto:support@j3ksolutions.com                                       
002300******************************************************************        
002400 IDENTIFICATION DIVISION.                                                 
002500 PROGRAM-ID.     MIG801.                                                  
002600 AUTHOR.     MICHAEL ANDERSON.                                            
002700 ENVIRONMENT DIVISION.                                                    
002800 CONFIGURATION SECTION.                                                   
002900 SOURCE-COMPUTER. HP-3000.                                                
003000* SOURCE-COMPUTER. HP-3000 WITH DEBUGGING MODE.                           
003100 OBJECT-COMPUTER. HP-3000.                                                
003200*                                                                         
003300 INPUT-OUTPUT SECTION.                                                    
003400 FILE-CONTROL.                                                            
003500*                                                                         
003600     SELECT PRINT-FILE      ASSIGN TO "DMG014,,,LP(SDTL)".                
003700     SELECT SORTFILE        ASSIGN TO "DMG01SRT,,,,9000000".              
003800     SELECT EXTFILE1        ASSIGN TO "DMG01A1,,,,9000000".               
003900     SELECT EXTFILE2        ASSIGN TO "DMG01A2,,,,9000000".               
004000     SELECT DMG01A3-FILE    ASSIGN TO "VPLUSRR,,,,9000000".               
004100     SELECT DMGXML-FILE     ASSIGN TO "DMGXML,,,,9000000"                 
004200            FILE STATUS IS XML-STATUS.                                    
004300     SELECT FORMA-FILE      ASSIGN TO "FORM,,,DISC"                       
004400            FILE STATUS IS FORMFILE-STATUS.                               
004500     SELECT G-FILE      ASSIGN TO "GFILE,,,DISC"                          
004600            FILE STATUS IS GFILE-STATUS.                                  
004700*                                                                         
004800 DATA DIVISION.                                                           
004900 FILE SECTION.                                                            
005000                                                                          
005100                                                                          
005200 FD  PRINT-FILE                                                           
005300     RECORD CONTAINS 132 CHARACTERS                                       
005400     BLOCK CONTAINS 1 RECORDS                                             
005500     LABEL RECORDS ARE OMITTED.                                           
005600 01  PRINT-LINE.                                                          
005700     02  CLEAR-OUT                   PIC X(132).                          
005800                                                                          
005900 FD  EXTFILE2 DATA RECORD IS EXT-REC                                      
006000     RECORD CONTAINS 62 CHARACTERS.                                       
006100 01  EXT-REC2.                                                            
006200     05  FILLER                PIC X(62).                                 
006300                                                                          
006400 FD  EXTFILE1 DATA RECORD IS EXT-REC                                      
006500     RECORD CONTAINS 62 CHARACTERS.                                       
006600 01  EXT-REC.                                                             
006700     05  FILLER                PIC X(62).                                 
006800                                                                          
006900 SD  SORTFILE DATA RECORD IS SORT-REC                                     
007000          RECORD CONTAINS 62 CHARACTERS.                                  
007100 01  SORT-REC.                                                            
007200     02 SORT-KEY PIC X(62).                                               
007300 FD  DMG01A3-FILE                                                         
007400     RECORD CONTAINS 256 CHARACTERS                                       
007500     DATA RECORD IS Script-File.                                          
007600 01  Script-File.                                                         
007700     05  Script-Str                     PIC X(256).                       
007800                                                                          
007900 FD  DMGXML-FILE                                                          
008000     RECORD CONTAINS 256 CHARACTERS                                       
008100     DATA RECORD IS XML-File.                                             
008200 01  XML-File.                                                            
008300     05  XML-Str                     PIC X(256).                          
008400 FD  FORMA-FILE                                                           
008500     RECORD CONTAINS 256 CHARACTERS                                       
008600     DATA RECORD IS Form-File.                                            
008700 01  Form-File.                                                           
008800     05  Form-Rec                     PIC X(256).                         
008900*                                                                         
009000 FD  G-File                                                               
009100     RECORD CONTAINS 1540 CHARACTERS                                      
009200     DATA RECORD is G-REC.                                                
009300 01  G-REC                            PIC X(1540).                        
009400                                                                          
009500$PAGE "WORKING STORAGE"                                                   
009600 WORKING-STORAGE SECTION.                                                 
009700*****************************************************************         
009800 01  FILE-ERROR-DATA.                                                     
009900     05 ERROR-NUMBER           PIC XX    VALUE SPACES.                    
010000     05 FNAME                  PIC X(8)  VALUE SPACES.                    
010100     05 FILE-ERROR-RECORD      PIC X(79) VALUE SPACES.                    
010200*                                                                         
010300  01  XML-STATUS               PIC XX    VALUE SPACES.                    
010400*                                                                         
010500*                                                                         
010600 01  GFILE-STATUS              PIC XX    VALUE SPACES.                    
010700 01  GFILE-COUNT               PIC S9(9) COMP VALUE 0.                    
010800 01  GFILE-RCOUNT              PIC S9(9) COMP VALUE 0.                    
010900 01  GFILE-FLAG                PIC XX    VALUE SPACES.                    
011000     88 GFILE-CLOSED           VALUE SPACES.                              
011100     88 GFILE-OPENED-INPUT     VALUE "01".                                
011200     88 GFILE-OPENED-OUTPUT    VALUE "02".                                
011300     88 GFILE-EOF              VALUE "99".                                
011400D 01 CLEARSCREEN.                                                         
011500D    05 FILLER PIC X VALUE %33.                                           
011600D    05 FILLER PIC X VALUE "E".                                           
011700                                                                          
011800 01  FORMFILE-STATUS           PIC XX    VALUE SPACES.                    
011900 01  FORMFILE-COUNT            PIC S9(9) COMP VALUE 0.                    
012000 01  FORMFILE-FLAG             PIC XX    VALUE SPACES.                    
012100     88 FORMFILE-CLOSED        VALUE SPACES.                              
012200     88 FORMFILE-OPENED-INPUT  VALUE "01".                                
012300     88 FORMFILE-OPENED-OUTPUT VALUE "02".                                
012400     88 FORMFILE-EOF           VALUE "99".                                
012500  01 NEXIDX                    PIC S9(4) COMP VALUE 0.                    
012600  01 I                         PIC S9(4) COMP VALUE 0.                    
012700  01 X                         PIC S9(4) COMP VALUE 0.                    
012800  01 FX                        PIC S9(4) COMP VALUE 0.                    
012900  01 Esc-len                   PIC S9(4) COMP VALUE 0.                    
013000  01 ld-IDX                    PIC S9(4) COMP VALUE 0.                    
013100  01 ld-len                    PIC S9(4) COMP VALUE 0.                    
013200 01  Ascii-Value               PIC S9(4) COMP VALUE 0.                    
013300 01  ASCII-CHARACTER       REDEFINES Ascii-Value.                         
013400     02 ASCII-BYTE1            PIC X.                                     
013500     02 ASCII-BYTE2            PIC X.                                     
013600                                                                          
013700 01  HPVAR-NAME               PIC X(20) VALUE "ITOSQLS_STATUS~  ".        
013800 01  HPVAR-ITEM                PIC S9(9) COMP VALUE -1.                   
013900 01  HPVAR-ITEMNUM             PIC S9(9) COMP VALUE 1.                    
014000 01  HPVAR-STAT                PIC S9(9) COMP VALUE 0.                    
014100 01 FORMS-DATA.                                                           
014200    05 FRDIDX                  PIC S9(9) COMP VALUE 0.                    
014300    05 FRDPTR                  PIC S9(9) COMP VALUE 0.                    
014400    05 PRCPTR                  PIC S9(9) COMP VALUE 0.                    
014500    05 FRDCNT                  PIC S9(9) COMP VALUE 0.                    
014600    05 PRCCNT                  PIC S9(9) COMP VALUE 0.                    
014700    05 FRD-TABLE.                                                         
014800       10 FRD-ENTRIES OCCURS 32767  TIMES.                                
014900          20 FRDSTR            PIC X(256).                                
015000  01 S1                        PIC S9(9) COMP VALUE 0.                    
015100  01 S2                        PIC S9(9) COMP VALUE 0.                    
015200*                                                                         
015300 01 SAVE-FLD-TABLE.                                                       
015400    05 SF-BUFLEN               PIC S9(4) COMP.                            
015500    05 SFIDX                   PIC S9(4) COMP.                            
015600    05 SFCNT                   PIC S9(4) COMP.                            
015700    05 SFT-ENTRIES OCCURS 64.                                             
015800       10 SF-FLD               PIC X(16).                                 
015900       10 SF-LEN               PIC 9(4).                                  
016000       10 SF-TYPE              PIC X(4).                                  
016100       10 SF-INIT              PIC X(80).                                 
016200*                                                                         
016300*                                                                         
016400  01 FFFLDS-DEL-CNT            PIC S9(9) COMP.                            
016500  01 FFFLDS-REC-CNT            PIC S9(9) COMP.                            
016600**                                                                        
016700  01 FFMSTR-DEL-CNT            PIC S9(9) COMP.                            
016800  01 FFMSTR-REC-CNT            PIC S9(9) COMP.                            
016900**                                                                        
017000  01 FMMSTR-DEL-CNT            PIC S9(9) COMP.                            
017100  01 FMMSTR-REC-CNT            PIC S9(9) COMP.                            
017200**                                                                        
017300  01 PRSPEC-DEL-CNT            PIC S9(9) COMP.                            
017400  01 PRSPEC-REC-CNT            PIC S9(9) COMP.                            
017500**                                                                        
017600*                                                                         
017700 01 FORMSFILE-SW               PIC X VALUE "0".                           
017800    88 END-OF-FORMSFILE        VALUE "1".                                 
017900 01 END-OF-SPECS-SW            PIC X VALUE "0".                           
018000    88 END-OF-SPECS            VALUE "1".                                 
018100                                                                          
018200 01 T-RECORD.                                                             
018300    02 TIDX                    PIC S9(4) COMP VALUE 0.                    
018400    02 T-LEN                   PIC S9(9) COMP VALUE 0.                    
018500    02 T-STRT                  PIC S9(9) COMP VALUE 0.                    
018600    02 T-END                   PIC S9(9) COMP VALUE 0.                    
018700    02 T-ACTUAL-RECORD.                                                   
018800       05 T-HEADER                PIC X(40).                              
018900       05 T-FLD-ENTRIES OCCURS 256 TIMES.                                 
019000          10 T-FIELD              PIC X(62).                              
019100                                                                          
019200 01 T-HEADER-FORMAT.                                                      
019300    05 THF-LENGTH              PIC S9(4) COMP.                            
019400    05 THF-TYPE                PIC X.                                     
019500    05 THF-FORM                PIC X(15).                                 
019600    05 THF-CNT1                PIC S9(4) COMP.                            
019700    05 THF-CNT2                PIC S9(4) COMP.                            
019800    05 FILLER                  PIC X(18).                                 
019900                                                                          
020000 01 T-FIELD-FORMAT.                                                       
020100    05 TFF-FLD1                PIC X(15).                                 
020200    05 TFF-FLD2                PIC X(15).                                 
020300    05 TFF-ENH                 PIC X(4).                                  
020400    05 TFF-ESCVAL              PIC X.                                     
020500    05 TFF-A                   PIC X.                                     
020600    05 TFF-FLDNUM              PIC S9(4) COMP.                            
020700    05 TFF-SCRNODR             PIC S9(4) COMP.                            
020800    05 FILLER                  PIC S9(4) COMP.                            
020900    05 FILLER                  PIC S9(4) COMP.                            
021000    05 TFF-LEN                 PIC S9(4) COMP.                            
021100    05 TFF-ROW                 PIC S9(4) COMP.                            
021200    05 TFF-COL                 PIC S9(4) COMP.                            
021300*                                                                         
021400 01 D-RECORD.                                                             
021500    02 DIDX                    PIC S9(4) COMP VALUE 0.                    
021600    02 D-LEN                   PIC S9(9) COMP VALUE 0.                    
021700    02 D-STRT                  PIC S9(9) COMP VALUE 0.                    
021800    02 D-END                   PIC S9(9) COMP VALUE 0.                    
021900    02 D-RECORD-ENTRIES OCCURS 256 TIMES.                                 
022000       05 D-HEADER             PIC X(3).                                  
022100       05 D-FIELD              PIC X(99).                                 
022200                                                                          
022300 01 D-HEADER-FORMAT.                                                      
022400    05 DHF-LENGTH              PIC S9(4) COMP.                            
022500    05 DHF-TYPE                PIC X.                                     
022600                                                                          
022700 01 D-FIELD-FORMAT.                                                       
022800    05 DFF-FLD1                PIC X(15).                                 
022900    05 DFF-FLD2                PIC X(15).                                 
023000    05 DFF-LEN                 PIC XXX.                                   
023100    05 DFF-DTYPE               PIC XXXX.                                  
023200    05 DFF-INIT                PIC X(62).                                 
023300*                                                                         
023400 01 E-RECORD.                                                             
023500    02 EIDX                    PIC S9(4) COMP VALUE 0.                    
023600    02 ECNT                    PIC S9(4) COMP VALUE 0.                    
023700    02 E-LEN                   PIC S9(9) COMP VALUE 0.                    
023800    02 E-STRT                  PIC S9(9) COMP VALUE 0.                    
023900    02 E-END                   PIC S9(9) COMP VALUE 0.                    
024000    02 E-RECORD-ENTRIES OCCURS 2048 TIMES.                                
024100       05 E-HEADER PIC X(3).                                              
024200       05 E-DATA.                                                         
024300          10 E-FORM1           PIC X(15).                                 
024400          10 E-FORM2           PIC X(15).                                 
024500          10 E-REPEAT-OPTION   PIC X.                                     
024600          10 E-NFORM-OPTION    PIC X.                                     
024700          10 E-NFORM           PIC X(15).                                 
024800          10 E-FKEY-DEF        PIC X.                                     
024900          10 E-REPRODUCED-FR   PIC X(15).                                 
025000          10 E-COMMENTS        PIC X(50).                                 
025100          10 E-FTYPE           PIC X(1).                                  
025200          10 E-DTYPE           PIC X(4).                                  
025300*                                                                         
025400 01 GSIDX                      PIC S9(4) COMP VALUE 0.                    
025500 01 GSCNT                      PIC S9(4) COMP VALUE 0.                    
025600 01 G-SCREEN-DATA.                                                        
025700    02 G-SCREEN-ARRAY.                                                    
025800       05 G-SCREEN-ENTRIES OCCURS 260 TIMES.                              
025900          10 GS-HEADER         PIC XXX.                                   
026000          10 GS-FIELD          PIC X(1537).                               
026100 01 G-DATA-STORAGE.                                                       
026200    02 GIDX                    PIC S9(4) COMP VALUE 0.                    
026300    02 GCNT                    PIC S9(4) COMP VALUE 0.                    
026400    02 G-LEN                   PIC S9(9) COMP VALUE 0.                    
026500    02 G-STRT                  PIC S9(9) COMP VALUE 0.                    
026600    02 G-END                   PIC S9(9) COMP VALUE 0.                    
026700    02 G-RECORD.                                                          
026800       05 G-HEADER             PIC X(3).                                  
026900       05 G-FIELD              PIC X(1536).                               
027000*                                                                         
027100 01 G-HEADER-FORMAT.                                                      
027200    05 GHF-LENGTH              PIC S9(4) COMP.                            
027300    05 GHF-TYPE                PIC X.                                     
027400                                                                          
027500 01 G-FIELD-FORMAT.                                                       
027600    05 GFF-FORM                PIC X(15).                                 
027700    05 GFF-FIELD               PIC X(15).                                 
027800    05 GFF-NUM                 PIC X(4).                                  
027900    05 GFF-LEN                 PIC X(4).                                  
028000    05 GFF-FIELD2              PIC X(15).                                 
028100    05 GFF-ENH                 PIC X(4).                                  
028200    05 GFF-FTYPE               PIC X.                                     
028300    05 GFF-DTYPE               PIC X(4).                                  
028400    05 GFF-INIT                PIC X(65).                                 
028500    05 GFF-PROCSPECS           PIC X(1300).                               
028600                                                                          
028700 01 HP-Enhancements.                                                      
028800    02 FILLER                  PIC X value "@".                           
028900    02 FILLER                  PIC X value "A".                           
029000    02 FILLER                  PIC X value "B".                           
029100    02 FILLER                  PIC X value "C".                           
029200    02 FILLER                  PIC X value "D".                           
029300    02 FILLER                  PIC X value "E".                           
029400    02 FILLER                  PIC X value "F".                           
029500    02 FILLER                  PIC X value "G".                           
029600    02 FILLER                  PIC X value "H".                           
029700    02 FILLER                  PIC X value "I".                           
029800    02 FILLER                  PIC X value "J".                           
029900    02 FILLER                  PIC X value "K".                           
030000    02 FILLER                  PIC X value "L".                           
030100    02 FILLER                  PIC X value "M".                           
030200    02 FILLER                  PIC X value "N".                           
030300    02 FILLER                  PIC X value "O".                           
030400    02 FILLER                  PIC X value "S".                           
030500    02 FILLER                  PIC X VALUE "Z".                           
030600 01 HPENH-TABLE REDEFINES HP-Enhancements.                                
030700    02 HPENH-ENTRIES OCCURS 18 TIMES.                                     
030800       05 HPENH                PIC X.                                     
030900*                                                                         
031000  01 ENHIDX                    PIC S9(4) COMP VALUE 0.                    
031100*                                                                         
031200 01 VPLUS-Enhancements.                                                   
031300    02 FILLER                  PIC X(4) VALUE "NONE".                     
031400    02 FILLER                  PIC X(4) VALUE "B   ".                     
031500    02 FILLER                  PIC X(4) VALUE "I   ".                     
031600    02 FILLER                  PIC X(4) VALUE "BI  ".                     
031700    02 FILLER                  PIC X(4) VALUE "U   ".                     
031800    02 FILLER                  PIC X(4) VALUE "BU  ".                     
031900    02 FILLER                  PIC X(4) VALUE "IU  ".                     
032000    02 FILLER                  PIC X(4) VALUE "BIU ".                     
032100    02 FILLER                  PIC X(4) VALUE "H   ".                     
032200    02 FILLER                  PIC X(4) VALUE "BH  ".                     
032300    02 FILLER                  PIC X(4) VALUE "IH  ".                     
032400    02 FILLER                  PIC X(4) VALUE "BIH ".                     
032500    02 FILLER                  PIC X(4) VALUE "UH  ".                     
032600    02 FILLER                  PIC X(4) VALUE "BUH ".                     
032700    02 FILLER                  PIC X(4) VALUE "IUH ".                     
032800    02 FILLER                  PIC X(4) VALUE "BIUH".                     
032900    02 FILLER                  PIC X(4) VALUE "S   ".                     
033000    02 FILLER                  PIC X(4) VALUE "ERR ".                     
033100 01 VPLUSENH-TABLE REDEFINES VPLUS-Enhancements.                          
033200    02 VPLUSENH-ENTRIES OCCURS 18 TIMEs.                                  
033300       05 VPLUSENH             PIC X(4).                                  
033400*                                                                         
033500 01 ALL-ROWS.                                                             
033600    02 FORM-SCRNORD            PIC S9(4) COMP.                            
033700    02 ODFLEN                  PIC S9(4) COMP.                            
033800    02 ODF                     PIC S9(4) COMP.                            
033900    02 ROWIDX                  PIC S9(4) COMP VALUE 0.                    
034000    02 ROWCNT                  PIC S9(4) COMP VALUE 0.                    
034100    02 ROWMAX                  PIC S9(4) COMP VALUE 26.                   
034200    02 ROWSTART                PIC S9(4) COMP VALUE 1.                    
034300    02 ROWEND                  PIC S9(4) COMP VALUE 0.                    
034400    02 ROWLEN                  PIC S9(4) COMP VALUE 0.                    
034500    02 ROW-COLUMN              PIC S9(4) COMP VALUE 0.                    
034600    02 ROW-ENTRIES OCCURS 40 TIMES.                                       
034700       05 ROWSTR               PIC X(256).                                
034800       05 OBJIDX               PIC S9(4) COMP.                            
034900       05 OBJCNT               PIC S9(4) COMP.                            
035000       05 ROW-OBJECTS OCCURS 80.                                          
035100          10 OBJ-TYPE          PIC XX.                                    
035200          10 OBJ-fTYPE         PIC X.                                     
035300          10 OBJ-dTYPE         PIC XxxX.                                  
035400          10 OBJ-Enh           PIC X.                                     
035500          10 OBJ-NAME          PIC X(16).                                 
035600          10 OBJ-SRNORD        PIC S9(4) COMP.                            
035700          10 OBJ-STRTCOL       PIC S9(4) COMP.                            
035800          10 OBJ-STRTROW       PIC S9(4) COMP.                            
035900          10 OBJ-ENDCOL        PIC S9(4) COMP.                            
036000          10 OBJ-ENDROW        PIC S9(4) COMP.                            
036100          10 OBJ-VALUE         PIC X(80).                                 
036200          10 OBJ-FLDNUM        PIC S9(4) COMP.                            
036300          10 OBJ-LEN           PIC S9(4) COMP.                            
036400*                                                                         
036500*                                                                         
036600 01 NEW-TEXT-AREA.                                                        
036700    05 END-ROW-SW     PIC X VALUE "0".                                    
036800       88 END-OF-ROW  VALUE "1".                                          
036900    05 TEXT-COLUMN             PIC S9(4) COMP VALUE 0.                    
037000    05 TEXT-ROW                PIC S9(4) COMP VALUE 0.                    
037100    05 TXIDX                   PIC S9(4) COMP VALUE 0.                    
037200    05 TEXT-CHAR               PIC S9(4) COMP VALUE 0.                    
037300    05 TEXT-FIELDS.                                                       
037400       10 TXPTR-START          PIC S9(4) COMP VALUE 0.                    
037500       10 TXPTR                PIC S9(4) COMP VALUE 0.                    
037600       10 TEXT-ENH             PIC X  VALUE "@".                          
037700       10 NON-TEXT-SW          PIC X  VALUE "0".                          
037800          88 IN-TEXT-AREA      VALUE "0".                                 
037900          88 IN-NON-TEXT       VALUE "1".                                 
038000       10 NEW-TEXT-FOUND-SW    PIC X  VALUE "0".                          
038100          88 NEW-TEXT-FOUND    VALUE "1".                                 
038200       10 TEXT-FLDCNT          PIC S9(4) COMP VALUE 0.                    
038300       10 TEXT-FIELD-ENTRIES OCCURS 40 TIMES.                             
038400          20 TEXT-FLDCOL       PIC S9(4) COMP.                            
038500          20 TEXT-FLDROW       PIC S9(4) COMP.                            
038600          20 TEXT-FLDENH       PIC X.                                     
038700          20 TEXT-FLDSTR       PIC X(80).                                 
038800          20 TEXT-FLDLEN       PIC S9(4) COMP.                            
038900*                                                                         
039000 01 BTNROW-DATA.                                                          
039100    05 BRWIDX                  PIC S9(4) COMP VALUE 0.                    
039200    05 BRWCNT                  PIC S9(4) COMP VALUE 0.                    
039300    05 NXKEY-X                 PIC S9(4) COMP VALUE 0.                    
039400    05 NXKEY-Y                 PIC S9(4) COMP VALUE 0.                    
039500    05 NXCHR-CNT               PIC S9(4) COMP VALUE 0.                    
039600    05 NXLBL                   PIC X(32) VALUE SPACES.                    
039700    05 NEXT-LABEL              PIC X(8)  VALUE SPACES.                    
039800    05 ALL-8-LABELS.                                                      
039900       10 BTN                  PIC X(8) OCCURS 8.                         
040000*                                                                         
040100 01 TEXT-BUTTONS.                                                         
040200       10 TEXT-BTNCNT          PIC S9(4) COMP VALUE 0.                    
040300       10 TEXT-Button-ENTRIES OCCURS 8 TIMES.                             
040400          20 TEXT-BTNCOL       PIC S9(4) COMP.                            
040500          20 TEXT-BTNROW       PIC S9(4) COMP.                            
040600          20 TEXT-BTNENH       PIC X.                                     
040700          20 TEXT-BTNSTR       PIC X(16).                                 
040800          20 TEXT-BTNLEN       PIC S9(4) COMP.                            
040900       10 TEXT-KEYS.                                                      
041000          15 TXKEY1-1          PIC X(8) VALUE SPACES.                     
041100          15 TXKEY2-1          PIC X(8) VALUE SPACES.                     
041200          15 TXKEY3-1          PIC X(8) VALUE SPACES.                     
041300          15 TXKEY4-1          PIC X(8) VALUE SPACES.                     
041400          15 TXKEY5-1          PIC X(8) VALUE SPACES.                     
041500          15 TXKEY6-1          PIC X(8) VALUE SPACES.                     
041600          15 TXKEY7-1          PIC X(8) VALUE SPACES.                     
041700          15 TXKEY8-1          PIC X(8) VALUE SPACES.                     
041800          15 TXKEY1-2          PIC X(8) VALUE SPACES.                     
041900          15 TXKEY2-2          PIC X(8) VALUE SPACES.                     
042000          15 TXKEY3-2          PIC X(8) VALUE SPACES.                     
042100          15 TXKEY4-2          PIC X(8) VALUE SPACES.                     
042200          15 TXKEY5-2          PIC X(8) VALUE SPACES.                     
042300          15 TXKEY6-2          PIC X(8) VALUE SPACES.                     
042400          15 TXKEY7-2          PIC X(8) VALUE SPACES.                     
042500          15 TXKEY8-2          PIC X(8) VALUE SPACES.                     
042600*                                                                         
042700 01 DESIGN-AREA.                                                          
042800    02 DESIGN-NAME             PIC X(16).                                 
042900    02 DESLEN                  PIC S9(9) COMP.                            
043000    02 F-DESIGN-LEN            PIC S9(9) COMP.                            
043100    02 F-DESIGN                PIC X(16384).                              
043200    02 F-DESIGN-POINTERS.                                                 
043300       05 FDPIDX               PIC S9(4) COMP VALUE 0.                    
043400       05 FDPCNT               PIC S9(4) COMP VALUE 0.                    
043500       05 FDP-ARRAY OCCURS 110 TIMES.                                     
043600          10 FDP-LEN           PIC S9(9) COMP.                            
043700          10 FDP-STRT          PIC S9(9) COMP.                            
043800          10 FDP-END           PIC S9(9) COMP.                            
043900    02 V-DESIGN-LEN            PIC S9(9) COMP.                            
044000    02 V-DESIGN                PIC X(16384).                              
044100    02 V-DESIGN-POINTERS.                                                 
044200       05 VDPIDX               PIC S9(4) COMP VALUE 0.                    
044300       05 VDPCNT               PIC S9(4) COMP VALUE 0.                    
044400       05 VDP-ARRAY OCCURS 110 TIMES.                                     
044500          10 VDP-LEN           PIC S9(9) COMP.                            
044600          10 VDP-STRT          PIC S9(9) COMP.                            
044700          10 VDP-END           PIC S9(9) COMP.                            
044800    02 STARTX                  PIC S9(9) COMP.                            
044900    02 ENDX                    PIC S9(9) COMP.                            
045000    02 XIDX                    PIC S9(9) COMP.                            
045100    02 V-XLEN                  PIC S9(4) COMP.                            
045200    02 F-XLEN                  PIC S9(4) COMP.                            
045300                                                                          
045400 01 FIELD-X-Y.                                                            
045500    02 FIELD-NAME              PIC X(16) VALUE SPACES.                    
045600    02 FIELD-COLUMN            PIC S9(4) COMP VALUE 0.                    
045700    02 FIELD-ROW               PIC S9(4) COMP VALUE 0.                    
045800    02 F1                      PIC S9(4) COMP VALUE 0.                    
045900    02 FOUND-LEN               PIC S9(4) COMP VALUE 0.                    
046000    02 F-IDX                   PIC S9(4) COMP VALUE 0.                    
046100*                                                                         
046200 01 FORM-FILE-DATA.                                                       
046300   02 FDATA-TIMESTAMP          PIC X(32) VALUE SPACES.                    
046400   02 FORM-DATA-RECORD.                                                   
046500      05  FDATA-FUNCTION-KEYS.                                            
046600         10 FKEY OCCURS 8 TIMES.                                          
046700            15 FKEY-LINE1      PIC X(8).                                  
046800            15 FKEY-LINE2      PIC X(8).                                  
046900                                                                          
047000 01 GLOBAL-FILE-DATA.                                                     
047100    05 GLBIDX                PIC S9(4) COMP VALUE 0.                      
047200    05 GDATA-ITEMS.                                                       
047300       10 GLOBAL-NAME           PIC X(36).                                
047400       10 GLOBAL-VALUE          PIC X(80).                                
047500       10 GLOBAL-LENGTH         PIC S9(4) COMP.                           
047600    05 GDATA-FUNCTION-KEYS.                                               
047700       10 GKEY OCCURS 8 TIMES.                                            
047800          15 GKEY-LINE1      PIC X(8).                                    
047900          15 GKEY-LINE2      PIC X(8).                                    
048000                                                                          
048100 01 LINK-FILEINFO.                                                        
048200    02 LINK-MPEFILENAME           PIC X(36).                              
048300    02 LINK-CREATOR               PIC X(8).                               
048400    02 LINK-ACCOUNT               PIC X(8).                               
048500    02 LINK-GROUP                 PIC X(8).                               
048600    02 LINK-BYTES                 PIC 9(14).                              
048700    02 LINK-VERSION               PIC 9(14).                              
048800    02 LINK-NBROFFORMS            PIC 9(14).                              
048900    02 LINK-MAXFIELDS             PIC 9(4).                               
049000    02 LINK-MAXBUFSIZE            PIC 9(4).                               
049100    02 LINK-SFCOUNT               PIC 9(4).                               
049200    02 LINK-HEADFORM              PIC X(16).                              
049300    02 LINK-GLOBAL-KEY-DEF        PIC XX.                                 
049400    02 LINK-DEFAULT-ENH           PIC X(4).                               
049500    02 LINK-DEFAULT-DTYPE         PIC X(4).                               
049600    02 LINK-DEFAULT-FTYPE         PIC X(2).                               
049700    02 LINK-ERRENH                PIC X(4).                               
049800    02 LINK-WINENH                PIC X(4).                               
049900    02 LINK-WINPOS                PIC 9(4).                               
050000                                                                          
050100 01  GETINFO-DATA.                                                        
050200    05  GINFO-LEN              PIC S9(4) COMP.                            
050300    05  GINFO-STR              PIC X(128).                                
050400    05  GINFO-PARM             PIC S9(4) COMP.                            
050500 01  PARSED-DATA.                                                         
050600    05  ITEMS-PARSED           PIC S9(4) COMP.                            
050700        88 PARSE-IS-COMPLETE VALUES ARE 8 THRU 99.                        
050800    05  PARSED-STRING          PIC X(128).                                
050900    05  NEXT-STRING            PIC X(256).                                
051000    05  STRING-POINTER         PIC S9(4) COMP.                            
051100    05  GX                     PIC S9(4) COMP.                            
051200    05  GY                     PIC S9(4) COMP.                            
051300    05  PX                     PIC S9(4) COMP.                            
051400 01 ITEM-1                     PIC S9(9) COMP VALUE 1.                    
051500 01 ITEM-2                     PIC S9(9) COMP VALUE 2.                    
051600 01 ITEM-11                    PIC S9(9) COMP VALUE 11.                   
051700 01 VAR-VALUE                  PIC 9(3)       VALUE ZERO.                 
051800 01 VAR-NAME                   PIC X(15)      VALUE SPACES.               
051900 01 VAR-STATUS                 PIC S9(9) COMP VALUE 0.                    
052000 01 VAR-VALUE-I                PIC S9(9) COMP VALUE 0.                    
052100 01 VAR-VALUE-S                PIC X(20)      VALUE SPACES.               
052200 01 VAR-VALUE-S-SIZE           PIC S9(9) COMP VALUE 20.                   
052300 01 FLDIDX                     PIC S9(4) COMP.                            
052400 01 FRMIDX                     PIC S9(4) COMP.                            
052500 01 MY-NEW-FILCNT              PIC S9(9) COMP VALUE 0.                    
052600 01 MY-NEW-FRMCNT              PIC S9(9) COMP VALUE 0.                    
052700 01 MY-NEW-FLDCNT              PIC S9(9) COMP VALUE 0.                    
052800 01 MY-NEW-SPCCNT              PIC S9(9) COMP VALUE 0.                    
052900                                                                          
053000 01  FULL-CURRENT-DATE.                                                   
053100         05  C-DATE.                                                      
053200             10  C-YEAR        PIC 9(4).                                  
053300             10  C-MONTH       PIC 99.                                    
053400             10  C-DAY         PIC 99.                                    
053500         05  C-TIME.                                                      
053600             10  C-HOUR        PIC 99.                                    
053700             10  C-MINUTES     PIC 99.                                    
053800             10  C-SECONDS     PIC 99.                                    
053900             10  C-SEC-HUND    PIC 99.                                    
054000         05  C-TIME-DIFF.                                                 
054100             10  O-GMT-DIR     PIC X.                                     
054200             10  O-HOUR        PIC 99.                                    
054300             10  O-MINUTES     PIC 99.                                    
054400 01 ERROR-MSG                  PIC X(80) VALUE SPACES.                    
054500 01 WORK-STRING1               PIC X(84) VALUE SPACES.                    
054600 01 WORK-STRING2               PIC X(84) VALUE SPACES.                    
054700 01 WORK-STRING3               PIC X(4) VALUE SPACES.                     
054800    88 ENH-STRING VALUES ARE "&d@" "&dA" "&dB" "&dC" "&dD" "&dE"          
054900     "&dF" "&dG" "&dH" "&dI" "&dJ" "&dK" "&dL" "&dM" "&dN" "&dO".         
055000 01 WRKIDX                     PIC S9(4) COMP.                            
055100 01 WRKCNT                     PIC S9(4) COMP.                            
055200 01 CALLTYPE                   PIC X(20) VALUE SPACES.                    
055300*                                                                         
055400 01 NUMDEC                     PIC S9(4) COMP.                            
055500 01 NUMERR                     PIC S9(4) COMP.                            
055600 01 NUM1                       PIC X(14).                                 
055700 01 NUM2                       PIC S9(14).                                
055800*                                                                         
055900 01  E-Record-Found-Sw         Pic X Value "0".                           
056000     88 E-Record-Found         Value "1".                                 
056100*                                                                         
056200 01  POINTER-LINK-SW           PIC X.                                     
056300     88  POINTERS-LINKED       VALUE "1".                                 
056400*                                                                         
056500 01  HAVE-FKEYS-SW             PIC X VALUE "9".                           
056600     88 HARDWARE-FKEYS         VALUE "H".                                 
056700     88 PAINTED-FKEYS          VALUE "P".                                 
056800     88 NO-FKEYS-YET           VALUE "N".                                 
056900*                                                                         
057000 01  VALID-T-SW                PIC X.                                     
057100     88  VALID-T               VALUE "1".                                 
057200*                                                                         
057300 01  VALID-D-SW                PIC X.                                     
057400     88  VALID-D               VALUE "1".                                 
057500*                                                                         
057600 01  VALID-G-SW                PIC X.                                     
057700     88  VALID-G               VALUE "1".                                 
057800*                                                                         
057900 01  NONBLANK-SW               PIC X.                                     
058000     88  NONBLANK              VALUE "1".                                 
058100*                                                                         
058200 01  MATCH-SW                  PIC X.                                     
058300     88  MATCH-FOUND           VALUE "1".                                 
058400*                                                                         
058500 01  FMMSTR-SW                 PIC X.                                     
058600     88  FMMSTR-FOUND          VALUE "1".                                 
058700*                                                                         
058800  01 FFIDX                     PIC S9(9) COMP.                            
058900  01 my-tally                  PIC S9(9) COMP.                            
059000  01 FFFIDX                    PIC S9(9) COMP.                            
059100  01 PRSIDX                    PIC S9(9) COMP.                            
059200*                                                                         
059300 01  MIGDB-STATUS.                                                        
059400     03  FILLER                PIC S9(4) COMP VALUE  0.                   
059500     03  FILLER                PIC S9(4) COMP VALUE  0.                   
059600     03  FILLER                PIC S9(9) COMP VALUE  0.                   
059700     03  FILLER                PIC S9(9) COMP VALUE  0.                   
059800     03  FILLER                PIC S9(9) COMP VALUE  0.                   
059900     03  FILLER                PIC S9(9) COMP VALUE  0.                   
060000  01 INSPECT-IDX               PIC S9(4) COMP  VALUE 0.                   
060100*                                                                         
060200 01 WHO-INTRINSIC-PARMS.                                                  
060300    15  WHO-TERM-DEV-NO        PIC S9999 COMP.                            
060400    15  WHO-MODE               PIC S9999 COMP.                            
060500    15  WHO-CAPABILITY         PIC S9(9) COMP  VALUE 0.                   
060600    15  WHO-CAP-PARTS REDEFINES WHO-CAPABILITY.                           
060700        20 WHO-CAP1         PIC S9(4) COMP.                               
060800        20 WHO-CAP2         PIC S9(4) COMP.                               
060900    15  WHO-LATTR              PIC S9(6) COMP.                            
061000    15  WHO-USERN.                                                        
061100        20 BYTE1-6             PIC X(6).                                  
061200        20 SCHOOL-NUMBER       PIC XX.                                    
061300    15  WHO-GROUPN             PIC X(8).                                  
061400    15  WHO-ACCTN              PIC X(8).                                  
061500    15  WHO-HOMEN              PIC X(8).                                  
061600*                                                                         
061700 01 MyHpSusan                  PIC S9(9) COMP  VALUE 0.                   
061800 01 speclen                    PIC S9(4) COMP.                            
061900 01 chrcnt                     pic s9(4) comp.                            
062000 01 chridx                     pic s9(4) comp.                            
062100 01 DATA-LEN                   PIC S9(4) COMP.                            
062200*                                                                         
062300 01 MYCOST                     PIC S9(18) COMP VALUE 0.                   
062400 01 MY-FLD-ENH                 PIC X(4)  VALUE SPACES.                    
062500 01 TOTAL-FILES                PIC S9(18) COMP VALUE 0.                   
062600 01 TOTAL-FORMS                PIC S9(18) COMP VALUE 0.                   
062700 01 TOTAL-FIELDS               PIC S9(18) COMP VALUE 0.                   
062800 01 bufpos                     PIC S9(4) COMP  VALUE 0.                   
062900 01 CMD                        PIC X(255)      VALUE SPACES.              
063000 01 M                          Pic X(78) Value Spaces.                    
063100 01 CSTR                       PIC X(255)      VALUE SPACES.              
063200 01 CERR                       PIC S9(4) COMP  VALUE 0.                   
063300 01 CPARM                      PIC S9(4) COMP  VALUE 0.                   
063400 01 CMSG                       PIC S9(4) COMP  VALUE 2.                   
063500 01  EXTFILE-STATUS            PIC X   VALUE "0".                         
063600     88 EXTFILE-EOF                    VALUE "9".                         
063700 01 My-BaseName                Pic X(6) Value Spaces.                     
063800 01 MYINCREMENT                PIC S9(4) COMP  VALUE 0.                   
063900 01 SHOWTIME-STR.                                                         
064000    02 FILLER                  PIC X(8) VALUE "SHOWTIME".                 
064100    02 FILLER                  PIC X    VALUE %15.                        
064200 01 DATE-EDITING.                                                         
064300    05 RAW-DATE.                                                          
064400       10 D1                   PIC X   VALUE SPACES.                      
064500       10 D2                   PIC X   VALUE SPACES.                      
064600       10 D3                   PIC X   VALUE SPACES.                      
064700       10 D4                   PIC X   VALUE SPACES.                      
064800       10 D5                   PIC X   VALUE SPACES.                      
064900       10 D6                   PIC X   VALUE SPACES.                      
065000       10 D7                   PIC X   VALUE SPACES.                      
065100       10 D8                   PIC X   VALUE SPACES.                      
065200    05 EDITED-DATE.                                                       
065300       10 D5                   PIC X   VALUE SPACES.                      
065400       10 D6                   PIC X   VALUE SPACES.                      
065500       10 FILLER               PIC X   VALUE "/".                         
065600       10 D7                   PIC X   VALUE SPACES.                      
065700       10 D8                   PIC X   VALUE SPACES.                      
065800       10 FILLER               PIC X   VALUE "/".                         
065900       10 D1                   PIC X   VALUE SPACES.                      
066000       10 D2                   PIC X   VALUE SPACES.                      
066100       10 D3                   PIC X   VALUE SPACES.                      
066200       10 D4                   PIC X   VALUE SPACES.                      
066300                                                                          
066400*                                                                         
066500 01 REPORT-BUFFER.                                                        
066600    05 RPT-VFLD-NAME           PIC X(15).                                 
066700    05 FILLER                  PIC XX VALUE SPACE.                        
066800    05 RPT-BUF-X               PIC ZZZ9.                                  
066900    05 FILLER                  PIC XX VALUE SPACE.                        
067000    05 RPT-BUF-Y               PIC ZZZ9.                                  
067100    05 FILLER                  PIC XX VALUE SPACE.                        
067200    05 RPT-SRN-X               PIC Z9.                                    
067300    05 FILLER                  PIC XX VALUE SPACE.                        
067400    05 RPT-SRN-Y               PIC Z9.                                    
067500    05 FILLER                  PIC XX VALUE SPACE.                        
067600    05 RPT-SRN-ORD-NUM         PIC ZZ9.                                   
067700    05 FILLER                  PIC XX VALUE SPACE.                        
067800    05 RPT-VFLD-NUM            PIC ZZ9.                                   
067900    05 FILLER                  PIC XX VALUE SPACE.                        
068000    05 RPT-VFLD-LENGTH         PIC ZZZ9.                                  
068100    05 FILLER                  PIC XX VALUE SPACE.                        
068200    05 RPT-VFLD-POSITION       PIC ZZZ9.                                  
068300    05 FILLER                  PIC XX VALUE SPACE.                        
068400    05 RPT-VFLD-ENHANCE        PIC XXXX.                                  
068500    05 FILLER                  PIC XX VALUE SPACE.                        
068600    05 RPT-VFLD-TYPE           PIC XX.                                    
068700    05 FILLER                  PIC XX VALUE SPACE.                        
068800    05 RPT-VFLD-DATATYPE       PIC XXXX.                                  
068900 01 REPORT-HEADER.                                                        
069000    05 FILLER                  PIC X(15) VALUE "FIELD NAME".              
069100    05 FILLER                  PIC XX VALUE SPACE.                        
069200    05 FILLER                  PIC XXXX VALUE " BFX".                     
069300    05 FILLER                  PIC XX VALUE SPACE.                        
069400    05 FILLER                  PIC XXXX VALUE " BFY".                     
069500    05 FILLER                  PIC XX VALUE SPACE.                        
069600    05 FILLER                  PIC XX VALUE " X".                         
069700    05 FILLER                  PIC XX VALUE SPACE.                        
069800    05 FILLER                  PIC XX VALUE "Y".                          
069900    05 FILLER                  PIC XX VALUE SPACE.                        
070000    05 FILLER                  PIC XXX VALUE "ORD".                       
070100    05 FILLER                  PIC XX VALUE SPACE.                        
070200    05 FILLER                  PIC XXX VALUE "NUM".                       
070300    05 FILLER                  PIC XX VALUE SPACE.                        
070400    05 FILLER                  PIC XXXX VALUE "LEN".                      
070500    05 FILLER                  PIC XX VALUE SPACE.                        
070600    05 FILLER                  PIC XXXX VALUE " POS".                     
070700    05 FILLER                  PIC XX VALUE SPACE.                        
070800    05 FILLER                  PIC XXXX VALUE "ENH".                      
070900    05 FILLER                  PIC XX VALUE SPACE.                        
071000    05 FILLER                  PIC XX VALUE "TY".                         
071100    05 FILLER                  PIC XX VALUE SPACE.                        
071200    05 FILLER                  PIC XXXX VALUE "DATA".                     
071300*                                                                         
071400 01 FILE-INFOBUF.                                                         
071500    05 FILE-NUMBER-OF-ENTRIES  PIC S9(4) COMP.                            
071600    05 FILE-ENTRY-LENGTH       PIC S9(4) COMP.                            
071700    05 FILE-ENTRY-TABLE OCCURS 1 TIMES.                                   
071800       10 IN-FILE-VERSION      PIC S9(8) COMP.                            
071900       10 FILE-NUMBER-OF-FORMS PIC S9(4) COMP.                            
072000       10 FILE-MAX-FIELDS      PIC S9(4) COMP.                            
072100       10 FILE-MAX-BUFSIZE     PIC S9(4) COMP.                            
072200       10 FILE-SAVE-FIELDS     PIC S9(4) COMP.                            
072300       10 FILE-HEAD-FORM       PIC X(15).                                 
072400       10 FILE-FILLER          PIC X.                                     
072500       10 FILE-ERROR-ENHANCE   PIC X(4).                                  
072600       10 FILE-WINDOW-ENHANCE  PIC X(4).                                  
072700       10 FILE-WINDOW-POSITION PIC S9(4) COMP.                            
072800 01 FILE-INFOBUFLEN            PIC S9(4) COMP VALUE 21.                   
072900 01 SPECTABLE.                                                            
073000    02 SPECTABLE-ENTRIES OCCURS 20.                                       
073100       10 SPEC                 PIC X(80).                                 
073200*                                                                         
073300*                                                                         
073400 01 FORM-INFOBUF.                                                         
073500   05 FORM-NUMBER-OF-ENTRIES   PIC S9(4) COMP.                            
073600   05 FORM-ENTRY-LENGTH        PIC S9(4) COMP.                            
073700   05 FORM-ENTRY-TABLE OCCURS 256 TIMES.                                  
073800      10 FORM-FORM-NAME        PIC X(15).                                 
073900      10 FORM-FILLER1          PIC X.                                     
074000      10 FORM-FORM-NUMBER      PIC S9(4) COMP.                            
074100      10 FORM-NUMBER-OF-FIELDS PIC S9(4) COMP.                            
074200      10 FORM-BUF-LENGTH       PIC S9(4) COMP.                            
074300      10 FORM-NEXT-FORM        PIC X(15).                                 
074400      10 FORM-FILLER2          PIC X.                                     
074500      10 FORM-REPEAT-OPTION    PIC X.                                     
074600      10 FORM-NFORM-OPTION     PIC X.                                     
074700 01 FORM-INFOBUFLEN            PIC S9(4) COMP VALUE 62.                   
074800*                                                                         
074900 01 ACTUAL-FORM-COUNT          PIC S9(4) COMP VALUE 0.                    
075000*                                                                         
075100 01 FIELD-INFOBUF.                                                        
075200    05 FIELD-NUMBER-OF-ENTRIES PIC S9(4) COMP.                            
075300    05 FIELD-ENTRY-LENGTH      PIC S9(4) COMP.                            
075400    05 FIELD-FORM-NAME         PIC X(15).                                 
075500    05 FIELD-FILLER            PIC X.                                     
075600    05 FIELD-ENTRY-TABLE OCCURS 128 TIMES.                                
075700       10 FIELD-FIELD-NAME     PIC X(15).                                 
075800       10 FIELD-FILLER         PIC X.                                     
075900       10 FIELD-SCREEN-ORD-NUM PIC S9(4) COMP.                            
076000       10 FIELD-NUM            PIC S9(4) COMP.                            
076100       10 FIELD-LENGTH         PIC S9(4) COMP.                            
076200       10 FIELD-POSITION       PIC S9(4) COMP.                            
076300       10 FIELD-ENHANCE        PIC X(4).                                  
076400 01 FIELD-INFOBUFLEN           PIC S9(4) COMP VALUE 80.                   
076500 01  THIS-TIMESTAMP.                                                      
076600     05 TS-LAYOUT.                                                        
076700        10 VTIMESTAMP          PIC S9(9) COMP.                            
076800        10 VTS-BYTES      REDEFINES VTIMESTAMP.                           
076900         12 VTS-WORD1          PIC S9(4) COMP.                            
077000         12 VTS-WORD1-BIT REDEFINES VTS-WORD1 PIC XX.                     
077100         12 VTS-WORD2          PIC S9(4) COMP.                            
077200         12 VTS-WORD2-BIT REDEFINES VTS-WORD2 PIC XX.                     
077300        10 CALENDAR-PARM.                                                 
077400            15 CAL-INT         PIC S9(4) COMP.                            
077500        10 CLOCK-PARM.                                                    
077600            15 CLOCK-DINT      PIC S9(9) COMP.                            
077700        10 THIS-CLOCK     REDEFINES  CLOCK-PARM.                          
077800         12 CLK-WORD1          PIC S9(4) COMP.                            
077900         12 CLK-WORD1-BIT REDEFINES CLK-WORD1 PIC XX.                     
078000         12 CLK-WORD2          PIC S9(4) COMP.                            
078100         12 CLK-WORD1-BIT REDEFINES CLK-WORD2 PIC XX.                     
078200*                                                                         
078300 01 MY-TIMESTAMP               PIC X(28) VALUE SPACES.                    
078400 01 TDAY                       PIC X(8)  VALUE SPACES.                    
078500 01 TNUMDAY                    PIC S9(9) COMP VALUE 0.                    
078600 01 TDOW                       PIC S9(4) COMP VALUE 0.                    
078700 01 MYTALLY                    PIC S9(9) COMP VALUE 0.                    
078800 01 Y                          PIC S9(4) COMP VALUE 0.                    
078900 01 FKEY-TEST1                 PIC X(100) VALUE SPACES.                   
079000 01 FKEY-TEST2                 PIC X(100) VALUE SPACES.                   
079100 01 DECIMAL-VALUE              PIC S9(4) COMP VALUE 0.                    
079200 01 DISP-N                     PIC ZZZ9 VALUE ZERO.                       
079300 01 EDIT-MESSAGE               PIC X(120).                                
079400 01 THISFORM-FLDCNT            PIC S9(18) COMP VALUE 0.                   
079500 01 IROW                  PIC S9(4) COMP  VALUE 0.                        
079600 01 XCOL                  PIC S9(4) COMP  VALUE 0.                        
079700 01 ZCOL                  PIC S9(4) COMP  VALUE 0.                        
079800 COPY NXUNIQ  OF J3KLIB.                                                  
079900 COPY DBSTAT  OF J3KLIB.                                                  
080000 COPY FFFLDS  OF J3KLIB.                                                  
080100 COPY FFMSTR  OF J3KLIB.                                                  
080200 COPY FMMSTR  OF J3KLIB.                                                  
080300 01 FMMSAV-BUFFER.                                                        
080400    02 FMMSAV-VFIL-UNIQUE       PIC S9(09) COMP VALUE 0.                  
080500    02 FMMSAV-FM-UNIQUE         PIC S9(09) COMP VALUE 0.                  
080600    02 FMMSAV-SVR-UNIQUE        PIC S9(09) COMP VALUE 0.                  
080700    02 FMMSAV-FRM-NAME          PIC X(016) VALUE SPACES.                  
080800    02 FMMSAV-PAN-NAME          PIC X(016) VALUE SPACES.                  
080900    02 FMMSAV-PAN-TYPE          PIC X(006) VALUE SPACES.                  
081000    02 FMMSAV-FRM-NUMBER        PIC S9(09) COMP VALUE 0.                  
081100    02 FMMSAV-FLDCNT            PIC S9(18) COMP VALUE 0.                  
081200    02 FMMSAV-BUF-LEN           PIC S9(18) COMP VALUE 0.                  
081300    02 FMMSAV-NEXT-FRM          PIC X(016) VALUE SPACES.                  
081400    02 FMMSAV-REPEAT-OPT        PIC X(002) VALUE SPACES.                  
081500    02 FMMSAV-NFORM-OPT         PIC X(002) VALUE SPACES.                  
081600    02 FMMSAV-REPRODUCED-FR     PIC X(16)  VALUE SPACES.                  
081700    02 FMMSAV-FKEY-DEF          PIC X(2)   VALUE SPACES.                  
081800    02 FMMSAV-COMMENT           PIC X(80)  VALUE SPACES.                  
081900 COPY prspec  OF J3KLIB.                                                  
082000 COPY SRVMST  OF J3KLIB.                                                  
082100 COPY AMSCOMM OF J3KLIB.                                                  
082200 01  BINARY-VALUE.                                                        
082300     02 WORD1-WHO-CAPABILITY.                                             
082400        05 SM-CAPABILITY         PIC 9.                                   
082500           88 SM-TRUE     VALUE 1.                                        
082600           88 SM-FALSE    VALUE 0.                                        
082700        05 ACTMGR-CAPABILITY     PIC 9.                                   
082800           88 AM-TRUE     VALUE 1.                                        
082900           88 AM-FALSE    VALUE 0.                                        
083000        05 ACTMGR-CAPABILITY     PIC 9(14).                               
083100                                                                          
083200*=================================================================        
083300$PAGE  "Main logical flow"                                                
083400*=================================================================        
083500 PROCEDURE DIVISION.                                                      
083600 BEGIN-0000.                                                              
083700     CALL   INTRINSIC "WHO"                                               
083800     USING  WHO-MODE WHO-CAPABILITY WHO-LATTR WHO-USERN                   
083900            WHO-GROUPN WHO-ACCTN WHO-HOMEN WHO-TERM-DEV-NO.               
084000     MOVE WHO-MODE TO USER-MODE.                                          
084100     MOVE "VPLUS Migration Tool version B:10.5" TO M.                     
084200     PERFORM MSG-PROCESS                                                  
084300     MOVE "------------------------------------------------" TO M.        
084400     PERFORM MSG-PROCESS                                                  
084500     MOVE "***            MIG801.PUB.J3K                ***" TO M.        
084600     PERFORM MSG-PROCESS                                                  
084700     MOVE "***                                          ***" TO M.        
084800     PERFORM MSG-PROCESS                                                  
084900     MOVE "***    Update VPLUS data in MIGDB.PUB.J3K    ***" TO M.        
085000     PERFORM MSG-PROCESS                                                  
085100     MOVE "***                                          ***" TO M.        
085200     PERFORM MSG-PROCESS                                                  
085300     MOVE "------------------------------------------------" TO M.        
085400     PERFORM MSG-PROCESS                                                  
085500     CALL "GETCURRENT" USING TDAY TNUMDAY TDOW.                           
085600     PERFORM INITIALIZATION.                                              
085700     PERFORM Process-File.                                                
085800     PERFORM PROCESS-COMPLETION.                                          
085900*----------------------------------------------------------------         
086000 Process-Completion.                                                      
086100*     DISPLAY "files:     " MY-NEW-FILCNT.                                
086200*     DISPLAY "forms:     " MY-NEW-frmCNT.                                
086300*     DISPLAY "fields:    " MY-NEW-fldCNT.                                
086400*     DISPLAY "Procspecs: " MY-NEW-spcCNT.                                
086500     Go To 9999-RETURN.                                                   
086600*=================================================================        
086700$PAGE  "Major SubParagraphs"                                              
086800*=================================================================        
086900 INITIALIZATION.                                                          
087000D    DISPLAY "INITIALIZATION".                                            
087100     MOVE FUNCTION CURRENT-DATE TO FULL-CURRENT-DATE.                     
087200     OPEN OUTPUT DMG01A3-FILE.                                            
087300     MOVE C-DATE TO RAW-DATE.                                             
087400     MOVE CORR RAW-DATE TO EDITED-DATE.                                   
087500     CALL   INTRINSIC "WHO"                                               
087600     USING  WHO-MODE WHO-CAPABILITY WHO-LATTR WHO-USERN                   
087700            WHO-GROUPN WHO-ACCTN WHO-HOMEN WHO-TERM-DEV-NO.               
087800     INITIALIZE TOTAL-FILES TOTAL-FORMS TOTAL-FIELDS CSTR.                
087900     Perform ShowTime.                                                    
088000     PERFORM GET-HPSUSAN.                                                 
088100     Initialize DATABASE-TABLE My-BaseName.                               
088200     Initialize DATABASE-TABLE My-BaseName.                               
088300     MOVE 128 TO GINFO-LEN.                                               
088400     INITIALIZE GINFO-STR GINFO-PARM.                                     
088500     MOVE 9 TO MIGDB.                                                     
088600     MOVE "MIGDB.PUB.J3K" TO DbName(MIGDB)                                
088700     MOVE "J3K;" TO SEARCH-ITEM.                                          
088800     CALL "DBOPEN" USING                                                  
088900      DATA-BASE-NAME(MIGDB) SEARCH-ITEM MODE-1 STATUS-AREA.               
089000     IF IMAGE-ERRORS PERFORM 9000-IMAGE-ERROR.                            
089100     MOVE STATUS-AREA TO MIGDB-STATUS.                                    
089200     INITIALIZE SrvMST-BUFFER.                                            
089300     MOVE ";" TO NULL-ITEM.                                               
089400     Move 1 to SEARCH-KEY-I2.                                             
089500     Perform Get-SRVMST-Keyed.                                            
089600     If No-Entry                                                          
089700      Display "No server record found"                                    
089800      Call Intrinsic "QUIT" Using \1\.                                    
089900     MOVE FUNCTION CURRENT-DATE TO FULL-CURRENT-DATE.                     
090000     MOVE C-DATE TO RAW-DATE.                                             
090100     MOVE CORR RAW-DATE TO EDITED-DATE.                                   
090200     perform GET-HPSUSAN.                                                 
090300     IF SRVMST-SVR-SUSAN <> MYHPSUSAN                                     
090400      DISPLAY "****************************"                              
090500      DISPLAY "* INSTALLATION PROBLEM     *"                              
090600      DISPLAY "*                          *"                              
090700      DISPLAY "* Invalid License          *"                              
090800      DISPLAY "****************************"                              
090900      Call Intrinsic "QUIT" Using \1\.                                    
091000      Display  "Server: " SRVMST-SVR-NAME.                                
091100      Display  "HPSUSAN: " SRVMST-SVR-SUSAN.                              
091200      Display  "MPE/iX version: " SRVMST-SVR-MPEVERSION.                  
091300     MOVE 128 TO GINFO-LEN.                                               
091400     INITIALIZE GINFO-STR GINFO-PARM.                                     
091500     CALL INTRINSIC "GETINFO" USING GINFO-STR GINFO-LEN                   
091600                                    GINFO-PARM.                           
091700     IF GINFO-LEN = 0                                                     
091800      CALL "GETBITS" USING WHO-CAP1 BINARY-VALUE                          
091900      IF SM-FALSE AND                                                     
092000       (WHO-ACCTN(1:3) <> "SYS" and WHO-USERN(1:7) <> "MANAGER")          
092100       DISPLAY "You must specify ;INFO="                                  
092200               QUOTE "formsfile name" QUOTE                               
092300       DISPLAY "INFO is optional only "                                   
092400               "when you logon with (SM) Capability."                     
092500       DISPLAY " "                                                        
092600       DISPLAY "EXPLAINATION:"                                            
092700       DISPLAY "  The initial run of this process must "                  
092800               "run with System Manager Capability.  "                    
092900       Display "  (SM) Capability is required to collec"                  
093000               "t V/Plus data globally across all      "                  
093100       DISPLAY "  accounts, and to build the MIGDB.PUB."                  
093200               "J3K Image database.                    "                  
093300       DISPLAY "  After the initial run you can logon w"                  
093400               "ithout (SM) Capability and specify a   "                  
093500       DISPLAY "  single file using INFO= on the RUN co"                  
093600               "mand, file system security will apply. "                  
093700       DISPLAY " "                                                        
093800       DISPLAY "  Additionally, without (SM) Capability"                  
093900               " you are limited to an 8 character     "                  
094000       DISPLAY "  formsfile name."                                        
094100       DISPLAY " "                                                        
094200       DISPLAY "You are currently logged in as "                          
094300               WHO-USERN "." WHO-ACCTN "," WHO-GROUPN                     
094400       DISPLAY "You are allowed to access one of the fol"                 
094500               "lowing forms files:                     "                 
094600       MOVE "listfile @;seleq=[code=1035];format=2" to CMD                
094700       Perform MPE-COMMAND                                                
094800       IF CERR <> 0                                                       
094900        DISPLAY "****************************"                            
095000        DISPLAY "*   N O T I C E !          *"                            
095100        DISPLAY "*                          *"                            
095200        DISPLAY "* This group does NOT have *"                            
095300        DISPLAY "* any Source Forms Files!  *"                            
095400        DISPLAY "*                          *"                            
095500        DISPLAY "****************************"                            
095600       END-IF                                                             
095700       STOP RUN                                                           
095800      END-IF                                                              
095900     ELSE                                                                 
096000      IF SM-FALSE AND                                                     
096100       (WHO-ACCTN(1:3) <> "SYS" and WHO-USERN(1:7) <> "MANAGER")          
096200       INITIALIZE PARSED-STRING Screen-Forms-File                         
096300       Move Ginfo-Str(1:Ginfo-Len) To PARSED-STRING                       
096400       move 0 to my-tally                                                 
096500       INSPECT PARSED-STRING tallying my-tally for all "."                
096600       if my-tally > 0                                                    
096700        DISPLAY "****************************"                            
096800        DISPLAY "*   A B O R T              *"                            
096900        DISPLAY "*                          *"                            
097000        DISPLAY "* You may not specify group*"                            
097100        DISPLAY "* or account, only Files!  *"                            
097200        DISPLAY "*                          *"                            
097300        DISPLAY "****************************"                            
097400        STOP RUN                                                          
097500       END-IF                                                             
097600                                                                          
097700       STRING PARSED-STRING DELIMITED BY SPACE                            
097800               "."           DELIMITED BY SIZE                            
097900               Who-Groupn    DELIMITED BY SPACE                           
098000               "."           DELIMITED BY SIZE                            
098100               Who-Acctn                                                  
098200         DELIMITED BY SIZE INTO Screen-Forms-File                         
098300       END-STRING                                                         
098400       DISPLAY "INFO LEN= [" GINFO-LEN  "]"                               
098500D      MOVE GINFO-STR(1:GINFO-LEN) TO SCREEN-FORMS-FILE                   
098600       PERFORM VGETINFO                                                   
098700       PERFORM Process-Completion                                         
098800      ELSE                                                                
098900       INITIALIZE  Screen-Forms-File                                      
099000       Move Ginfo-Str(1:Ginfo-Len) To Screen-Forms-File                   
099100       move 0 to my-tally                                                 
099200       INSPECT Screen-Forms-File tallying my-tally for all "."            
099300       if my-tally < 2                                                    
099400        DISPLAY "****************************"                            
099500        DISPLAY "*   A B O R T              *"                            
099600        DISPLAY "*                          *"                            
099700        DISPLAY "* You must specify group   *"                            
099800        DISPLAY "* and account!             *"                            
099900        DISPLAY "*                          *"                            
100000        DISPLAY "****************************"                            
100100        STOP RUN                                                          
100200       END-IF                                                             
100300                                                                          
100400       DISPLAY "INFO LEN= [" GINFO-LEN  "]"                               
100500D      MOVE GINFO-STR(1:GINFO-LEN) TO SCREEN-FORMS-FILE                   
100600       PERFORM VGETINFO                                                   
100700       PERFORM Process-Completion                                         
100800       GO TO 9999-RETURN.                                                 
100900                                                                          
101000     Initialize Script-Str.                                               
101100     Initialize CSTR CERR CPARM CMSG.                                     
101200     MOVE "Purge DMG01A1,Temp" to CMD.                                    
101300     Perform MPE-COMMAND.                                                 
101400                                                                          
101500     MOVE "Purge DMG01A1" to CMD.                                         
101600     Perform MPE-COMMAND.                                                 
101700                                                                          
101800     MOVE "Purge DMG01A2" to CMD.                                         
101900     Perform MPE-COMMAND.                                                 
102000                                                                          
102100     MOVE "Purge DMG01A2,Temp" to CMD.                                    
102200     Perform MPE-COMMAND.                                                 
102300                                                                          
102400     MOVE "File DMG01A1;rec=-62,1,f,ascii;disc=16384;save" to CMD.        
102500     Perform MPE-COMMAND.                                                 
102600     MOVE SPACES TO CMD.                                                  
102700     STRING "LISTFILE @.@.@;Seleq=[CODE=1035]"                            
102800            ";format=qualify >>*DMG01A1"                                  
102900      DELIMITED BY SIZE INto CMD.                                         
103000     Perform MPE-COMMAND.                                                 
103100     MOVE "File DMG01A1=DMG01A1,OLD" TO CMD.                              
103200     Perform MPE-COMMAND.                                                 
103300*    MOVE                                                                 
103400*     "LISTFILE @.@.@;Seleq=[CODE=1035];format=qualify >>*DMG01A1"        
103500*     to CMD.                                                             
103600*    Perform MPE-COMMAND.                                                 
103700     Initialize CMD.                                                      
103800                                                                          
103900     Sort SortFile ASCENDING KEY SORT-KEY                                 
104000       Using ExtFile1 Giving ExtFile2.                                    
104100                                                                          
104200     Open Input ExtFile2.                                                 
104300                                                                          
104400*-----------------------------------------------------------------        
104500 Process-File.                                                            
104600D    DISPLAY "Process-File".                                              
104700     MOVE 1 TO Db-Ptr.                                                    
104800     MOVE 0 TO DB-CNT.                                                    
104900     Perform varying DB-Idx From 1 By 1                                   
105000       Until ( EXTFILE-EOF ) Or ( DB-Idx > 9999 )                         
105100      READ EXTFILE2                                                       
105200       AT END                                                             
105300        MOVE "9" TO EXTFILE-STATUS                                        
105400       NOT AT END                                                         
105500       ADD 1 TO DB-CNT                                                    
105600       INITIALIZE FFMSTR-BUFFER                                           
105700       Move EXT-REC2 To SCREEN-FORMS-FILE                                 
105800       Display SCREEN-FORMS-FILE WITH NO ADVANCING                        
105900       MOVE "SHOWTIME" TO CMD                                             
106000       PERFORM MPE-COMMAND                                                
106100       PERFORM VGETINFO                                                   
106200* N O T E:  The above perform "VGETINFO" has loaded the                   
106300*           Forms-File-Data area using the VGET__INFO intrinsics.         
106400       If SCREEN-CSTATUS <> 0                                             
106500        Display "*  Error occured " SCREEN-CSTATUS                        
106600        Display "* Skipping FORMSFILE"                                    
106700        MOVE 0 TO SCREEN-CSTATUS                                          
106800       END-IF                                                             
106900      End-Read                                                            
107000     End-Perform.                                                         
107100*=================================================================        
107200$page "MISC SubParagraphs"                                                
107300*=================================================================        
107400 GET-NUM.                                                                 
107500D    DISPLAY "GET-NUM".                                                   
107600     INITIALIZE NUM2 NUMDEC NUMERR.                                       
107700     CALL "NUMGET" USING NUM1 NUM2 NUMDEC NUMERR.                         
107800     IF NUMERR NOT = 0 MOVE 0 TO NUM2.                                    
107900     IF NUMDEC NOT = 0 MOVE 0 TO NUM2.                                    
108000*---------------------------------------------------------                
108100 MPE-COMMAND.                                                             
108200D    DISPLAY "MPE-COMMAND".                                               
108300     INITIALIZE CSTR.                                                     
108400     STRING CMD DELIMITED BY "  " %15                                     
108500      DELIMITED BY SIZE INTO CSTR.                                        
108600     Move 2 To CMSG.                                                      
108700D    DISPLAY CMD(1:79).                                                   
108800     CALL INTRINSIC "HPCICOMMAND" USING                                   
108900          CSTR CERR CPARM CMSG.                                           
109000     IF CERR <> 0                                                         
109100      DISPLAY CERR                                                        
109200      DISPLAY CMD                                                         
109300      DISPLAY CMSG.                                                       
109400     INITIALIZE CMD.                                                      
109500*---------------------------------------------------------                
109600 SHOWTIME.                                                                
109700     CALL INTRINSIC "HPCICOMMAND" USING                                   
109800          SHOWTIME-STR CERR CPARM CMSG.                                   
109900*--------------------------------------------------------                 
110000 GET-HPSUSAN.                                                             
110100     MOVE "HPSUSAN~" TO HPVAR-NAME.                                       
110200     MOVE 1 TO HPVAR-ITEMNUM.                                             
110300     INITIALIZE MYHPSUSAN HPVAR-ITEM HPVAR-STAT.                          
110400     CALL INTRINSIC "HPCIGETVAR" USING HPVAR-NAME                         
110500         HPVAR-STAT HPVAR-ITEMNUM MYHPSUSAN.                              
110600*     DISPLAY "HPSUSAN: " MYHPSUSAN.                                      
110700*------------------------------------------------------------             
110800 MSG-PROCESS.                                                             
110900*      DISPLAY "MSG-PROCESS".                                             
111000     DISPLAY M.                                                           
111100     INITIALIZE CSTR.                                                     
111200     STRING "TELLOP " M  %15 DELIMITED BY SIZE INTO CSTR.                 
111300     Move 2 To CMSG.                                                      
111400     IF BATCH-PROCESS OR NOT-INTERACTIVE                                  
111500      CALL INTRINSIC "HPCICOMMAND" USING                                  
111600           CSTR CERR CPARM CMSG.                                          
111700     INITIALIZE M CMD.                                                    
111800*--------------------------------------------------------------           
111900 PUT-NUMVAR.                                                              
112000     MOVE ZEROS TO VAR-STATUS.                                            
112100     CALL INTRINSIC "HPCIPUTVAR" USING VAR-NAME VAR-STATUS ITEM-1         
112200       VAR-VALUE-I.                                                       
112300     IF VAR-STATUS NOT = ZERO                                             
112400       DISPLAY "Error calling HPCIPUTVAR: " VAR-STATUS.                   
112500*----------------------------                                             
112600 Load-Form-Source.                                                        
112700D    Display " Load-Form-Source.".                                        
112800     INITIALIZE CMD forms-data.                                           
112900     Perform Fopen-Formsfile.                                             
113000     MOVE 256 TO DATA-LEN.                                                
113100     Perform varying DB-Idx From 1 By 1                                   
113200       Until ( EXTFILE-EOF ) Or ( DB-Idx > 32766 )                        
113300      Read Forma-File                                                     
113400          At End     Move '1' To Formsfile-Sw                             
113500          Not At End                                                      
113600       Move '0' To Formsfile-Sw                                           
113700       Add 1 to frdcnt                                                    
113800       Move Form-Rec to frdstr(frdcnt)                                    
113900       Move Frdstr(frdcnt)(1:2) To Ascii-Character                        
114000      End-Read                                                            
114100     End-Perform.                                                         
114200     CLOSE FORMA-FILE.                                                    
114300     Move Frdstr(2)(25:4) To MY-FLD-ENH.                                  
114400D    Display SCREEN-FORMS-FILE "Records : " frdcnt.                       
114500*--------------------------------                                         
114600 Fopen-Formsfile.                                                         
114700D    DISPLAY "Fopen-Formsfile".                                           
114800     MOVE 1 TO S1.                                                        
114900     INSPECT SCREEN-FORMS-FILE                                            
115000      TALLYING S1 FOR CHARACTERS BEFORE ' '.                              
115100     IF S1 > 28 MOVE 28 TO S1.                                            
115200     MOVE 'FILE FORM='           TO CMD.                                  
115300     MOVE SCREEN-FORMS-FILE(1:S1) TO CMD(11:).                            
115400     Perform MPE-COMMAND.                                                 
115500     MOVE "FORMFILE" TO FNAME.                                            
115600     OPEN INPUT FORMA-FILE.                                               
115700     IF FORMFILE-STATUS <> "00"                                           
115800        PERFORM 9001-FILE-ERROR.                                          
115900     MOVE ZERO TO FORMFILE-COUNT.                                         
116000     MOVE "01" TO  FORMFILE-FLAG.                                         
116100*--------------------------------                                         
116200 OPEN-GFILE-OUTPUT.                                                       
116300*    DISPLAY "OPEN-GFILE-OUTPUT".                                         
116400     MOVE 'FILE GFILE=GFILE,OLD'  TO CMD.                                 
116500     Perform MPE-COMMAND.                                                 
116600     MOVE 'PURGE GFILE'           TO CMD.                                 
116700     Perform MPE-COMMAND.                                                 
116800     MOVE 'PURGE GFILE'           TO CMD.                                 
116900     Perform MPE-COMMAND.                                                 
117000     MOVE 'BUILD GFILE;REC=-1540,1,F,BINARY;DISC=16384' TO CMD.           
117100     Perform MPE-COMMAND.                                                 
117200     MOVE "GFILE" TO FNAME.                                               
117300     OPEN OUTPUT G-FILE.                                                  
117400     IF GFILE-STATUS <> "00" PERFORM 9001-FILE-ERROR.                     
117500     MOVE ZERO TO GFILE-RCOUNT GFILE-COUNT.                               
117600     MOVE "02" TO GFILE-FLAG.                                             
117700*--------------------------------                                         
117800 OPEN-GFILE-INPUT.                                                        
117900*    DISPLAY "OPEN-GFILE-INPUT ".                                         
118000     MOVE "GFILE" TO FNAME.                                               
118100     OPEN INPUT G-FILE.                                                   
118200     IF GFILE-STATUS <> "00" PERFORM 9001-FILE-ERROR.                     
118300     MOVE ZERO   TO GFILE-RCOUNT.                                         
118400     MOVE "01" TO GFILE-FLAG.                                             
118500*--------------------------------                                         
118600 READ-GFILE.                                                              
118700*    DISPLAY "READ-GFILE ".                                               
118800     MOVE "GFILE" TO FNAME.                                               
118900     Read G-File                                                          
119000      At End                                                              
119100          INITIALIZE G-RECORD                                             
119200          Move '99' To GFILE-FLAG                                         
119300      Not At End                                                          
119400        IF GFILE-STATUS <> "00"                                           
119500         PERFORM 9001-FILE-ERROR                                          
119600        END-IF                                                            
119700        ADD 1 TO GFILE-RCOUNT                                             
119800        Move G-REC TO G-RECORD.                                           
119900*--------------------------------                                         
120000 WRITE-GFILE.                                                             
120100*    DISPLAY "WRITE-GFILE ".                                              
120200     MOVE "GFILE" TO FNAME.                                               
120300     MOVE G-RECORD TO G-REC.                                              
120400     WRITE G-REC.                                                         
120500     IF GFILE-STATUS <> "00" PERFORM 9001-FILE-ERROR.                     
120600     ADD 1 TO GFILE-COUNT.                                                
120700*--------------------------------                                         
120800 CLOSE-GFILE.                                                             
120900*    DISPLAY "CLOSE-GFILE ".                                              
121000     MOVE "GFILE" TO FNAME.                                               
121100     CLOSE G-FILE.                                                        
121200     MOVE SPACES TO GFILE-FLAG.                                           
121300                                                                          
121400*                                                                         
121500*---------------------------------------------------------------          
121600 Link-VF-Pointers.                                                        
121700*                                                                         
121800* If an "E" record type is found, then this is a valid form.              
121900*                                                                         
122000*           Now go get the design form records.                           
122100*                                                                         
122200* The design form screen in formspec stores the screen data               
122300* in two separate records, the "V" and "F" record types.                  
122400* If both records are not found with the same record length               
122500* then this is not a valid form.                                          
122600*                                                                         
122700* -- N O T E --                                                           
122800*            If FDATA-REPRODUCED-FR is not blank, then this               
122900*            form will not have a "V" and "F" record type.                
123000*            Instead find the "V" and "F" records where the               
123100*            Design-Name matches the value in FDATA-REPRODUCED-FR.        
123200*                                                                         
123300*                                                                         
123400* L O A D    F D E S I G N    P O I N T E R S                             
123500d    display "load fdesign".                                              
123600D    DISPLAY "FMMSTR-REPRODUCED-FR: [" FMMSTR-REPRODUCED-FR "]".          
123700D    DISPLAY "FMMSTR-FRM-NAME:      [" FMMSTR-FRM-NAME "]".               
123800     If FMMSTR-REPRODUCED-FR > SPACES                                     
123900      Move FMMSTR-REPRODUCED-FR to Design-name                            
124000     ELSE                                                                 
124100      MOVE FMMSTR-FRM-NAME TO Design-name.                                
124200     Move 16 To i.                                                        
124300     Perform varying i from 16 by -1                                      
124400       until i < 2 or Design-name(i:1) > " "                              
124500      Continue                                                            
124600     End-Perform                                                          
124700     Move i To deslen.                                                    
124800     MOVE 15 TO DESLEN.                                                   
124900     INITIALIZE F-DESIGN-POINTERS.                                        
125000D    DISPLAY "DESIGN-NAME(1:DESLEN):      ["                              
125100D             DESIGN-NAME(1:DESLEN) "]".                                  
125200     Perform Varying Frdidx From 1 By 1                                   
125300       Until ( Frdidx > Frdcnt ) or (FDPCNT > 109)                        
125400      Move Frdstr(Frdidx)(1:2) To Ascii-Character                         
125500      If (Frdstr(Frdidx)(4:deslen) = Design-name(1:deslen))               
125600          And (Frdstr(Frdidx)(3:1) = "F")                                 
125700          And ( Ascii-Value > 0 )                                         
125800       ADD 1 TO FDPCNT                                                    
125900       Compute FDP-STRT(FDPCNT) =                                         
126000        18 + ((Frdidx * 256) - 255 )                                      
126100       End-compute                                                        
126200       Compute FDP-END(FDPCNT) =                                          
126300        FDP-STRT(FDPCNT) + (Ascii-Value - 20)                             
126400       End-Compute                                                        
126500       Move Ascii-Value To FDP-LEN(FDPCNT)                                
126600D       DISPLAY Design-name(1:deslen) "  "                                
126700D        " F S=" FDP-STRT(FDPCNT)                                         
126800D        " F E=" FDP-END(FDPCNT)                                          
126900D        " F L=" FDP-LEN(FDPCNT)                                          
127000      END-IF                                                              
127100     END-Perform.                                                         
127200*                                                                         
127300* L O A D    V D E S I G N    P O I N T E R S                             
127400*                                                                         
127500d    display "load Vdesign".                                              
127600     INITIALIZE V-DESIGN-POINTERS.                                        
127700     Perform Varying Frdidx From 1 By 1                                   
127800       Until ( Frdidx > Frdcnt ) or (VDPCNT > 109)                        
127900      Move Frdstr(Frdidx)(1:2) To Ascii-Character                         
128000      If (Frdstr(Frdidx)(4:deslen) = Design-name(1:deslen))               
128100          And (Frdstr(Frdidx)(3:1) = "V")                                 
128200          And ( Ascii-Value > 0 )                                         
128300       ADD 1 TO VDPCNT                                                    
128400       Compute VDP-STRT(VDPCNT) =                                         
128500        18 + ((Frdidx * 256) - 255 )                                      
128600       End-compute                                                        
128700       Compute VDP-END(VDPCNT) =                                          
128800        VDP-STRT(VDPCNT) + (Ascii-Value - 20)                             
128900       End-Compute                                                        
129000       Move Ascii-Value To VDP-LEN(VDPCNT)                                
129100D       DISPLAY Design-name(1:deslen) "  "                                
129200D        " V S=" VDP-STRT(VDPCNT)                                         
129300D        " V E=" VDP-END(VDPCNT)                                          
129400D        " V L=" VDP-LEN(VDPCNT)                                          
129500      END-IF                                                              
129600     END-Perform.                                                         
129700*                                                                         
129800* L I N K   " F "   A N D    " V "   P O I N T E R S                      
129900*                                                                         
130000     MOVE "0" TO POINTER-LINK-SW.                                         
130100     If FDPCNT > 0 and VDPCNT > 0                                         
130200      PERFORM VARYING FDPIDX FROM 1 BY 1                                  
130300        UNTIL (POINTERS-LINKED) OR (FDPIDX > FDPCNT)                      
130400       PERFORM VARYING VDPIDX FROM 1 BY 1                                 
130500         UNTIL (POINTERS-LINKED) OR (VDPIDX > VDPCNT)                     
130600        IF FDP-LEN(FDPIDX) = VDP-LEN(VDPIDX)                              
130700         MOVE "1" TO POINTER-LINK-SW                                      
130800         MOVE FDPIDX TO FDPCNT                                            
130900        END-IF                                                            
131000       END-PERFORM                                                        
131100      END-PERFORM.                                                        
131200*---------------------------------------------------------                
131300 GET-SCREEN-OBJECTS.                                                      
131400     If FMMSTR-FRM-NAME = "STDCOSTMAINT"                                  
131500      display "GET-SCREEN-OBJECTS.".                                      
131600     Initialize TEXT-BUTTONS.                                             
131700     MOVE FDP-STRT(FDPCNT) TO startx.                                     
131800     MOVE FDP-END(FDPCNT)  TO endx.                                       
131900     Move FDP-LEN(FDPCNT)  To F-Design-Len.                               
132000     Initialize F-xlen F-Design.                                          
132100     Perform Varying xidx from Startx by 1                                
132200       Until ( xidx > Endx )                                              
132300          OR ( F-xlen > 16382 )                                           
132400      Add 1 to F-xlen                                                     
132500      Move frd-table(xidx:1) to F-Design(F-xlen:1)                        
132600D     display f-xlen "[" F-Design(F-xlen:1) "]"                           
132700     End-Perform.                                                         
132800D    ACCEPT NUM1.                                                         
132900D    COMPUTE Y = F-xlen * -1.                                             
133000D    CALL INTRINSIC "FWRITE" USING \1\ clearscreen \-2\ \0\.              
133100D    MOVE "PAUSE 2" TO CMD.                                               
133200D    PERFORM MPE-COMMAND.                                                 
133300D    CALL INTRINSIC "FWRITE" USING \1\ F-Design Y \0\.                    
133400D    ACCEPT NUM1.                                                         
133500D    Display " ".                                                         
133600D    Display "Formsfile: [" FFMSTR-VFIL-NAME "]".                         
133700D    Display "FORM:      [" FMMSTR-FRM-NAME "]".                          
133800     MOVE "N" TO HAVE-FKEYS-SW.                                           
133900     Perform GET-ROWS.                                                    
134000* // Now find the Function Key values, if any!                            
134100     Initialize FKEY-TEST1 FKEY-TEST2 FDATA-FUNCTION-KEYS.                
134200     If FMMSTR-FKEY-DEF = "X"                                             
134300      Perform Varying Frdidx From 1 By 1                                  
134400        Until ( Frdidx > Frdcnt )                                         
134500       Move Frdstr(Frdidx)(1:2) To Ascii-Character                        
134600       If   (Frdstr(Frdidx)(4:15) = FMMSTR-FRM-NAME(1:15))                
134700             And (Frdstr(Frdidx)(3:1) = "H")                              
134800             And (Ascii-Value  >  140)                                    
134900             And (Ascii-Value  <  180)                                    
135000        Move Frdstr(Frdidx)(19:128) To FDATA-FUNCTION-KEYS                
135100       End-If                                                             
135200      End-Perform.                                                        
135300     IF (Fkey(1) > SPACES OR                                              
135400         Fkey(2) > SPACES OR                                              
135500         Fkey(3) > SPACES OR                                              
135600         Fkey(4) > SPACES OR                                              
135700         Fkey(5) > SPACES OR                                              
135800         Fkey(6) > SPACES OR                                              
135900         Fkey(7) > SPACES OR                                              
136000         Fkey(8) > SPACES )                                               
136100      MOVE "H" TO HAVE-FKEYS-SW                                           
136200     END-IF                                                               
136300     IF ( NO-FKEYS-YET ) AND                                              
136400        (Text-BtnStr(1) > SPACES OR                                       
136500         Text-BtnStr(2) > SPACES OR                                       
136600         Text-BtnStr(3) > SPACES OR                                       
136700         Text-BtnStr(4) > SPACES OR                                       
136800         Text-BtnStr(5) > SPACES OR                                       
136900         Text-BtnStr(6) > SPACES OR                                       
137000         Text-BtnStr(7) > SPACES OR                                       
137100         Text-BtnStr(8) > SPACES )                                        
137200      MOVE "P" TO HAVE-FKEYS-SW                                           
137300      PERFORM VARYING X FROM 1 BY 1 UNTIL X > 8                           
137400       Move Text-BtnStr(x) To Fkey(x)                                     
137500      END-PERFORM.                                                        
137600     IF HARDWARE-FKEYS OR PAINTED-FKEYS                                   
137700      PERFORM VARYING X FROM 1 BY 1 UNTIL X > 8                           
137800D      Display " _______ "                                                
137900D      Display "|" FKEY-LINE1(x) "|"                                      
138000D      Display "|" FKEY-LINE2(x) "|"                                      
138100D      Display " _______ "                                                
138200       Perform ADD-OBJ-FKEY                                               
138300      END-PERFORM.                                                        
138400                                                                          
138500*----------------                                                         
138600 GET-FIELD-DATA.                                                          
138700    IF FMMSTR-FRM-NAME = "STDCOSTMAINT"                                   
138800     display "GET-FIELD-DATA.".                                           
138900     Move 0 To i.                                                         
139000     Perform varying i from 15 by -1                                      
139100       until i < 2 or FMMSTR-FRM-NAME(i:1) > " "                          
139200      Continue                                                            
139300     End-Perform.                                                         
139400     Move i To S1.                                                        
139500     Move 0 To i.                                                         
139600     Perform varying i from 15 by -1                                      
139700       until i < 2 or FFFLDS-VFLD-NAME(i:1) > " "                         
139800      Continue                                                            
139900     End-Perform.                                                         
140000     Move i To S2.                                                        
140100     MOVE 15 TO S1.                                                       
140200     MOVE 15 TO S2.                                                       
140300     IF FMMSTR-FRM-NAME = "STDCOSTMAINT"                                  
140400      Display "SCREEN-NAME [" FMMSTR-FRM-NAME(1:s1)                       
140500              "][" FFFLDS-VFLD-NAME "] " FFFLDS-VFLD-NUM.                 
140600     MOVE "0" TO VALID-G-SW.                                              
140700     Perform Varying GSIDX From 1 By 1                                    
140800       Until VALID-G OR ( GSIDX > GSCNT )                                 
140900      MOVE GS-FIELD(GSIDX) TO G-FIELD-FORMAT                              
141000      Move GS-HEADER(GSIDX) to G-HEADER-FORMAT                            
141100      MOVE 0 TO MYTALLY                                                   
141200      IF FMMSTR-FRM-NAME = "STDCOSTMAINT"                                 
141300        DISPLAY "GET-FIELD-DATA GFF" GFF-FIELD " " GFF-NUM " "            
141400              GFF-FIELD2 " " FFFLDS-VFLD-NUM " " GFF-LEN " "              
141500              GHF-LENGTH                                                  
141600        DISPLAY GFF-ENH GFF-FTYPE GFF-DTYPE GFF-PROCSPECS(1:40)           
141700        DISPLAY FMMSTR-FRM-NAME FFFLDS-VFLD-NUM                           
141800      END-IF                                                              
141900      Initialize  num2 numdec numerr                                      
142000      MOVE GFF-NUM TO num1                                                
142100      call "numget" using num1 num2 numdec numerr                         
142200*      MOVE FUNCTION UPPER-CASE(GFF-FIELD) TO GFF-FIELD                   
142300*      MOVE FUNCTION UPPER-CASE(GFF-FIELD2) TO GFF-FIELD2                 
142400*      MOVE FUNCTION UPPER-CASE(FFFLDS-VFLD-NAME)                         
142500*       TO FFFLDS-VFLD-NAME                                               
142501      IF FMMSTR-FRM-NAME = "STDCOSTMAINT"                                 
142502       DISPLAY "LOOKING FOR VALID GFF DATA **********************"        
142511       DISPLAY "NUMERR = " NUMERR                                         
142520       DISPLAY "[" GFF-FORM "]=[" FMMSTR-FRM-NAME(1:15) "]"               
142530       DISPLAY num2 "=" FFFLDS-VFLD-NUM  " AND "                          
142540               FFFLDS-VFLD-NAME "=" GFF-FIELD " OR " GFF-FIELD2           
142541       DISPLAY " DONE LOOKING              **********************"        
142560      END-IF                                                              
142600      If (NUMERR = 0)                                                     
142700        And (GFF-FORM = FMMSTR-FRM-NAME(1:15))                            
142800        And ((num2 = FFFLDS-VFLD-NUM) AND                                 
142900             (FFFLDS-VFLD-NAME = GFF-FIELD OR GFF-FIELD2))                
143000       Initialize  num2 numdec numerr                                     
143100       MOVE GFF-LEN  TO num1                                              
143200       call "numget" using num1 num2 numdec numerr                        
143300       IF NUM2 = FFFLDS-VFLD-LENGTH                                       
143400        IF GHF-LENGTH < 1541                                              
143500         IF FMMSTR-FRM-NAME = "STDCOSTMAINT"                              
143600          DISPLAY "g:" GFF-ENH GFF-FTYPE GFF-DTYPE                        
143610           GFF-PROCSPECS(1:40)                                            
143700          DISPLAY "v:    " FFFLDS-VFLD-TYPE FFFLDS-VFLD-DATATYPE          
143800         END-IF                                                           
143900         MOVE "1" TO VALID-G-SW                                           
144000         MOVE GFF-FTYPE          TO FFFLDS-VFLD-TYPE                      
144100         MOVE GFF-DTYPE          TO FFFLDS-VFLD-DATATYPE                  
144200         move GFF-INIT           to FFFLDS-VFLD-INITVAL                   
144300         Perform Get-ProcSpecs                                            
144400        end-if                                                            
144500       END-IF                                                             
144600      End-If                                                              
144700     End-Perform.                                                         
144800     if not VALID-G                                                       
144900         IF FMMSTR-FRM-NAME = "STDCOSTMAINT"                              
145000          DISPLAY "NOT VALIE-G :" GFF-ENH GFF-FTYPE GFF-DTYPE             
145100         end-if                                                           
145200         MOVE "1" TO VALID-G-SW                                           
145300         MOVE "HI"         TO FFFLDS-VFLD-ENHANCE                         
145400         MOVE "O"          TO FFFLDS-VFLD-TYPE                            
145500         MOVE "CHAR"       TO FFFLDS-VFLD-DATATYPE                        
145600         move SPACES       TO FFFLDS-VFLD-INITVAL                         
145700         INITIALIZE FFFLDS-SPECS                                          
145800     end-if.                                                              
145900     Add 1 to FFFLDS-VFLD-POSITION.                                       
146000     MOVE  FFFLDS-VFLD-POSITION   TO FFFLDS-BUF-X.                        
146100     MOVE  OBJ-STRTCOL(Irow,Xcol) TO FFFLDS-SRN-X RPT-SRN-X.              
146200     MOVE  OBJ-STRTROW(Irow,Xcol) TO FFFLDS-SRN-Y RPT-SRN-Y.              
146300     If FMMSTR-FRM-NAME = "STDCOSTMAINT"                                  
146400      DISPLAY OBJ-TYPE(IROW,XCOL) " " OBJ-NAME(IROW,XCOL) " "             
146500             OBJ-SRNORD(IROW,XCOL) " " OBJ-STRTROW(IROW,XCOL)             
146600              " " OBJ-STRTCOL(IROW,XCOL)                                  
146700     END-IF                                                               
146800     Compute                                                              
146900      FFFLDS-BUF-Y = FFFLDS-BUF-X + (FFFLDS-VFLD-LENGTH - 1).             
147000     perform add-field.                                                   
147100     IF VALID-G AND Speclen > 1                                           
147200      COMPUTE Y = Speclen * -1 END-COMPUTE                                
147300*     CALL INTRINSIC "FWRITE" USING \1\ GFF-PROCSPECS Y \0\               
147400      Perform Add-ProcSpecs                                               
147500     ELSE                                                                 
147600      MOVE SPACES TO FFFLDS-SPECS.                                        
147700*    Perform Field-To-Xml.                                                
147800*---------------------------------------------------                      
147900 Get-ProcSpecs.                                                           
147910     IF FMMSTR-FRM-NAME = "STDCOSTMAINT"                                  
148010      Display "Get-ProcSpecs".                                            
148100     move 1280 to Speclen.                                                
148200     Move "0" to nonblank-sw.                                             
148300     If Speclen > 1                                                       
148400      Initialize xidx                                                     
148500      Perform Varying xidx from Speclen by -1                             
148600        Until ( GFF-PROCSPECS(xidx:1) > Spaces )                          
148700           or ( xidx < 2 )                                                
148800       Continue                                                           
148900      End-Perform.                                                        
149000     Move xidx to Speclen.                                                
149100     IF FMMSTR-FRM-NAME = "STDCOSTMAINT" AND SPECLEN > 1                  
149110      IF SPECLEN < 60                                                     
149200       DISPLAY "PROCESSING SPECS [" GFF-PROCSPECS(1:SPECLEN) "]"          
149210      ELSE                                                                
149300       DISPLAY "PROCESSING SPECS [" GFF-PROCSPECS(1:60) "]".              
149310                                                                          
149400*-----------------------------------------------------------              
149500 GET-ROWS.                                                                
149600     If FMMSTR-FRM-NAME = "STDCOSTMAINT"                                  
149700      Display "GET-ROWS".                                                 
149800* //                                                                      
149900*    The screen image is processed 1 character at a time. As each         
150000*    character is processed 1 is added to the column value.               
150100*    In this paragraph F-idx is used to point to 1 character.             
150200*                                                                         
150300*    When terminal commands are incountered the appropriate value         
150400*    will be subtracted from the column value, because commands           
150500*    do not use any space on the screen.                                  
150600*    When CR/LF is incountered or the column value reaches 80,            
150700*    then 1 is added to the row value, and the column value is            
150800*    set to zero.                                                         
150900*                                                                         
151000*    Maximum of 32 rows, and 80 columns.                                  
151100*                                                                         
151200* NOTE: The V/Plus message window, is inserted into the                   
151300*       screen based on the forms file window position setting.           
151400*                                                                         
151500* ****  Terminal commands supported in this paragraph:  ****              
151600                                                                          
151700*    1.ESC [  Start of a data field                                       
151800*    2.ESC ]  End of a data field                                         
151900*    3.Ascii decimal value 14; Start line drawing character set.          
152000*    4.Ascii decimal value 15; End line drawing character set.            
152100*    5.ESC &d < and one of the following upper case characters >          
152200*                                                                         
152300*      CHAR Description                        V/Plus Equivalence         
152400*         @ End Enhancement                     NONE                      
152500*         A Blink                               B                         
152600*         B Inverse                             I                         
152700*         C Blink, Inverse                      BI                        
152800*         D Underline                           U                         
152900*         E Blink, Underline                    BU                        
153000*         F Inverse, Underline                  IU                        
153100*         G Blink, Inverse, Underline           BIU                       
153200*         H HalfBright                          H                         
153300*         I Blink, Half Bright                  BH                        
153400*         J Inverse, Half Bright                IH                        
153500*         K Blink, Inverse, Half Bright         BIH                       
153600*         L Underline, Half Bright              UH                        
153700*         M Blink, Underine, HBright            BUH                       
153800*         N Inverse, Underline, HBright         IUH                       
153900*         O Blink, Inverse, Underline, HBright  BIUH                      
154000*         S Secure Field {Newer terminals HP700/XX}                       
154100*                                                                         
154200     Initialize ALL-ROWS.                                                 
154300     MOVE 33 TO ROWMAX.                                                   
154400     MOVE 1  TO ROWCNT ROWSTART.                                          
154500* Check if window position is before all rows.                            
154600     IF FILE-WINDOW-POSITION(1) = 0                                       
154700      PERFORM ADD-OBJ-SCRNMSG                                             
154800      ADD 1 TO ROWCNT                                                     
154900D     DISPLAY "START NEW ROW" ROWCNT                                      
155000     END-IF                                                               
155100* Start iterations through screen image                                   
155200     Perform Varying F-idx from 1 by 1                                    
155300       until (F-idx > F-xlen)                                             
155400          or (ROWCNT > 39)                                                
155500      ADD 1 TO ROW-COLUMN                                                 
155600      If FMMSTR-FRM-NAME = "display only"                                 
155700       IF F-Design(F-idx:1) > %37 AND                                     
155800          F-Design(F-idx:1) < %177                                        
155900        DISPLAY ROWCNT " / " ROW-COLUMN " [" F-Design(F-idx:1) "]"        
156000       ELSE                                                               
156100        EVALUATE F-Design(F-idx:1)                                        
156200         WHEN %1 DISPLAY ROWCNT " / " TXPTR " [SOH]"                      
156300         WHEN %2 DISPLAY ROWCNT " / " TXPTR " [STX]"                      
156400         WHEN %3 DISPLAY ROWCNT " / " TXPTR " [ETX]"                      
156500         WHEN %4 DISPLAY ROWCNT " / " TXPTR " [EOT]"                      
156600         WHEN %5 DISPLAY ROWCNT " / " TXPTR " [ENQ]"                      
156700         WHEN %6 DISPLAY ROWCNT " / " TXPTR " [ACK]"                      
156800         WHEN %7 DISPLAY ROWCNT " / " TXPTR " [BEL]"                      
156900         WHEN %10 DISPLAY ROWCNT " / " TXPTR " [BS]"                      
157000         WHEN %11 DISPLAY ROWCNT " / " TXPTR " [TAB]"                     
157100         WHEN %12 DISPLAY ROWCNT " / " TXPTR " [LF]"                      
157200         WHEN %13 DISPLAY ROWCNT " / " TXPTR " [VT]"                      
157300         WHEN %14 DISPLAY ROWCNT " / " TXPTR " [FF]"                      
157400         WHEN %15 DISPLAY ROWCNT " / " TXPTR " [CR]"                      
157500         WHEN %16 DISPLAY ROWCNT " / " TXPTR " [SO]"                      
157600         WHEN %17 DISPLAY ROWCNT " / " TXPTR " [SI]"                      
157700         WHEN %20 DISPLAY ROWCNT " / " TXPTR " [DLE]"                     
157800         WHEN %21 DISPLAY ROWCNT " / " TXPTR " [DC1]"                     
157900         WHEN %22 DISPLAY ROWCNT " / " TXPTR " [DC2]"                     
158000         WHEN %23 DISPLAY ROWCNT " / " TXPTR " [DC3]"                     
158100         WHEN %24 DISPLAY ROWCNT " / " TXPTR " [DC4]"                     
158200         WHEN %25 DISPLAY ROWCNT " / " TXPTR " [NAK]"                     
158300         WHEN %26 DISPLAY ROWCNT " / " TXPTR " [SYN]"                     
158400         WHEN %27 DISPLAY ROWCNT " / " TXPTR " [ETB]"                     
158500         WHEN %30 DISPLAY ROWCNT " / " TXPTR " [CAN]"                     
158600         WHEN %31 DISPLAY ROWCNT " / " TXPTR " [EM]"                      
158700         WHEN %32 DISPLAY ROWCNT " / " TXPTR " [SUB]"                     
158800         WHEN %33 DISPLAY ROWCNT " / " TXPTR " [ESC]"                     
158900         WHEN %34 DISPLAY ROWCNT " / " TXPTR " [FS]"                      
159000         WHEN %35 DISPLAY ROWCNT " / " TXPTR " [GS]"                      
159100         WHEN %36 DISPLAY ROWCNT " / " TXPTR " [RS]"                      
159200         WHEN %37 DISPLAY ROWCNT " / " TXPTR " [US]"                      
159300         WHEN %177 DISPLAY ROWCNT " / " TXPTR " [DEL]"                    
159400        END-EVALUATE                                                      
159500       END-IF                                                             
159600      END-IF                                                              
159700* Check for end of line conditions                                        
159800      IF ((F-Design(F-idx:1) = %15)                                       
159900          AND (F-Design(F-idx + 1:1) = %12))                              
160000        OR ROW-COLUMN > 80                                                
160100       MOVE F-idx TO ROWEND                                               
160200       COMPUTE ROWLEN =  ROWEND - ROWSTART END-COMPUTE                    
160300       IF ROWLEN < 1 MOVE 1 TO ROWLEN END-IF                              
160400       MOVE F-Design(ROWSTART:ROWLEN) TO ROWSTR(ROWCNT)                   
160500D      DISPLAY "SAVING ROW" ROWCNT " LEN=" ROWLEN                         
160600D      display "[" F-Design(ROWSTART:ROWLEN) "]"                          
160700       PERFORM GET-TEXT                                                   
160800       COMPUTE ROWSTART = F-idx + 2 END-COMPUTE                           
160900       move 0 to ROW-COLUMN                                               
161000       IF ROWCNT > 38                                                     
161100        DISPLAY "MORE THAN 38 ROWS; NOT SUPPORTED"                        
161200       ELSE                                                               
161300        ADD 1 TO ROWCNT F-idx                                             
161400D       DISPLAY "START NEW ROW" ROWCNT                                    
161500       END-IF                                                             
161600* NEW ROW: Check window position                                          
161700       INITIALIZE ROW-ENTRIES(ROWCNT)                                     
161800      END-IF                                                              
161900* NOT AT END OF LINE                                                      
162000*                                                                         
162100* Check for Escaped DATA FIELD                                            
162200*                                                                         
162300      IF ((F-Design(F-idx:1) = %33)                                       
162400          AND (F-Design(F-idx + 1:1) = "[" or "{" OR "]" or "}"))         
162500*       OR (F-Design(F-idx:1) = "[" or "{")                               
162600       SUBTRACT 2 FROM ROW-COLUMN                                         
162700      IF (((F-Design(F-idx:1) = %33)                                      
162800       AND (F-Design(F-idx + 1:1) = "[" or "{" ))                         
162900          OR (F-Design(F-idx:1) = "[" or "{" ))                           
163000       AND F-Design(F-idx + 2:1) <> "."                                   
163100        PERFORM ADD-OBJ-DATAFIELD                                         
163200       END-IF                                                             
163300      ELSE                                                                
163400       IF (F-Design(F-idx:1) = %33)                                       
163500        PERFORM GET-ESCAPE-SEQ-LENGTH                                     
163600        SUBTRACT ESC-LEN FROM ROW-COLUMN                                  
163700       END-IF                                                             
163800      END-IF                                                              
163900*                                                                         
164000* Check for Line Drawing Character set                                    
164100*                                                                         
164200      IF (F-Design(F-idx:1) = %17 OR %16)                                 
164300        SUBTRACT 1 FROM ROW-COLUMN                                        
164400      END-IF                                                              
164500      IF (F-Design(F-idx:1) = %16)                                        
164600        PERFORM GET-Linedrawing                                           
164700      END-IF                                                              
164800*     DISPLAY "SHOW CHAR DATA"                                            
164900      Move LOW-VALUE          to ASCII-BYTE1                              
165000      Move  F-Design(F-idx:1) To ASCII-BYTE2                              
165100*      IF FMMSTR-FRM-NAME = "STDCOSTMAINT"                                
165200*       Display "Chr [" F-Design(F-idx:1) "] idx=" f-idx                  
165300*       " row=" rowcnt  " col=" ROW-COLUMN " ASCII= " Ascii-Value         
165400*      END-IF                                                             
165500     End-Perform.                                                         
165600                                                                          
165700     MOVE F-idx TO ROWEND.                                                
165800     COMPUTE ROWLEN =  ROWEND - ROWSTART.                                 
165900D    DISPLAY "LAST ROW LEN END START: " ROWLEN   ROWEND  ROWSTART.        
166000     If ROWLEN > 1                                                        
166100      MOVE F-Design(ROWSTART:ROWLEN) TO ROWSTR(ROWCNT)                    
166200D     DISPLAY "SAVING LAST ROW" ROWCNT " LEN=" ROWLEN                     
166300D     display "[" F-Design(ROWSTART:ROWLEN) "]"                           
166400      PERFORM GET-TEXT                                                    
166500      COMPUTE ROWSTART = F-idx + 2 END-COMPUTE                            
166600      move 0 to ROW-COLUMN.                                               
166700* End iterations through screen image                                     
166800     If FILE-WINDOW-POSITION(1) > 1                                       
166900      Move 26 to ROWCNT FILE-WINDOW-POSITION(1)                           
167000      PERFORM ADD-OBJ-SCRNMSG.                                            
167100     ADD 1 TO ROWCNT.                                                     
167200*------------------------------------------------                         
167300 GET-TEXT.                                                                
167400D    DISPLAY "GET-TEXT".                                                  
167500     INITIALIZE next-string NEW-TEXT-AREA.                                
167600     MOVE "0"        TO END-ROW-SW.                                       
167700     MOVE "0"        TO NON-TEXT-SW.                                      
167800     MOVE 1          TO TEXT-COLUMN.                                      
167900     MOVE 1          TO TXPTR-START.                                      
168000     MOVE "@"        TO TEXT-ENH.                                         
168100     Initialize INSPECT-IDX.                                              
168200     Inspect ROWSTR(ROWCNT) tallying INSPECT-IDX for all %33.             
168300     If (FILE-WINDOW-POSITION(1) > 22) and                                
168400        (rowcnt = 2 or 3) AND                                             
168500        (INSPECT-IDX >= 7)                                                
168600      Move "1" to End-Row-Sw                                              
168700     If rowcnt = 2                                                        
168800       move RowStr(Rowcnt) To next-string                                 
168900       Perform Extract-Labels                                             
169000       Move btn(1) To Txkey1-1                                            
169100       Move btn(2) To Txkey2-1                                            
169200       Move btn(3) To Txkey3-1                                            
169300       Move btn(4) To Txkey4-1                                            
169400       Move btn(5) To Txkey5-1                                            
169500       Move btn(6) To Txkey6-1                                            
169600       Move btn(7) To Txkey7-1                                            
169700       Move btn(8) To Txkey8-1                                            
169800     END-IF                                                               
169900     If rowcnt = 3                                                        
170000       move RowStr(Rowcnt) To next-string                                 
170100       Perform Extract-Labels                                             
170200       Move btn(1) To Txkey1-2                                            
170300       Move btn(2) To Txkey2-2                                            
170400       Move btn(3) To Txkey3-2                                            
170500       Move btn(4) To Txkey4-2                                            
170600       Move btn(5) To Txkey5-2                                            
170700       Move btn(6) To Txkey6-2                                            
170800       Move btn(7) To Txkey7-2                                            
170900       Move btn(8) To Txkey8-2                                            
171000     END-IF                                                               
171100     If (FILE-WINDOW-POSITION(1) > 22) and (rowcnt = 2 or 3)              
171200      String Txkey1-1 Txkey1-2                                            
171300       Delimited by size into TEXT-BTNSTR(1)                              
171400       End-String                                                         
171500      String Txkey2-1 Txkey2-2                                            
171600       Delimited by size into TEXT-BTNSTR(2)                              
171700       End-String                                                         
171800      String Txkey3-1 Txkey3-2                                            
171900       Delimited by size into TEXT-BTNSTR(3)                              
172000       End-String                                                         
172100      String Txkey4-1 Txkey4-2                                            
172200       Delimited by size into TEXT-BTNSTR(4)                              
172300       End-String                                                         
172400      String Txkey5-1 Txkey5-2                                            
172500       Delimited by size into TEXT-BTNSTR(5)                              
172600       End-String                                                         
172700      String Txkey6-1 Txkey6-2                                            
172800       Delimited by size into TEXT-BTNSTR(6)                              
172900       End-String                                                         
173000      String Txkey7-1 Txkey7-2                                            
173100       Delimited by size into TEXT-BTNSTR(7)                              
173200       End-String                                                         
173300      String Txkey8-1 Txkey8-2                                            
173400       Delimited by size into TEXT-BTNSTR(8)                              
173500       End-String.                                                        
173600                                                                          
173700     PERFORM VARYING TXPTR FROM TXPTR-START BY 1                          
173800        UNTIL END-OF-ROW                                                  
173900           OR (TXPTR > ROWLEN)                                            
174000           Or (text-char > 80)                                            
174100      MOVE "0" TO NEW-TEXT-FOUND-SW                                       
174200      IF ((ROWSTR(ROWCNT)(TXPTR:1) = %15)                                 
174300          AND (ROWSTR(ROWCNT)(TXPTR + 1:1) = %12))                        
174400        OR (ROWSTR(ROWCNT)(TXPTR:1) = %0)                                 
174500        OR (TXPTR > ROWLEN)                                               
174600        Or (text-char > 81)                                               
174700       MOVE "1" TO END-ROW-SW                                             
174800      END-IF                                                              
174900      IF NOT END-OF-ROW                                                   
175000       IF  ( ROWSTR(ROWCNT)(TXPTR:1)     = %33 ) AND                      
175100           ( ROWSTR(ROWCNT)(TXPTR + 1:1) = %46 ) AND                      
175200           ( ROWSTR(ROWCNT)(TXPTR + 2:1) = %144)                          
175300        MOVE ROWSTR(ROWCNT)(TXPTR + 3:1) TO TEXT-ENH                      
175400        ADD 4 TO TXPTR                                                    
175500*       IF TXPTR > ROWLEN                                                 
175600*        MOVE ROWLEN TO TXPTR                                             
175700*       END-IF                                                            
175800       END-IF                                                             
175900       IF  ( ROWSTR(ROWCNT)(TXPTR:1)     = %33 ) AND                      
176000           ( ROWSTR(ROWCNT)(TXPTR + 1:1) = ")" ) AND                      
176100           ( ROWSTR(ROWCNT)(TXPTR + 2:1) = "B")                           
176200        ADD 3 TO TXPTR                                                    
176300*       IF TXPTR > ROWLEN                                                 
176400*        MOVE ROWLEN TO TXPTR                                             
176500*       END-IF                                                            
176600       END-IF                                                             
176700       IF ((ROWSTR(ROWCNT)(TXPTR:1) = %33) AND                            
176800            (ROWSTR(ROWCNT)(TXPTR + 1:1) = %133 or %173 ))                
176900        If text-char > 0                                                  
177000         MOVE "1" TO NEW-TEXT-FOUND-SW                                    
177100         MOVE TEXT-CHAR TO TEXT-FLDLEN(TEXT-FLDCNT)                       
177200         MOVE ROWCNT    TO TEXT-FLDROW(TEXT-FLDCNT)                       
177300*         DISPLAY "TEXT: " TEXT-FLDCOL(TEXT-FLDCNT)                       
177400*                          TEXT-FLDROW(TEXT-FLDCNT)                       
177500*                     " "  TEXT-FLDENH(TEXT-FLDCNT)                       
177600*         " [" TEXT-FLDSTR(TEXT-FLDCNT)(1:TEXT-CHAR) "]"                  
177700         perform ADD-OBJ-text                                             
177800         MOVE 0 TO TEXT-CHAR                                              
177900        End-If                                                            
178000        MOVE "1" TO NON-TEXT-SW                                           
178100        Add 2 To TxPtr                                                    
178200       END-IF                                                             
178300       IF ((ROWSTR(ROWCNT)(TXPTR:1) = %33)                                
178400           AND (ROWSTR(ROWCNT)(TXPTR + 1:1) = %135 ))                     
178500          OR (ROWSTR(ROWCNT)(TXPTR:1) = %135)                             
178600         MOVE "0" TO NON-TEXT-SW                                          
178700         Add 2 To TxPtr                                                   
178800       END-IF                                                             
178900       IF (ROWSTR(ROWCNT)(TXPTR:1) = %16)                                 
179000        If text-char > 0                                                  
179100         MOVE "1" TO NEW-TEXT-FOUND-SW                                    
179200         MOVE TEXT-CHAR TO TEXT-FLDLEN(TEXT-FLDCNT)                       
179300         MOVE ROWCNT    TO TEXT-FLDROW(TEXT-FLDCNT)                       
179400*         DISPLAY "TEXT: " TEXT-FLDCOL(TEXT-FLDCNT)                       
179500*                          TEXT-FLDROW(TEXT-FLDCNT)                       
179600*                     " "  TEXT-FLDENH(TEXT-FLDCNT)                       
179700*         " [" TEXT-FLDSTR(TEXT-FLDCNT)(1:TEXT-CHAR) "]"                  
179800         perform ADD-OBJ-text                                             
179900         MOVE 0 TO TEXT-CHAR                                              
180000        End-If                                                            
180100        MOVE "1" TO NON-TEXT-SW                                           
180200        Add 1 To TxPtr                                                    
180300       END-IF                                                             
180400       IF (ROWSTR(ROWCNT)(TXPTR:1) = %17)                                 
180500        MOVE "0" TO NON-TEXT-SW                                           
180600        Add 1 To TxPtr                                                    
180700       END-IF                                                             
180800       IF (IN-TEXT-AREA) AND ( TEXT-CHAR > 0 ) AND                        
180900         ( (( ROWSTR(ROWCNT)(TXPTR:1)     = %40 ) AND                     
181000           ( ROWSTR(ROWCNT)(TXPTR + 1:1) = %40 ))                         
181100          or                                                              
181200           (( ROWSTR(ROWCNT)(TXPTR:1)     = %0 ) AND                      
181300           ( ROWSTR(ROWCNT)(TXPTR + 1:1) = %0 ))                          
181400          or                                                              
181500           ( text-char > 79 ) )                                           
181600        MOVE "1" TO NEW-TEXT-FOUND-SW                                     
181700        MOVE TEXT-CHAR TO TEXT-FLDLEN(TEXT-FLDCNT)                        
181800        MOVE ROWCNT    TO TEXT-FLDROW(TEXT-FLDCNT)                        
181900*       DISPLAY "TEXT: " TEXT-FLDCOL(TEXT-FLDCNT)                         
182000*                        TEXT-FLDROW(TEXT-FLDCNT)                         
182100*                   " "  TEXT-FLDENH(TEXT-FLDCNT)                         
182200*       " [" TEXT-FLDSTR(TEXT-FLDCNT)(1:TEXT-CHAR) "]"                    
182300         perform ADD-OBJ-text                                             
182400        MOVE 0 TO TEXT-CHAR                                               
182500       END-IF                                                             
182600       IF (IN-TEXT-AREA) AND ( NOT NEW-TEXT-FOUND ) AND                   
182700          (((ROWSTR(ROWCNT)(TXPTR:1) > %37) AND TEXT-CHAR > 0)            
182800           OR                                                             
182900           ((ROWSTR(ROWCNT)(TXPTR:1) > %40) AND TEXT-CHAR = 0))           
183000        ADD 1 TO TEXT-CHAR                                                
183100        IF TEXT-CHAR = 1                                                  
183200         ADD 1 TO TEXT-FLDCNT                                             
183300         MOVE TEXT-COLUMN TO TEXT-FLDCOL(TEXT-FLDCNT)                     
183400         MOVE ROWCNT      TO TEXT-FLDROW(TEXT-FLDCNT)                     
183500         MOVE TEXT-ENH    TO TEXT-FLDENH(TEXT-FLDCNT)                     
183600        END-IF                                                            
183700        IF TEXT-CHAR < 81                                                 
183800         MOVE ROWSTR(ROWCNT)(TXPTR:1)                                     
183900           TO TEXT-FLDSTR(TEXT-FLDCNT)(TEXT-CHAR:1)                       
184000        End-If                                                            
184100       END-IF                                                             
184200*      display "in=" NON-TEXT-SW "[" ROWSTR(ROWCNT)(TXPTR:1)              
184300*        "] txptr=" txptr                                                 
184400*        " text column=" TEXT-COLUMN " text char=" TEXT-CHAR              
184500       ADD 1 TO TEXT-COLUMN                                               
184600      END-IF                                                              
184700     END-PERFORM.                                                         
184800     IF TEXT-CHAR > 0                                                     
184900*      MOVE TEXT-CHAR TO TEXT-FLDLEN(TEXT-FLDCNT)                         
185000*      COMPUTE TEXT-FLDROW(TEXT-FLDCNT)                                   
185100*       = (ROWCNT - 1)                                                    
185200*      END-COMPUTE                                                        
185300      perform ADD-OBJ-text.                                               
185400*      DISPLAY "TEXT: " TEXT-FLDCOL(TEXT-FLDCNT)                          
185500*                       TEXT-FLDROW(TEXT-FLDCNT)                          
185600*                  " "  TEXT-FLDENH(TEXT-FLDCNT)                          
185700*        " [" TEXT-FLDSTR(TEXT-FLDCNT)(1:TEXT-CHAR) "]".                  
185800*------------------------------------------------                         
185900 ADD-OBJ-DATAFIELD.                                                       
186000*     IF FMMSTR-FRM-NAME = "STDCOSTMAINT"                                 
186100*      DISPLAY "ADD-OBJ-DATAFIELD".                                       
186200     ADD 1 TO OBJCNT(ROWCNT).                                             
186300     ADD 1 TO FORM-SCRNORD.                                               
186400     COMPUTE ODF = F-idx + 2.                                             
186500     PERFORM VARYING ODF FROM ODF BY 1                                    
186600       UNTIL ODF > F-xlen                                                 
186700            or F-Design(ODF:1) > ' '                                      
186800      CONTINUE                                                            
186900     END-PERFORM.                                                         
187000     PERFORM VARYING ODF FROM ODF BY 1                                    
187100       UNTIL ODF > F-xlen                                                 
187200            or F-Design(ODF:1) = %33                                      
187300            or F-Design(ODF:1) = ' '                                      
187400            or F-Design(ODF:1) = ']'                                      
187500            or F-Design(ODF:1) = '.'                                      
187600            or F-Design(ODF:1) = %0                                       
187700      CONTINUE                                                            
187800     END-PERFORM.                                                         
187900     COMPUTE ODFLEN = (ODF - (F-idx + 2)).                                
188000     COMPUTE ODF = F-idx + 2.                                             
188100D    DISPLAY "ODFLEN=" ODFLEN.                                            
188200D    DISPLAY "ODF=" ODF.                                                  
188300     IF ODF > 0 AND ODFLEN > 0                                            
188400*      IF FMMSTR-FRM-NAME = "STDCOSTMAINT"                                
188500*       DISPLAY "F-Design(ODF:ODFLEN) [" F-Design(ODF:ODFLEN) "]"         
188600*      END-IF                                                             
188700      MOVE OBJCNT(ROWCNT) TO X                                            
188800      MOVE "DA"                 TO OBJ-TYPE(ROWCNT,X)                     
188900      MOVE F-Design(ODF:ODFLEN) TO OBJ-NAME(ROWCNT,X)                     
189000      MOVE FORM-SCRNORD         TO OBJ-SRNORD(ROWCNT,X)                   
189100      MOVE ROWCNT               TO OBJ-STRTROW(ROWCNT,X)                  
189200      COMPUTE OBJ-STRTCOL(ROWCNT,X) = ROW-COLUMN + 2                      
189300*      If FMMSTR-FRM-NAME = "STDCOSTMAINT"                                
189400*       DISPLAY OBJ-TYPE(ROWCNT,X) " " OBJ-NAME(ROWCNT,X) " "             
189500*               OBJ-SRNORD(ROWCNT,X) " " OBJ-STRTROW(ROWCNT,X) " "        
189600*               OBJ-STRTCOL(ROWCNT,X)                                     
189700*      END-IF                                                             
189800      INITIALIZE OBJ-VALUE(ROWCNT,X) OBJ-FLDNUM(ROWCNT,X)                 
189900      Move 1 to OBJ-LEN(ROWCNT,X).                                        
190000*------------------------------------------------                         
190100 ADD-OBJ-SCRNMSG.                                                         
190200D    DISPLAY "ADD-OBJ-SCRNMSG".                                           
190300     ADD 1 TO OBJCNT(ROWCNT).                                             
190400     MOVE OBJCNT(ROWCNT) TO X.                                            
190500     MOVE "MW"                 TO OBJ-TYPE(ROWCNT,X).                     
190600     MOVE "SCREEN-MSG"         TO OBJ-NAME(ROWCNT,X).                     
190700     MOVE 0                    TO OBJ-SRNORD(ROWCNT,X).                   
190800     MOVE ROWCNT               TO OBJ-STRTROW(ROWCNT,X)                   
190900     MOVE 1                    TO OBJ-STRTCOL(ROWCNT,X).                  
191000     INITIALIZE OBJ-VALUE(ROWCNT,X) OBJ-FLDNUM(ROWCNT,X) .                
191100     Move 80 to OBJ-LEN(ROWCNT,X).                                        
191200                                                                          
191300*------------------------------------------------                         
191400 ADD-OBJ-ENHANCEMENT.                                                     
191500D    DISPLAY "ADD-OBJ-ENHANCEMENT".                                       
191600     ADD 1 TO OBJCNT(ROWCNT).                                             
191700     MOVE OBJCNT(ROWCNT) TO X.                                            
191800     MOVE "EN"                 TO OBJ-TYPE(ROWCNT,X).                     
191900     MOVE "ENHANCEMENT"        TO OBJ-NAME(ROWCNT,X).                     
192000     MOVE 0                    TO OBJ-SRNORD(ROWCNT,X).                   
192100     MOVE ROWCNT               TO OBJ-STRTROW(ROWCNT,X).                  
192200     MOVE ROW-COLUMN TO OBJ-STRTCOL(ROWCNT,X).                            
192300     PERFORM VARYING ENHIDX FROM 1 BY 1                                   
192400      UNTIL HPENH(ENHIDX) = PARSED-STRING(4:1)                            
192500         OR ENHIDX > 18                                                   
192600      CONTINUE                                                            
192700     END-PERFORM.                                                         
192800     MOVE VPLUSENH(ENHIDX) TO OBJ-VALUE(ROWCNT,X)                         
192900     INITIALIZE OBJ-FLDNUM(ROWCNT,X).                                     
193000     Move 4 to OBJ-LEN(ROWCNT,X).                                         
193100*------------------------------------------------                         
193200 ADD-OBJ-text.                                                            
193300D    DISPLAY "ADD-OBJ-text".                                              
193400     IF TEXT-FLDSTR(TEXT-FLDCNT)(1:2) <> "&d"                             
193500      ADD 1 TO OBJCNT(ROWCNT)                                             
193600      MOVE OBJCNT(ROWCNT) TO X                                            
193700      MOVE "TX"                     TO OBJ-TYPE(ROWCNT,X)                 
193800      MOVE "TEXT"                   TO OBJ-NAME(ROWCNT,X)                 
193900      MOVE 0                        TO OBJ-SRNORD(ROWCNT,X)               
194000      MOVE TEXT-FLDROW(TEXT-FLDCNT) TO OBJ-STRTROW(ROWCNT,X)              
194100      MOVE TEXT-FLDCOL(TEXT-FLDCNT) TO OBJ-STRTCOL(ROWCNT,X)              
194200      MOVE TEXT-FLDLEN(TEXT-FLDCNT) TO OBJ-LEN(ROWCNT,X)                  
194300      move TEXT-FLDENH(TEXT-FLDCNT) TO OBJ-ENH(ROWCNT,X)                  
194400      If Text-Char > 80 Move 80 To Text-Char End-If                       
194500      MOVE TEXT-FLDSTR(TEXT-FLDCNT)(1:TEXT-CHAR)                          
194600        TO OBJ-VALUE(ROWCNT,X)                                            
194700      INITIALIZE OBJ-FLDNUM(ROWCNT,X)                                     
194800      Move TEXT-CHAR to OBJ-LEN(ROWCNT,X)                                 
194900     ELSE                                                                 
195000      DISPLAY "INVALID TEXT ["                                            
195100       TEXT-FLDSTR(TEXT-FLDCNT)(1:2) "]".                                 
195200*------------------------------------------------                         
195300 ADD-OBJ-FKEY.                                                            
195400D    DISPLAY "ADD-OBJ-FKEY".                                              
195500     ADD 1 TO OBJCNT(ROWCNT).                                             
195600     IF HARDWARE-FKEYS MOVE 27 TO OBJ-STRTROW(ROWCNT,X).                  
195700     IF PAINTED-FKEYS  MOVE  2 TO OBJ-STRTROW(ROWCNT,X).                  
195800     MOVE "FK"                     TO OBJ-TYPE(ROWCNT,X).                 
195900     MOVE "FKEY"                   TO OBJ-NAME(ROWCNT,X).                 
196000     MOVE 0                        TO OBJ-SRNORD(ROWCNT,X).               
196100     STRING FKEY-LINE1(x) FKEY-LINE2(x)                                   
196200      DELIMITED BY SIZE          INTO OBJ-VALUE(ROWCNT,X).                
196300*    MOVE ROWCNT                   TO OBJ-STRTROW(ROWCNT,X).              
196400     IF X < 5                                                             
196500      COMPUTE OBJ-STRTCOL(ROWCNT,X) = ((X * 8) - ( 8 - X))                
196600     ELSE                                                                 
196700      COMPUTE OBJ-STRTCOL(ROWCNT,X) = ((X * 8) +  X).                     
196800     MOVE 16                       TO OBJ-LEN(ROWCNT,X)                   
196900     move "HI"                     TO OBJ-ENH(ROWCNT,X)                   
197000     INITIALIZE OBJ-FLDNUM(ROWCNT,X).                                     
197100                                                                          
197200                                                                          
197300*------------------------------------------------                         
197400 ADD-OBJ-LINEDRAW.                                                        
197500D    DISPLAY "ADD-OBJ-LINEDRAW".                                          
197600     INITIALIZE WORK-STRING1 WORK-STRING2 WRKIDX WRKCNT.                  
197700     ADD 1 TO OBJCNT(ROWCNT).                                             
197800     MOVE OBJCNT(ROWCNT) TO X.                                            
197900     MOVE "LD"                 TO OBJ-TYPE(ROWCNT,X).                     
198000     MOVE "Line"               TO OBJ-NAME(ROWCNT,X).                     
198100     MOVE 0                    TO OBJ-SRNORD(ROWCNT,X).                   
198200     MOVE ROWCNT               TO OBJ-STRTROW(ROWCNT,X).                  
198300     MOVE ROW-COLUMN TO OBJ-STRTCOL(ROWCNT,X).                            
198400     MOVE PARSED-STRING(1:ld-len) TO WORK-STRING1.                        
198500     PERFORM VARYING WRKIDX FROM 1 BY 1                                   
198600       UNTIL (WRKIDX > 80) OR (WRKIDX > ld-len)                           
198700      MOVE SPACES TO WORK-STRING3                                         
198800      MOVE WORK-STRING1(WRKIDX:3) TO WORK-STRING3                         
198900      IF ENH-STRING                                                       
199000       ADD 3 TO WRKIDX                                                    
199100       SUBTRACT 3 FROM LD-LEN                                             
199200      ELSE                                                                
199300       IF WORK-STRING1(WRKIDX:1) > SPACES                                 
199400        ADD 1 TO WRKCNT                                                   
199500        MOVE WORK-STRING1(WRKIDX:1) TO WORK-STRING2(WRKCNT:1)             
199600       END-IF                                                             
199700      END-IF                                                              
199800     END-PERFORM.                                                         
199900     IF LD-LEN > 0                                                        
200000      MOVE WORK-STRING2(1:ld-len) TO OBJ-VALUE(ROWCNT,X)                  
200100      INITIALIZE OBJ-FLDNUM(ROWCNT,X)                                     
200200      Move ld-len to OBJ-LEN(ROWCNT,X).                                   
200300*-----------------------------------------------------------              
200400 GET-ESCAPE-SEQ-LENGTH.                                                   
200500D     Display "GET-ESCAPE-SEQ-LENGTH".                                    
200600*                                                                         
200700* The octal value 101 thru 132 define the upper case alpha                
200800* characters in the ASCII Collating Sequence.                             
200900*                                                                         
201000* All escape sequences sent to HP teminals are terminated                 
201100* with an upper case alpha character.                                     
201200*                                                                         
201300     Perform Varying Esc-len from F-idx by 1                              
201400       until (Esc-len > F-xlen)                                           
201500          or (F-Design(Esc-len:1) >= %101 and                             
201600              F-Design(Esc-len:1) <= %132)                                
201700          or (F-Design(Esc-len:1) = "@" )                                 
201800          or (F-Design(Esc-len:1) = %15 AND                               
201900              F-Design(Esc-len + 1:1) = %12 )                             
202000      CONTINUE                                                            
202100     End-Perform.                                                         
202200     COMPUTE ESC-LEN = (ESC-LEN - F-IDX) + 1.                             
202300     MOVE F-Design(F-idx:Esc-len) TO PARSED-STRING.                       
202400     INSPECT PARSED-STRING REPLACING ALL %33 BY ".".                      
202500*    Display "ESCAPE-SEQ [" PARSED-STRING(1:Esc-len) "]".                 
202600     IF ESC-LEN = 4                                                       
202700      IF PARSED-STRING(2:2) = "&d"                                        
202800       PERFORM ADD-OBJ-ENHANCEMENT.                                       
202900                                                                          
203000*-----------------------------------------------------------              
203100 GET-Linedrawing.                                                         
203200D    Display "GET-Linedrawing".                                           
203300*                                                                         
203400* The octal value 16 begins the line drawing character set.               
203500* The octal value 17 ends the line drawing character set.                 
203600*    Add 1 To F-idx.                                                      
203700     INITIALIZE PARSED-STRING LD-LEN.                                     
203800     Perform Varying LD-IDX from F-idx by 1                               
203900       until (LD-IDX > F-xlen)                                            
204000          or (F-Design(LD-IDX:1) = %0 OR %12 OR %15 OR %17)               
204100                                                                          
204200      IF (F-DESIGN(LD-IDX:1) <> %0 OR %12 OR %15 OR %17) AND              
204300         (F-DESIGN(LD-IDX:1) >= " ")                                      
204400       ADD 1 TO LD-LEN                                                    
204500D      DISPLAY "F-Design( " LD-IDX " :1) [" F-Design(LD-IDX:1) "]"        
204600       MOVE F-Design(LD-IDX:1) TO PARSED-STRING(LD-LEN:1)                 
204700      END-IF                                                              
204800     End-Perform.                                                         
204900     If ld-len > 0 and ld-len < 128                                       
205000      INSPECT PARSED-STRING REPLACING ALL %16 BY "."                      
205100      INSPECT PARSED-STRING REPLACING ALL %17 BY "."                      
205200D     Display "Line Draw [" PARSED-STRING(1:ld-len) "]"                   
205300      PERFORM ADD-OBJ-LINEDRAW.                                           
205400                                                                          
205500*----------------------------------------------------------------         
205600 GET-T-RECORDS.                                                           
205700D    DISPLAY "GET-T-RECORDS".                                             
205800*                                                                         
205900* L O A D    "T"    R E C O R D S                                         
206000*                                                                         
206100     INITIALIZE T-RECORD.                                                 
206200     MOVE "0" TO VALID-T-SW.                                              
206300     Perform Varying Frdidx From 1 By 1                                   
206400       Until (VALID-T) OR ( Frdidx > Frdcnt )                             
206500      Move Frdstr(Frdidx)(1:2) To Ascii-Character                         
206600      If (Frdstr(Frdidx)(4:15) = Design-name(1:15))                       
206700          And (Frdstr(Frdidx)(3:1) = "T")                                 
206800          And ( Ascii-Value > 0 )                                         
206900       Compute T-STRT = ((Frdidx * 256) - 255 ) End-compute               
207000       Compute T-END  = T-STRT + (Ascii-Value - 1) End-Compute            
207100       Move Ascii-Value To T-LEN                                          
207200       Move frd-table(T-STRT:T-LEN) to T-ACTUAL-RECORD                    
207300       MOVE T-HEADER TO T-HEADER-FORMAT                                   
207400       IF (( THF-LENGTH = T-LEN)) AND                                     
207500          (((( THF-CNT1 * 62) + 40) = THF-LENGTH )                        
207600           OR ((( THF-CNT2 * 62) + 40) = THF-LENGTH ))                    
207700        MOVE "1" TO VALID-T-SW                                            
207800        PERFORM VARYING TIDX FROM 1 BY 1                                  
207900          UNTIL TIDX > THF-CNT1                                           
208000         MOVE T-FIELD(TIDX) TO T-FIELD-FORMAT                             
208100         ADD 1 TO TFF-ROW                                                 
208200         ADD 1 TO TFF-COL                                                 
208300         MOVE T-FIELD-FORMAT TO T-FIELD(TIDX)                             
208400         MOVE %0 TO ASCII-BYTE1                                           
208500         MOVE TFF-A TO ASCII-BYTE2                                        
208600         IF FMMSTR-FRM-NAME = "STDCOSTMAINT"                              
208700          DISPLAY TFF-FLD1 " " TFF-ENH " " TFF-ESCVAL " "                 
208800                  Ascii-Value " " TFF-FLDNUM " " TFF-SCRNODR              
208900                  " " TFF-LEN " " TFF-ROW " " TFF-COL                     
209000         END-IF                                                           
209100        END-PERFORM                                                       
209200       END-IF                                                             
209300      END-IF                                                              
209400     END-PERFORM.                                                         
209500*----------------------------------------------------------------         
209600 GET-D-RECORDS.                                                           
209700D    DISPLAY "GET-D-RECORDS".                                             
209800*                                                                         
209900* L O A D    "D"    R E C O R D S                                         
210000*                                                                         
210100     INITIALIZE SAVE-FLD-TABLE D-RECORD DIDX D-LEN D-STRT D-END.          
210200     MOVE "0" TO VALID-D-SW.                                              
210300*                                                                         
210400*                                                                         
210500     Perform Varying Frdidx From 1 By 1                                   
210600       Until ( Frdidx > Frdcnt )                                          
210700      Move Frdstr(Frdidx)(1:2) To Ascii-Character                         
210800      If (Frdstr(Frdidx)(3:1) = "D") AND (Ascii-Value > 0)                
210900       Compute D-STRT = ((Frdidx * 256) - 255 ) End-compute               
211000       Compute D-END  = D-STRT + (Ascii-Value - 1) End-Compute            
211100       Move Ascii-Value To D-LEN                                          
211200       ADD 1 TO DIDX                                                      
211300D      DISPLAY "Frdidx      =" Frdidx                                     
211400D      DISPLAY "D-STRT      =" D-STRT                                     
211500D      DISPLAY "D-END       =" D-END                                      
211600D      DISPLAY "Ascii-Value =" Ascii-Value                                
211700D      DISPLAY "D-LEN       =" D-LEN                                      
211800       Move frd-table(D-STRT:D-LEN) to D-RECORD-ENTRIES(DIDX)             
211900       MOVE D-HEADER(DIDX) TO D-HEADER-FORMAT                             
212000       IF DHF-LENGTH = 102                                                
212100        MOVE "1" TO VALID-D-SW                                            
212200        ADD 1 TO SFIDX                                                    
212300        MOVE D-FIELD(DIDX) TO D-FIELD-FORMAT                              
212400        INITIALIZE NUM1 NUM2 NUMDEC NUMERR                                
212500        MOVE DFF-LEN TO NUM1                                              
212600*       DISPLAY "DFF-LEN       =" DFF-LEN                                 
212700        CALL "NUMGET" USING NUM1 NUM2 NUMDEC NUMERR                       
212800        IF NUM2 > 0 AND NUM2 < 62                                         
212900         DISPLAY "S A V E    F I E L D:  "                                
213000           DFF-FLD1 " " DFF-LEN " " DFF-DTYPE                             
213100           " Init [" DFF-INIT(1:NUM2) "]"                                 
213200           ADD NUM2 TO SF-BUFLEN                                          
213300           MOVE DFF-FLD1         TO SF-FLD(SFIDX)                         
213400           MOVE NUM2             TO SF-LEN(SFIDX)                         
213500           MOVE DFF-DTYPE        TO SF-TYPE(SFIDX)                        
213600           MOVE DFF-INIT(1:NUM2) TO SF-INIT(SFIDX)                        
213700        ELSE                                                              
213800         DISPLAY "S A V E    F I E L D:  "                                
213900           DFF-FLD1 " " DFF-LEN " " DFF-DTYPE                             
214000           " Init []"                                                     
214100           MOVE DFF-FLD1      TO SF-FLD(SFIDX)                            
214200           MOVE 1             TO SF-LEN(SFIDX)                            
214300           MOVE DFF-DTYPE     TO SF-TYPE(SFIDX)                           
214400           MOVE SPACES        TO SF-INIT(SFIDX)                           
214500        END-IF                                                            
214600       END-IF                                                             
214700      END-IF                                                              
214800     END-PERFORM.                                                         
214900     MOVE SFIDX TO SFCNT.                                                 
215000*    IF SFCNT > 0                                                         
215100*     Move "$SAVE"             To FMMSTR-FRM-NAME                         
215200*     Move 0                   To FMMSTR-FRM-NUMBER                       
215300*     Move DIDX                To FMMSTR-FLDCNT                           
215400*     Move SF-BUFLEN           To FMMSTR-BUF-LEN                          
215500*     Move SPACES              To FMMSTR-NEXT-FRM                         
215600*     Move SPACES              To FMMSTR-REPEAT-OPT                       
215700*     Move SPACES              To FMMSTR-NFORM-OPT                        
215800*     PERFORM GET-NEXT-FMUNIQ                                             
215900*     Move SPACES              To FMMSTR-FKEY-DEF                         
216000*     Move SPACES              To FMMSTR-REPRODUCED-FR                    
216100*     Move "$SAVE, used to store save files"   To FMMSTR-COMMENT          
216200*     MOVE NXUNIQ-UNIQ-NUM     TO FMMSTR-FM-UNIQUE                        
216300*     MOVE FFMSTR-VFIL-UNIQUE  TO FMMSTR-VFIL-UNIQUE                      
216400*     MOVE 1                   TO FMMSTR-SVR-UNIQUE                       
216500*     PERFORM LOCK-FMMSTR                                                 
216600*     PERFORM PUT-FMMSTR                                                  
216700*     PERFORM UNLOCK-FMMSTR                                               
216800*     INITIALIZE FFFLDS-BUFFER                                            
216900*     PERFORM VARYING SFIDX FROM 1 BY 1                                   
217000*       UNTIL (IMAGE-ERRORS) OR (SFIDX > SFCNT)                           
217100*      MOVE FMMSTR-FM-UNIQUE    TO FFFLDS-FM-UNIQUE                       
217200*      MOVE FFMSTR-VFIL-UNIQUE  TO FFFLDS-VFIL-UNIQUE                     
217300*      MOVE 1                   TO FFFLDS-SVR-UNIQUE                      
217400*      Move SF-FLD(SFIDX)       To FFFLDS-VFLD-NAME                       
217500*      MOVE SF-LEN(SFIDX)       To FFFLDS-VFLD-LENGTH                     
217600*      MOVE SF-TYPE(SFIDX)      TO FFFLDS-VFLD-DATATYPE                   
217700*      MOVE SF-INIT(SFIDX)      To FFFLDS-VFLD-INITVAL                    
217800*      MOVE "SF"                TO FFFLDS-VFLD-TYPE                       
217900*      MOVE 20                  TO  FFFLDS-SRN-X                          
218000*      ADD 1                    TO  FFFLDS-SRN-Y                          
218100*      ADD 1                    TO  FFFLDS-SRN-ORD-NUM                    
218200*      ADD 1                    TO  FFFLDS-VFLD-NUM                       
218300*      MOVE "NONE"              TO FFFLDS-VFLD-ENHANCE                    
218400*      MOVE FFFLDS-VFLD-POSITION   TO FFFLDS-BUF-X                        
218500*      Compute                                                            
218600*      FFFLDS-BUF-Y = FFFLDS-BUF-X + (FFFLDS-VFLD-LENGTH - 1)             
218700*      END-COMPUTE                                                        
218800*      PERFORM GET-NEXT-FFFUNIQ                                           
218900*      MOVE NXUNIQ-UNIQ-NUM     TO FFFLDS-VFLD-UNIQUE                     
219000*      PERFORM LOCK-FFFLDS                                                
219100*      PERFORM PUT-FFFLDS                                                 
219200*      PERFORM UNLOCK-FFFLDS                                              
219300*     END-PERFORM.                                                        
219400*----------------------------------------------------------------         
219500 GET-G-RECORDS.                                                           
219600D    DISPLAY "GET-G-RECORDS".                                             
219700*                                                                         
219800* L O A D    "G"    R E C O R D S                                         
219900*                                                                         
220000     INITIALIZE G-DATA-STORAGE.                                           
220100     IF NOT GFILE-CLOSED PERFORM CLOSE-GFILE.                             
220200     PERFORM OPEN-GFILE-OUTPUT.                                           
220300     MOVE "0" TO VALID-G-SW.                                              
220400     Perform Varying Frdidx From 1 By 1                                   
220500       Until ( Frdidx > Frdcnt )                                          
220600      Move Frdstr(Frdidx)(1:2) To Ascii-Character                         
220700      If (Frdstr(Frdidx)(3:1) = "G")                                      
220800       Compute G-STRT = ((Frdidx * 256) - 255 ) End-compute               
220900       Compute G-END  = G-STRT + (Ascii-Value - 1) End-Compute            
221000       Move Ascii-Value To G-LEN                                          
221100       If G-Len > 0 and G-Len < 1540                                      
221200        ADD 1 TO GIDX                                                     
221300        Move frd-table(G-STRT:G-LEN) to G-RECORD                          
221400        MOVE G-HEADER TO G-HEADER-FORMAT                                  
221500*       IF GHF-LENGTH < 1536                                              
221600         MOVE "1" TO VALID-G-SW                                           
221700         MOVE G-FIELD TO G-FIELD-FORMAT                                   
221800         INITIALIZE NUM1 NUM2 NUMDEC NUMERR                               
221900         MOVE GFF-LEN TO NUM1                                             
222000         CALL "NUMGET" USING NUM1 NUM2 NUMDEC NUMERR                      
222100         IF NUM2 < 1                                                      
222200          MOVE 1 TO NUM2                                                  
222300         END-IF                                                           
222400         IF NUM2 > 62                                                     
222500          MOVE 62 TO NUM2                                                 
222600         END-IF                                                           
222700         PERFORM WRITE-GFILE                                              
222800         IF FMMSTR-FRM-NAME = "STDCOSTMAINT"                              
222900          DISPLAY FMMSTR-FRM-NAME "GDATA FIELD:  "                        
223000          GFF-FORM " " GFF-FIELD " " GFF-NUM GFF-LEN                      
223100          GFF-ENH " " GFF-FTYPE " " GFF-DTYPE                             
223200          " Init [" GFF-INIT(1:NUM2) "]"                                  
223300         END-IF                                                           
223400*       END-IF                                                            
223500       End-If                                                             
223600      END-IF                                                              
223700     END-PERFORM.                                                         
223800     MOVE GIDX TO GCNT.                                                   
223900*----------------------------------------------------                     
224000 CHKALL-G-STRINGS.                                                        
224100     IF FMMSTR-FRM-NAME = "STDCOSTMAINT"                                  
224200      DISPLAY "CHKALL-G-STRINGS".                                         
224300     MOVE "0" TO MATCH-SW.                                                
224400     IF NOT GFILE-CLOSED PERFORM CLOSE-GFILE.                             
224500     PERFORM OPEN-GFILE-INPUT.                                            
224600     PERFORM VARYING GIDX FROM 1 BY 1                                     
224700       UNTIL MATCH-FOUND OR GIDX > GCNT                                   
224800      PERFORM READ-GFILE                                                  
224900      IF NOT GFILE-EOF                                                    
225000       MOVE G-HEADER TO G-HEADER-FORMAT                                   
225100       MOVE G-FIELD  TO G-FIELD-FORMAT                                    
225200       INITIALIZE NUM1 NUM2 NUMDEC NUMERR                                 
225300       MOVE GFF-LEN TO NUM1                                               
225400       CALL "NUMGET" USING NUM1 NUM2 NUMDEC NUMERR                        
225500*       MOVE FUNCTION UPPER-CASE(FFFLDS-VFLD-NAME)                        
225600*         TO NEXT-STRING                                                  
225700*       MOVE FUNCTION UPPER-CASE(GFF-FIELD) TO PARSED-STRING              
225800*      IF  NEXT-STRING = PARSED-STRING        AND                         
225900       IF  FFFLDS-VFLD-NAME = GFF-FIELD   AND                             
226000           FFFLDS-VFLD-LENGTH  = NUM2     AND                             
226100           FFFLDS-VFLD-ENHANCE = GFF-ENH                                  
226200        MOVE "1" TO MATCH-SW                                              
226300         IF FMMSTR-FRM-NAME = "STDCOSTMAINT"                              
226400          DISPLAY "MATCH FOUND:  "                                        
226500            GFF-FORM " " GFF-FIELD " " GFF-NUM GFF-LEN                    
226600            GFF-ENH " " GFF-FTYPE " " GFF-DTYPE                           
226700         END-IF                                                           
226800       END-IF                                                             
226900      END-IF                                                              
227000     END-PERFORM.                                                         
227100*----------------------------------------------------------------         
227200 GET-E-RECORDS.                                                           
227300D    DISPLAY "GET-E-RECORDS".                                             
227400*                                                                         
227500* L O A D    "E"    R E C O R D S                                         
227600*                                                                         
227700     INITIALIZE E-RECORD.                                                 
227800     MOVE "0" TO VALID-G-SW.                                              
227900     Perform Varying Frdidx From 1 By 1                                   
228000       Until ( Frdidx > Frdcnt )                                          
228100      Move Frdstr(Frdidx)(1:2) To Ascii-Character                         
228200      If (Frdstr(Frdidx)(3:1) = "E")                                      
228300            And (Ascii-Value  > 113 and Ascii-Value < 150)                
228400       Compute E-STRT = ((Frdidx * 256) - 255 ) End-compute               
228500       Compute E-END  = E-STRT + (Ascii-Value - 1) End-Compute            
228600       Move Ascii-Value To E-LEN                                          
228700       ADD 1 TO EIDX                                                      
228800       Move frd-table(E-STRT:E-LEN) to E-RECORD-ENTRIES(EIDX)             
228900       If (E-FORM1(EIDX) <> E-FORM2(EIDX)) and                            
229000          (E-FORM2(EIDX)(1:1) <= " ")                                     
229100        Initialize E-RECORD-ENTRIES(EIDX)                                 
229200        Subtract 1 from Eidx                                              
229300       Else                                                               
229400        DISPLAY E-FORM1(EIDX)                                             
229500               E-REPEAT-OPTION(EIDX)                                      
229600               E-NFORM-OPTION(EIDX)                                       
229700               E-NFORM(EIDX)                                              
229800               E-FKEY-DEF(EIDX)                                           
229900               E-REPRODUCED-FR(EIDX)                                      
230000        DISPLAY E-COMMENTS(EIDX)                                          
230100        DISPLAY "FDEF: [" E-FTYPE(EIDX) "] [" E-DTYPE(EIDX) "]"           
230200       End-If                                                             
230300      END-IF                                                              
230400     END-PERFORM.                                                         
230500     MOVE EIDX TO ECNT.                                                   
230600$PAGE "MISC. ERROR CONDITION SUBROUTINES"                                 
230700 9001-FILE-ERROR.                                                         
230800D    DISPLAY "9001-FILE-ERROR".                                           
230900     MOVE SPACES TO FILE-ERROR-RECORD.                                    
231000     MOVE "00" TO ERROR-NUMBER.                                           
231100*     IF FNAME = "PRINTER" MOVE PRINTER-STATUS TO ERROR-NUMBER.           
231200     IF FNAME = "FORMFILE" MOVE FORMFILE-STATUS TO ERROR-NUMBER.          
231300     IF FNAME = "GFILE"    MOVE GFILE-STATUS TO ERROR-NUMBER.             
231400     EVALUATE ERROR-NUMBER                                                
231500     WHEN "00" MOVE "0" TO ERRORS-SW                                      
231600     WHEN "04" MOVE "1" TO ERRORS-SW                                      
231700               STRING "Read length of record  doesn't match "             
231800                      FNAME " length."                                    
231900                      DELIMITED BY SIZE INTO FILE-ERROR-RECORD            
232000     WHEN "05" MOVE "0" TO ERRORS-SW                                      
232100               STRING "OPEN " FNAME " not present,  created."             
232200                      DELIMITED BY SIZE INTO FILE-ERROR-RECORD            
232300     WHEN "07" MOVE "1" TO ERRORS-SW                                      
232400               STRING FNAME " is not a tape as the OPEN/CLOSE "           
232500                      "phrase implies."                                   
232600                      DELIMITED BY SIZE INTO FILE-ERROR-RECORD            
232700     WHEN "30" MOVE "1" TO ERRORS-SW                                      
232800               STRING FNAME " error.  problem unknown! "                  
232900                      DELIMITED BY SIZE INTO FILE-ERROR-RECORD            
233000     WHEN "34" MOVE "1" TO ERRORS-SW                                      
233100               STRING FNAME " boundary violation."                        
233200                      DELIMITED BY SIZE INTO FILE-ERROR-RECORD            
233300     WHEN "35" MOVE "1" TO ERRORS-SW                                      
233400               STRING FNAME " not found."                                 
233500                      DELIMITED BY SIZE INTO FILE-ERROR-RECORD            
233600     WHEN "37" MOVE "1" TO ERRORS-SW                                      
233700               STRING FNAME " error.  Inconsistent operation "            
233800                      "during file I/O !"                                 
233900                      DELIMITED BY SIZE INTO FILE-ERROR-RECORD            
234000     WHEN "39" MOVE "1" TO ERRORS-SW                                      
234100               STRING "OPEN " FNAME " failed due to fixed file"           
234200                      " attribute conflict."                              
234300                      DELIMITED BY SIZE INTO FILE-ERROR-RECORD            
234400     WHEN "41" MOVE "0" TO ERRORS-SW                                      
234500               STRING FNAME " was already opened."                        
234600                      DELIMITED BY SIZE INTO FILE-ERROR-RECORD            
234700     WHEN "42" MOVE "0" TO ERRORS-SW                                      
234800               STRING "CLOSE " FNAME " without openning first."           
234900                      DELIMITED BY SIZE INTO FILE-ERROR-RECORD            
235000     WHEN "44" MOVE "1" TO ERRORS-SW                                      
235100               STRING FNAME " error.   boundary violation, "              
235200                      " Record too big or record too small."              
235300                      DELIMITED BY SIZE INTO FILE-ERROR-RECORD            
235400     WHEN "46" MOVE "1" TO ERRORS-SW                                      
235500               STRING "READ " FNAME " after AT END  or   after"           
235600                      " unsuccessful READ."                               
235700                      DELIMITED BY SIZE INTO FILE-ERROR-RECORD            
235800     WHEN "47" MOVE "1" TO ERRORS-SW                                      
235900               STRING "READ on " FNAME " not open for INPUT."             
236000                      DELIMITED BY SIZE INTO FILE-ERROR-RECORD            
236100     WHEN "48" MOVE "1" TO ERRORS-SW                                      
236200               STRING "WRITE on " FNAME " not open for OUTPUT."           
236300                      DELIMITED BY SIZE INTO FILE-ERROR-RECORD            
236400     WHEN "49" MOVE "1" TO ERRORS-SW                                      
236500               STRING "REWRITE on " FNAME                                 
236600                      " not open for I-O."                                
236700                      DELIMITED BY SIZE INTO FILE-ERROR-RECORD            
236800     WHEN OTHER MOVE "1" TO ERRORS-SW                                     
236900                MOVE ERROR-NUMBER TO DECIMAL-VALUE                        
237000                STRING FNAME " ERROR #" ERROR-NUMBER                      
237100                             " MESSAGE UNDEFINED ."                       
237200                DELIMITED BY SIZE INTO FILE-ERROR-RECORD.                 
237300     MOVE ERROR-NUMBER TO ASCII-CHARACTER.                                
237400     IF ASCII-BYTE1 = "9"                                                 
237500        MOVE ASCII-BYTE2 TO Ascii-Value                                   
237600        MOVE Ascii-Value TO DISP-N                                        
237700        DISPLAY "MPE FILE ERROR #" DISP-N                                 
237800        MOVE "1" TO ERRORS-SW                                             
237900        MOVE SPACES TO FILE-ERROR-RECORD                                  
238000        CALL INTRINSIC "FERRMSG" USING                                    
238100            Ascii-Value FILE-ERROR-RECORD I.                              
238200     IF NOT ERRORS DISPLAY FILE-ERROR-RECORD                              
238300     ELSE GO TO 9900-ABEND.                                               
238400     MOVE FILE-ERROR-RECORD TO EDIT-MESSAGE.                              
238500     PERFORM 7805-LOG-EDIT-MESSAGE.                                       
238600*--------------------------                                               
238700 7805-LOG-EDIT-MESSAGE.                                                   
238800     DISPLAY EDIT-MESSAGE.                                                
238900*****************************************************************         
239000*---------------------------------------------------------------          
239100 9900-ABEND.                                                              
239200     DISPLAY "----------------------------------------".                  
239300     DISPLAY "-MIG801- ABNORMAL END OF PROGRAM".                          
239400     DISPLAY "----------------------------------------".                  
239500*---------------------------------------------------------------          
239600 9999-RETURN.                                                             
239700     Display " END OF PROGRAM "  WITH NO ADVANCING.                       
239800     MOVE "SHOWTIME" TO CMD.                                              
239900     PERFORM MPE-COMMAND.                                                 
240000     IF FILE-ERROR-RECORD NOT = SPACES DISPLAY FILE-ERROR-RECORD.         
240100     IF NOT FORMFILE-CLOSED  CLOSE FORMA-FILE.                            
240200     GOBACK.                                                              
240300*----------------------------------------------------------------         
240400 VGETINFO.                                                                
240500D    DISPLAY "VGETINFO".                                                  
240600     PERFORM DELETE-FORMDATA THRU DELETE-FORMDATA-EXIT.                   
240700     STRING  "Adding: " SCREEN-FORMS-FILE                                 
240800      DELIMITED BY SIZE INTO M.                                           
240900     PERFORM MSG-PROCESS.                                                 
241000     INITIALIZE SCREEN-COMAREA.                                           
241100     MOVE 60 TO SCREEN-COMAREALEN.                                        
241200     CALL "VOPENFORMF" USING SCREEN-COMAREA, SCREEN-FORMS-FILE.           
241300     IF  SCREEN-CSTATUS <> 0 PERFORM 9000-VPLUS-ERROR.                    
241400     MOVE SPACES TO FILE-INFOBUF.                                         
241500     MOVE 60 TO SCREEN-COMAREALEN.                                        
241600     MOVE 1 TO FILE-NUMBER-OF-ENTRIES.                                    
241700     MOVE 19 TO FILE-ENTRY-LENGTH.                                        
241800     INITIALIZE SCREEN-CSTATUS.                                           
241900     CALL "VGETFILEINFO" USING SCREEN-COMAREA FILE-INFOBUF                
242000                               FILE-INFOBUFLEN.                           
242100     MOVE in-FILE-VERSION(1) TO VTIMESTAMP.                               
242200     MOVE 0 TO CLOCK-DINT.                                                
242300     MOVE VTS-WORD2 TO CLK-WORD1.                                         
242400     CALL INTRINSIC "FMTDATE"   USING VTS-WORD1                           
242500                                      CLOCK-DINT                          
242600                                      MY-TIMESTAMP.                       
242700     Perform Store-File-Data.                                             
242800*    PERFORM NEW-XML-FILE.                                                
242900*    perform File-To-Xml.                                                 
243000     Perform CREATE-GLOBAL-PANEL.                                         
243100                                                                          
243200*---- Get form info -------*                                              
243300     MOVE SPACES TO FORM-INFOBUF.                                         
243400     MOVE FILE-NUMBER-OF-FORMS(1) TO FORM-NUMBER-OF-ENTRIES               
243500     MOVE 20                      TO FORM-ENTRY-LENGTH                    
243600     COMPUTE FORM-INFOBUFLEN =                                            
243700       2 + ( FORM-NUMBER-OF-ENTRIES * FORM-ENTRY-LENGTH)                  
243800       END-COMPUTE                                                        
243900     MOVE 1 TO FORM-FORM-NUMBER(1)                                        
244000     INITIALIZE SCREEN-CSTATUS                                            
244100     CALL "VGETFORMINFO" USING SCREEN-COMAREA FORM-INFOBUF                
244200                               FORM-INFOBUFLEN.                           
244300*/\/\/\/\/\/\ WORK-AROUND                                                 
244400*                                                                         
244500*   VPLUS VGETFORMINFO BUG THAT RETURNS BLANK FORM NAMES                  
244600                                                                          
244700     MOVE FILE-NUMBER-OF-FORMS(1) TO ACTUAL-FORM-COUNT.                   
244800     PERFORM VARYING FRMIDX FROM 1 BY 1                                   
244900       UNTIL (FRMIDX > FILE-NUMBER-OF-FORMS(1))                           
245000      IF FORM-FORM-NAME(FRMIDX) = SPACES                                  
245100       MOVE "!@#$%^&*()_+" TO FORM-FORM-NAME(FRMIDX)                      
245200       SUBTRACT 1  FROM ACTUAL-FORM-COUNT                                 
245300      END-IF                                                              
245400     END-PERFORM                                                          
245500*                                                                         
245600      DISPLAY "FORMSFILE: " SCREEN-FORMS-FILE                             
245700                                                                          
245800*\/\/\/\/\/\/ END WORK-AROUND                                             
245900     PERFORM VARYING FRMIDX FROM 1 BY 1                                   
246000       UNTIL (FRMIDX > FILE-NUMBER-OF-FORMS(1))                           
246100D     DISPLAY "PROCESSING NEXT FORM IN " SCREEN-FORMS-FILE                
246200D     DISPLAY "FORM NUMBER " FRMIDX                                       
246300      IF FORM-FORM-NAME(FRMIDX) <> "!@#$%^&*()_+"                         
246400D      DISPLAY "PROCESSING FORM: " FORM-FORM-NAME                         
246500       PERFORM Store-Form-Data                                            
246600       MOVE SPACES TO FIELD-INFOBUF                                       
246700       MOVE FORM-NUMBER-OF-FIELDS(FRMIDX)                                 
246800         TO FIELD-NUMBER-OF-ENTRIES                                       
246900       MOVE 14 TO FIELD-ENTRY-LENGTH                                      
247000       DISPLAY "   PROCESSING FIELDS IN "                                 
247100               FORM-FORM-NAME(FRMIDX)                                     
247200       COMPUTE FIELD-INFOBUFLEN =                                         
247300        10 + ( FIELD-NUMBER-OF-ENTRIES * FIELD-ENTRY-LENGTH)              
247400        END-COMPUTE                                                       
247500       MOVE FORM-FORM-NAME(FRMIDX) TO FIELD-FORM-NAME                     
247600       INITIALIZE SCREEN-CSTATUS                                          
247700D      DISPLAY "229.41 CALLING VGETFIELDINFO"                             
247800       CALL "VGETFIELDINFO" USING SCREEN-COMAREA,                         
247900                          FIELD-INFOBUF, FIELD-INFOBUFLEN                 
248000       MOVE FORM-FORM-NAME(FRMIDX) TO SCREEN-NFNAME SCREEN-NAME           
248100D      DISPLAY "           Form: ["                                       
248200D              FORM-FORM-NAME(FRMIDX) "]"                                 
248300       PERFORM Store-Field-Data                                           
248400       ADD FORM-NUMBER-OF-FIELDS(FRMIDX) TO TOTAL-FIELDS                  
248500D      DISPLAY "ROWCNT: " ROWCNT                                          
248600       PERFORM VARYING IROW FROM 1 BY 1                                   
248700         UNTIL ( IROW > ROWCNT )                                          
248800D       DISPLAY "OBJCNT(IROW): " OBJCNT(IROW)                             
248900        PERFORM VARYING XCOL FROM 1 BY 1                                  
249000          UNTIL ( XCOL > OBJCNT(IROW) )                                   
249100D        DISPLAY "NEXT NON DATA FIELD"                                    
249200D        DISPLAY "IROW " IROW                                             
249300D        DISPLAY "XCOL " XCOL                                             
249400         If (OBJ-TYPE(IROW,XCOL) <> "DA")                                 
249500          If FMMSTR-FRM-NAME = "STDCOSTMAINT"                             
249600           DISPLAY "VGETINFO"                                             
249700           DISPLAY OBJ-TYPE(IROW,XCOL) " " OBJ-NAME(IROW,XCOL) " "        
249800                  OBJ-SRNORD(IROW,XCOL) " " OBJ-STRTROW(IROW,XCOL)        
249900                   " " OBJ-STRTCOL(IROW,XCOL)                             
250000          END-IF                                                          
250100          Initialize FFFLDS-BUFFER                                        
250200          Move OBJ-NAME(Irow,Xcol)    To FFFLDS-VFLD-NAME                 
250300          Move 0                      To FFFLDS-BUF-X                     
250400          Move 0                      To FFFLDS-BUF-Y                     
250500          Move OBJ-STRTCOL(Irow,Xcol) To FFFLDS-SRN-X                     
250600          IF FFFLDS-SRN-X < 1                                             
250700           MOVE 1 TO FFFLDS-SRN-X                                         
250800          END-IF                                                          
250900          Move OBJ-STRTROW(Irow,Xcol) To FFFLDS-SRN-Y                     
251000          IF FFFLDS-SRN-Y < 1                                             
251100           MOVE 1 TO FFFLDS-SRN-Y                                         
251200          END-IF                                                          
251300          Move OBJ-SRNORD(Irow,Xcol)  To FFFLDS-SRN-ORD-NUM               
251400          Move 0                      To FFFLDS-VFLD-NUM                  
251500          Move OBJ-LEN(Irow,Xcol)     To FFFLDS-VFLD-LENGTH               
251600          Move 0                      To FFFLDS-VFLD-POSITION             
251700          Move OBJ-Enh(Irow,Xcol)     To FFFLDS-VFLD-ENHANCE              
251800          Move OBJ-TYPE(IROW,XCOL)    To FFFLDS-VFLD-TYPE                 
251900          Move "CHAR"                 To FFFLDS-VFLD-DATATYPE             
252000          if OBJ-LEN(Irow,Xcol) > 80                                      
252100           Move 80 To OBJ-LEN(Irow,Xcol)                                  
252200          End-IF                                                          
252300          IF OBJ-LEN(Irow,Xcol) > 0                                       
252400           Move OBJ-VALUE(Irow,Xcol)(1:OBJ-LEN(Irow,Xcol))                
252500                                      To FFFLDS-VFLD-INITVAL              
252600          END-IF                                                          
252700D         DISPLAY "ADDING NON DATA FIELD " FFFLDS-VFLD-NAME               
252800          perform add-field                                               
252900*         Perform Field-To-Xml                                            
253000D         DISPLAY "BACK FGROM ADDING NON DATA FIELD"                      
253100         End-If                                                           
253200        END-PERFORM                                                       
253300       END-PERFORM                                                        
253400*       Subtract 1 From XmlLevel                                          
253500*       Move "</Form>" to XML-data                                        
253600*      Perform Write-Xml                                                  
253700      END-IF                                                              
253800     END-PERFORM.                                                         
253900D    DISPLAY "LEAVING VGETINFO".                                          
254000     ADD ACTUAL-FORM-COUNT TO TOTAL-FORMS.                                
254100     CALL "VCLOSEFORMF" USING SCREEN-COMAREA.                             
254200*---------------------------------------------------------                
254300*---------------------------------------------------------                
254400 9000-VPLUS-ERROR.                                                        
254500D    DISPLAY "9000-VPLUS-ERROR" SCREEN-CSTATUS.                           
254600     INITIALIZE SCRIPT-STR CSTR CERR CPARM.                               
254700     MOVE 80 TO CPARM.                                                    
254800     CALL "VERRMSG" USING SCREEN-COMAREA ERROR-MSG CPARM CERR.            
254900     INITIALIZE SCREEN-CSTATUS.                                           
255000     MOVE SCREEN-FORMS-FILE TO SCRIPT-STR.                                
255100     MOVE ERROR-MSG(1:CERR) TO SCRIPT-STR(30:80).                         
255200     MOVE CALLTYPE TO SCRIPT-STR(111:20).                                 
255300     WRITE Script-File.                                                   
255400     INITIALIZE CALLTYPE SCRIPT-STR CSTR CERR CPARM.                      
255500*-------------------------------------------------------------            
255600 Store-File-Data.                                                         
255700D    Display "Store-File-Data".                                           
255800     Initialize ffmstr-buffer.                                            
255900     PERFORM Load-Form-Source.                                            
256000     MOVE SCREEN-FORMS-FILE        TO FFMSTR-VFIL-NAME.                   
256100     Compute FFMSTR-VFIL-BYTES =  frdcnt * 256.                           
256200     MOVE IN-FILE-VERSION(1)       TO FFMSTR-VERSION.                     
256300     MOVE FILE-NUMBER-OF-FORMS(1)  TO FFMSTR-NBR-OF-FORMS.                
256400     MOVE FILE-MAX-FIELDS(1)       TO FFMSTR-MAX-FLDS.                    
256500     MOVE FILE-MAX-BUFSIZE(1)      TO FFMSTR-MAX-BUF.                     
256600     MOVE FILE-SAVE-FIELDS(1)      TO FFMSTR-SAVE-FLDS.                   
256700     MOVE FILE-HEAD-FORM(1)        TO FFMSTR-HEAD-FRM.                    
256800     MOVE MY-FLD-ENH               TO FFMSTR-DEF-ENH.                     
256900     MOVE "CHAR"                   TO FFMSTR-DEF-TYPE.                    
257000     MOVE FILE-ERROR-ENHANCE(1)    TO FFMSTR-ERR-ENH.                     
257100     MOVE FILE-WINDOW-ENHANCE(1)   TO FFMSTR-WIN-ENH.                     
257200     MOVE FILE-WINDOW-POSITION(1)  TO FFMSTR-WIN-POS.                     
257300     PERFORM GET-NEXT-FFUNIQ                                              
257400     MOVE NXUNIQ-UNIQ-NUM  TO FFMSTR-VFIL-UNIQUE.                         
257500     MOVE 1                TO FFMSTR-SVR-UNIQUE.                          
257600     PERFORM LOCK-FFMSTR.                                                 
257700     PERFORM PUT-FFMSTR.                                                  
257800     PERFORM UNLOCK-FFMSTR.                                               
257900     ADD 1 TO MY-NEW-FILCNT.                                              
258000     If FILE-SAVE-FIELDS(1) > 0 PERFORM GET-D-RECORDS.                    
258100     PERFORM GET-E-RECORDS.                                               
258200     PERFORM GET-G-RECORDS.                                               
258300D     Display "VERSION         : " IN-FILE-VERSION(1).                    
258400D     Display "NUMBER-OF-FORMS : " FILE-NUMBER-OF-FORMS(1).               
258500D     Display "MAX-FIELDS      : " FILE-MAX-FIELDS(1).                    
258600D     Display "MAX-BUFSIZE     : " FILE-MAX-BUFSIZE(1).                   
258700D     Display "SAVE-FIELDS     : " FILE-SAVE-FIELDS(1).                   
258800D     Display "HEAD-FORM       : " FILE-HEAD-FORM(1).                     
258900D     Display "FILLER          : " FILE-FILLER(1).                        
259000D     Display "ERROR-ENHANCE   : " FILE-ERROR-ENHANCE(1).                 
259100D     Display "WINDOW-ENHANCE  : " FILE-WINDOW-ENHANCE(1).                
259200D     Display "WINDOW-POSITION : " FILE-WINDOW-POSITION(1).               
259300D     display  "Compiled       : " MY-TIMESTAMP.                          
259400     Display FFMSTR-VFIL-NAME  "Compiled       : " MY-TIMESTAMP.          
259500*--------------------------------------------------------------           
259600 Store-Form-Data.                                                         
259700D    Display "Store-Form-Data".                                           
259800     Move FORM-FORM-NAME(FrmIdx)        To FMMSTR-FRM-NAME                
259900                                           SCREEN-NAME.                   
260000     Move FORM-FORM-NUMBER(FrmIdx)      To FMMSTR-FRM-NUMBER.             
260100     Move FORM-NUMBER-OF-FIELDS(FrmIdx) To FMMSTR-FLDCNT.                 
260200     Move FORM-BUF-LENGTH(FrmIdx)       To FMMSTR-BUF-LEN.                
260300     Move FORM-NEXT-FORM(FrmIdx)        To FMMSTR-NEXT-FRM.               
260400     Move FORM-REPEAT-OPTION(FrmIdx)    To FMMSTR-REPEAT-OPT.             
260500     Move FORM-NFORM-OPTION(FrmIdx)     To FMMSTR-NFORM-OPT.              
260600     MOVE 15 TO S1.                                                       
260700     Perform varying S1 from 16 by -1                                     
260800       until S1 < 2 or FMMSTR-FRM-NAME(S1:1) > " "                        
260900      Continue                                                            
261000     End-Perform.                                                         
261100     Initialize Design-Area.                                              
261200     Move FMMSTR-FRM-NAME to Design-Name.                                 
261300     Move "0" To E-Record-Found-Sw.                                       
261400     Perform Varying eidx From 1 By 1                                     
261500       Until ( eidx > ecnt )                                              
261600      If   ((E-FORM1(eidx)(1:S1)   = FMMSTR-FRM-NAME(1:S1))               
261700        And (E-REPEAT-OPTION(eidx) = FMMSTR-REPEAT-OPT)                   
261800        And (E-NFORM-OPTION(eidx)  = FMMSTR-NFORM-OPT)                    
261900        And (E-NFORM(eidx)         = FMMSTR-NEXT-FRM))                    
262000       MOVE FMMSTR-BUFFER TO FMMSAV-BUFFER                                
262100       PERFORM GET-NEXT-FMUNIQ                                            
262200       IF NOT FMMSTR-FOUND                                                
262300        MOVE FMMSAV-BUFFER TO FMMSTR-BUFFER                               
262400        Move E-FKEY-DEF(eidx)       To FMMSTR-FKEY-DEF                    
262500        Move E-REPRODUCED-FR(eidx)  To FMMSTR-REPRODUCED-FR               
262600        Move E-COMMENTS(eidx)       To FMMSTR-COMMENT                     
262700* New field defaults go here.                                             
262800        MOVE E-FTYPE(eidx)          TO FMMSTR-DEFAULT-FTYPE               
262900        MOVE E-DTYPE(eidx)          TO FMMSTR-DEFAULT-DTYPE               
263000        Move "1" To E-Record-Found-Sw                                     
263100        Add 1 to My-New-FRMCNT                                            
263200        MOVE NXUNIQ-UNIQ-NUM    TO FMMSTR-FM-UNIQUE                       
263300        MOVE FFMSTR-VFIL-UNIQUE TO FMMSTR-VFIL-UNIQUE                     
263400        MOVE 1                  TO FMMSTR-SVR-UNIQUE                      
263500*       Perform Form-To-Xml                                               
263600        PERFORM LOCK-FMMSTR                                               
263700        PERFORM PUT-FMMSTR                                                
263800        PERFORM UNLOCK-FMMSTR                                             
263900       END-IF                                                             
264000      End-If                                                              
264100     End-Perform.                                                         
264200     If E-Record-Found                                                    
264300      Perform Link-VF-Pointers                                            
264400      IF POINTERS-LINKED                                                  
264500D      DISPLAY "VF LINKED ok"                                             
264600D      ACCEPT NUM1                                                        
264700       PERFORM GET-T-RECORDS                                              
264800       PERFORM GET-SCREEN-OBJECTS                                         
264900      ELSE                                                                
265000       Display "Unable to find form design records!  "                    
265100               "V= " V-DESIGN-LEN ", F= " F-DESIGN-LEN                    
265200               "Form: " Design-name                                       
265300      End-if                                                              
265400     Else                                                                 
265500      Display "NO E-Record for Form: " Design-name.                       
265600*----------------------------------------------------------------         
265700 Store-Field-Data.                                                        
265800    IF FMMSTR-FRM-NAME = "STDCOSTMAINT"                                   
265900     Display "Store-Field-Data".                                          
266000     INITIALIZE FFFLDS-BUFFER FLDIDX THISFORM-FLDCNT.                     
266100*    DISPLAY REPORT-HEADER                                                
266200     PERFORM LOAD-G-SCREEN.                                               
266300     Perform Varying Fx From 1 By 1 Until Fx > FMMSTR-FLDCNT              
266400      INITIALIZE FFFLDS-BUFFER                                            
266500      Move FIELD-FIELD-NAME(Fx)     To FFFLDS-VFLD-NAME                   
266600        IF FMMSTR-FRM-NAME = "STDCOSTMAINT"                               
266700         DISPLAY "Store-fd FFFLDS-VFLD-NAME ["                            
266800          FFFLDS-VFLD-NAME "]"                                            
266900        END-IF                                                            
267000      Move FIELD-SCREEN-ORD-NUM(Fx) To FFFLDS-SRN-ORD-NUM                 
267100      Move FIELD-NUM(Fx)            To FFFLDS-VFLD-NUM                    
267200      Move FIELD-LENGTH(Fx)         To FFFLDS-VFLD-LENGTH                 
267300      Move FIELD-POSITION(Fx)       To FFFLDS-VFLD-POSITION               
267400      Move FIELD-ENHANCE(Fx)        To FFFLDS-VFLD-ENHANCE                
267500      INITIALIZE IROW XCOL                                                
267600      PERFORM VARYING IROW FROM 1 BY 1                                    
267700        UNTIL ( IROW > ROWCNT )                                           
267800       COMPUTE ZCOL = OBJCNT(IROW) + 1 END-COMPUTE                        
267900       PERFORM VARYING XCOL FROM 1 BY 1                                   
268000         UNTIL ( XCOL > OBJCNT(IROW) )                                    
268100*        IF FMMSTR-FRM-NAME = "STDCOSTMAINT"                              
268200*         DISPLAY "*** Consider adding field ***"                         
268300*         DISPLAY "FFFLDS-VFLD-NAME     [ " FFFLDS-VFLD-NAME              
268400*         DISPLAY "FFFLDS-SRN-ORD-NUM   [ " FFFLDS-SRN-ORD-NUM            
268500*         DISPLAY "FFFLDS-VFLD-NUM      [ " FFFLDS-VFLD-NUM               
268600*         DISPLAY "OBJ-TYPE(IROW,XCOL)  [ " OBJ-TYPE(IROW,XCOL)           
268700*         DISPLAY "OBJ-SRNORD(Irow,Xcol)[ " OBJ-SRNORD(Irow,Xcol)         
268800*         DISPLAY "*****************************"                         
268900*         DISPLAY " "                                                     
269000*        END-IF                                                           
269100        If (OBJ-TYPE(IROW,XCOL) = "DA") And                               
269200        (OBJ-SRNORD(Irow,Xcol) = FFFLDS-SRN-ORD-NUM)                      
269300         PERFORM GET-FIELD-DATA                                           
269400        End-If                                                            
269500       END-PERFORM                                                        
269600      END-PERFORM                                                         
269700     End-Perform.                                                         
269800*-----------------------------------------------------------              
269900 Extract-Labels.                                                          
270000d    Display "Extract-Labels".                                            
270100     Initialize btnrow-data.                                              
270200     Perform varying brwidx from 1 by 1                                   
270300       Until brwcnt >= 8 or brwidx > 256                                  
270400      If  Next-String(brwidx:1) = %33                                     
270500       Add 1 to Brwidx                                                    
270600       If Next-String(brwidx:1) = "&"                                     
270700        Add 1 to Brwidx                                                   
270800        If Next-String(brwidx:1) = "d"                                    
270900         Add 1 to Brwidx                                                  
271000         If Next-String(brwidx:1) = "J" or "B"                            
271100          Compute nxkey-x = brwidx + 1 End-Compute                        
271200          Move Next-String(nxkey-x:16) to NxLbl                           
271300          Initialize nxchr-cnt Next-Label                                 
271400          Perform Varying nxkey-y from 1 by 1                             
271500            until nxkey-y > 30 or nxchr-cnt >= 8                          
271600           if (NxLbl(nxkey-y:1) = %33 And                                 
271700               NxLbl(nxkey-y + 1:1) = "[")                                
271800           or (NxLbl(nxkey-y:1) = %33 And                                 
271900               NxLbl(nxkey-y + 1:1) = "]")                                
272000            Display "Painted FK Lbls are supported; "                     
272100                    "Data fields imbedded into them is not!"              
272200            Add 2 to nxkey-y                                              
272300            If (NxLbl(nxkey-y:1) = %33 And                                
272400                NxLbl(nxkey-y + 1:1) = "&" And                            
272500                NxLbl(nxkey-y + 2:1) = "d")                               
272600            Display "Painted FK Lbls are supported; "                     
272700                    "Esc Seq's imbedded into them is not!"                
272800             Add 4 TO nxkey-y                                             
272900            End-If                                                        
273000           Else                                                           
273100            Add 1 To nxchr-cnt                                            
273200            Move NxLbl(nxkey-y:1) To Next-Label(nxchr-cnt:1)              
273300           End-If                                                         
273400          End-Perform                                                     
273500          Add 1 to brwcnt                                                 
273600          Move Next-Label To btn(brwcnt)                                  
273700D         Display "                    [" btn(brwcnt) " ]"                
273800         End-If                                                           
273900        End-If                                                            
274000       End-If                                                             
274100      End-If                                                              
274200     End-Perform.                                                         
274300     IF ALL-8-LABELS <= SPACES Initialize btnrow-data.                    
274400*---------------------------------------------------------------          
274500 Add-ProcSpecs.                                                           
274600D    Display "Add-ProcSpecs".                                             
274700*    PERFORM LOCK-PRSPEC.                                                 
274800     Initialize chrcnt chridx PRSPEC-BUFFER SPECTABLE.                    
274900     Move "0" To end-of-specs-sw.                                         
275000     Perform Varying chridx from 1 by 1                                   
275100      Until end-of-specs OR CHRIDX > SPECLEN                              
275200       If (GFF-PROCSPECS(chridx:1) = %15 or                               
275300           GFF-PROCSPECS(chridx:1) = %12 or                               
275400           CHRCNT > 79)  and  chrcnt > 0                                  
275500        Add 1 To PRSPEC-PRSPEC-SEQ                                        
275600        If PRSPEC-PRSPEC-TEXT(1:chrcnt) > Spaces                          
275700D        display PRSPEC-PRSPEC-SEQ " "                                    
275800D                PRSPEC-PRSPEC-TEXT(1:chrcnt)                             
275900         MOVE PRSPEC-PRSPEC-TEXT TO SPEC(PRSPEC-PRSPEC-SEQ)               
276000         MOVE FFFLDS-VFLD-UNIQUE TO PRSPEC-VFLD-UNIQUE                    
276100*        PERFORM PUT-PRSPEC                                               
276200*        Add 1 to MY-NEW-spcCNT                                           
276300        End-If                                                            
276400        Initialize chrcnt PRSPEC-PRSPEC-TEXT                              
276500       End-If                                                             
276600       IF GFF-PROCSPECS(chridx:1) >= space                                
276700        Add 1 To chrcnt                                                   
276800        Move GFF-PROCSPECS(chridx:1)                                      
276900          to PRSPEC-PRSPEC-TEXT(chrcnt:1)                                 
277000       End-If                                                             
277100       If chridx >= speclen                                               
277200        Move "1" To end-of-specs-sw                                       
277300        If  chrcnt > 0                                                    
277400         Add 1 To PRSPEC-PRSPEC-SEQ                                       
277500         If PRSPEC-PRSPEC-TEXT(1:chrcnt) > Spaces                         
277600D         display PRSPEC-PRSPEC-SEQ " "                                   
277700D                 PRSPEC-PRSPEC-TEXT(1:chrcnt)                            
277800          MOVE FFFLDS-VFLD-UNIQUE TO PRSPEC-VFLD-UNIQUE                   
277900          MOVE PRSPEC-PRSPEC-TEXT TO SPEC(PRSPEC-PRSPEC-SEQ)              
278000*         PERFORM PUT-PRSPEC                                              
278100*         Add 1 to MY-NEW-spcCNT                                          
278200         End-If                                                           
278300         Initialize chrcnt PRSPEC-PRSPEC-TEXT                             
278400        End-IF                                                            
278500       End-if                                                             
278600     End-Perform.                                                         
278700*    PERFORM UNLOCK-PRSPEC.                                               
278800     PERFORM LOCK-FFFLDS.                                                 
278900     IF PRSPEC-PRSPEC-SEQ > 0                                             
279000      MOVE "VFLD-UNIQUE;" TO SEARCH-ITEM                                  
279100      MOVE FFFLDS-VFLD-UNIQUE TO SEARCH-KEY-I2                            
279200      PERFORM FIND-FFFLDS                                                 
279300      IF NOT NO-ENTRY                                                     
279400       PERFORM GET-FFFLDS-CHAINED                                         
279500       IF NOT END-OF-CHAIN                                                
279600        INITIALIZE FFFLDS-SPECS                                           
279700        PERFORM VARYING CHRCNT FROM 1 BY 1                                
279800          UNTIL CHRCNT > 15                                               
279900         MOVE SPEC(CHRCNT) TO FFFLDS-PROCSPECS(CHRCNT)                    
280000        END-PERFORM                                                       
280100        PERFORM UPDATE-FFFLDS.                                            
280200*     INITIALIZE FFFLDS-SPECS.                                            
280300      PERFORM UNLOCK-FFFLDS.                                              
280400*                                                                         
280500*----------------------------------------------------------------         
280600 add-field.                                                               
280700     IF FMMSTR-FRM-NAME = "STDCOSTMAINT"                                  
280800      DISPLAY "ADD-FIELD".                                                
280900     Add 1 To My-New-fldcnt.                                              
281000     Initialize REPORT-BUFFER.                                            
281100                                                                          
281200     MOVE  FFFLDS-VFLD-NAME         TO RPT-VFLD-NAME.                     
281300     MOVE  FFFLDS-BUF-X             TO RPT-BUF-X.                         
281400     MOVE  FFFLDS-BUF-Y             TO RPT-BUF-Y.                         
281500     MOVE  FFFLDS-SRN-X             TO RPT-SRN-X.                         
281600     MOVE  FFFLDS-SRN-Y             TO RPT-SRN-Y.                         
281700     MOVE  FFFLDS-SRN-ORD-NUM       TO RPT-SRN-ORD-NUM.                   
281800     MOVE  FFFLDS-VFLD-NUM          TO RPT-VFLD-NUM.                      
281900     MOVE  FFFLDS-VFLD-LENGTH       TO RPT-VFLD-LENGTH.                   
282000     MOVE  FFFLDS-VFLD-POSITION     TO RPT-VFLD-POSITION.                 
282100     MOVE  FFFLDS-VFLD-ENHANCE      TO RPT-VFLD-ENHANCE.                  
282200     Move  FFFLDS-VFLD-TYPE         TO RPT-VFLD-TYPE.                     
282300     Move  FFFLDS-VFLD-DATATYPE     TO RPT-VFLD-DATATYPE.                 
282400     If FMMSTR-FRM-NAME = "STDCOSTMAINT"                                  
282500      DISPLAY REPORT-BUFFER.                                              
282600     PERFORM GET-NEXT-FFFUNIQ.                                            
282700     MOVE FMMSTR-FM-UNIQUE   TO FFFLDS-FM-UNIQUE.                         
282800     MOVE NXUNIQ-UNIQ-NUM    TO FFFLDS-VFLD-UNIQUE.                       
282900     MOVE FFMSTR-VFIL-UNIQUE TO FFFLDS-VFIL-UNIQUE.                       
283000     MOVE 1                  TO FFFLDS-SVR-UNIQUE.                        
283100     PERFORM LOCK-FFFLDS.                                                 
283200     PERFORM PUT-FFFLDS.                                                  
283300     PERFORM UNLOCK-FFFLDS.                                               
283400*                                                                         
283500D    DISPLAY FFMSTR-VFIL-NAME FMMSTR-FRM-NAME RPT-VFLD-NAME %15           
283600D      WITH NO ADVANCING.                                                 
283700D    If FFFLDS-VFLD-LENGTH > 0 and                                        
283800D       FFFLDS-VFLD-LENGTH < 81                                           
283900D    display "init: ["                                                    
284000D     FFFLDS-VFLD-INITVAL(1:FFFLDS-VFLD-LENGTH) "]".                      
284100*-----------------------------------------------------------------        
284200 LOAD-G-SCREEN.                                                           
284300     IF FMMSTR-FRM-NAME = "STDCOSTMAINT"                                  
284400      DISPLAY "LOAD-G-SCREEN".                                            
284500D    Display "FMMSTR-FRM-NAME [" FMMSTR-FRM-NAME "]"                      
284600     IF NOT GFILE-CLOSED PERFORM CLOSE-GFILE.                             
284700     PERFORM OPEN-GFILE-INPUT.                                            
284800     MOVE "0" TO VALID-G-SW.                                              
284900     INITIALIZE G-SCREEN-ARRAY GSIDX GSCNT.                               
285000D     DISPLAY "GFILE COUNT: " GFILE-COUNT.                                
285100     Perform Varying GSIDX From 1 By 1                                    
285200       Until ( GSIDX > GFILE-COUNT )                                      
285300          OR ( GSCNT > 259 )                                              
285400      PERFORM READ-GFILE                                                  
285500      IF NOT GFILE-EOF                                                    
285600       MOVE G-FIELD TO G-FIELD-FORMAT                                     
285700       Move G-HEADER to G-HEADER-FORMAT                                   
285800       If (GFF-FORM = FMMSTR-FRM-NAME)                                    
285900        ADD 1 TO GSCNT                                                    
286000        MOVE G-FIELD TO GS-FIELD(GSCNT)                                   
286100        IF FMMSTR-FRM-NAME = "STDCOSTMAINT"                               
286200         DISPLAY "LOAD-G-SCREEN: (" GSCNT ")"                             
286300                 GFF-FORM GFF-FIELD GFF-NUM " " GFF-FTYPE                 
286400        END-IF                                                            
286500        MOVE G-HEADER TO GS-HEADER(GSCNT)                                 
286600       End-If                                                             
286700      End-If                                                              
286800     End-Perform.                                                         
286900D     DISPLAY "LOADED G-SCREEN REC: " GSCNT.                              
287000*----------------------------------------------------------------         
287100 GET-NEXT-FFUNIQ.                                                         
287200     MOVE "FFMSTR" TO SEARCH-KEY.                                         
287300     MOVE 20 TO MYINCREMENT.                                              
287400     PERFORM  LOCK-NXUNIQ.                                                
287500     PERFORM GET-NXUNIQ-KEYED.                                            
287600     IF NO-ENTRY                                                          
287700      MOVE "FFMSTR" TO NXUNIQ-UNIQ-ID                                     
287800      MOVE MYINCREMENT TO NXUNIQ-UNIQ-NUM                                 
287900      PERFORM PUT-NXUNIQ                                                  
288000     ELSE                                                                 
288100      ADD MYINCREMENT TO NXUNIQ-UNIQ-NUM                                  
288200      PERFORM UPDATE-NXUNIQ.                                              
288300     PERFORM UNLOCK-NXUNIQ.                                               
288400*----------------------------------------------------------------         
288500 GET-NEXT-FMUNIQ.                                                         
288600D    DISPLAY "GET-NEXT-FMUNIQ".                                           
288700     MOVE "0" TO FMMSTR-SW.                                               
288800     MOVE "FRM-NAME" TO SEARCH-ITEM.                                      
288900     MOVE FMMSTR-FRM-NAME to SEARCH-KEY.                                  
289000     PERFORM FIND-FMMSTR.                                                 
289100     IF NO-ENTRY                                                          
289200      PERFORM ACTUAL-NEXT-FMUNIQ                                          
289300     else                                                                 
289400      PERFORM VARYING NEXIDX FROM 1 BY 1                                  
289500        UNTIL ( END-OF-CHAIN )                                            
289600           OR ( FMMSTR-VFIL-UNIQUE = FFMSTR-VFIL-UNIQUE )                 
289700       PERFORM GET-FMMSTR-CHAINED                                         
289800       IF NOT END-OF-CHAIN                                                
289900        IF ( FMMSTR-VFIL-UNIQUE = FFMSTR-VFIL-UNIQUE )                    
290000         MOVE FMMSTR-FM-UNIQUE TO NXUNIQ-UNIQ-NUM                         
290100         MOVE "1" TO FMMSTR-SW                                            
290200        END-IF                                                            
290300       END-IF                                                             
290400      END-PERFORM                                                         
290500      IF END-OF-CHAIN                                                     
290600       PERFORM ACTUAL-NEXT-FMUNIQ                                         
290700      END-IF.                                                             
290800*---------------------------------------------------------------          
290900 ACTUAL-NEXT-FMUNIQ.                                                      
291000D    DISPLAY "ACTUAL-NEXT-FMUNIQ".                                        
291100     PERFORM  LOCK-NXUNIQ.                                                
291200     MOVE "FMMSTR" TO SEARCH-KEY                                          
291300     MOVE 20 TO MYINCREMENT                                               
291400     PERFORM GET-NXUNIQ-KEYED                                             
291500     IF NO-ENTRY                                                          
291600      MOVE "FMMSTR" TO NXUNIQ-UNIQ-ID                                     
291700      MOVE MYINCREMENT TO NXUNIQ-UNIQ-NUM                                 
291800      PERFORM PUT-NXUNIQ                                                  
291900     ELSE                                                                 
292000      ADD MYINCREMENT TO NXUNIQ-UNIQ-NUM                                  
292100      PERFORM UPDATE-NXUNIQ                                               
292200     End-If.                                                              
292300     PERFORM UNLOCK-NXUNIQ.                                               
292400                                                                          
292500*----------------------------------------------------------------         
292600 GET-NEXT-FFFUNIQ.                                                        
292700     MOVE "FFFLDS" TO SEARCH-KEY.                                         
292800     MOVE 20 TO MYINCREMENT.                                              
292900     PERFORM  LOCK-NXUNIQ.                                                
293000     PERFORM GET-NXUNIQ-KEYED.                                            
293100     IF NO-ENTRY                                                          
293200      MOVE "FFFLDS" TO NXUNIQ-UNIQ-ID                                     
293300      MOVE MYINCREMENT TO NXUNIQ-UNIQ-NUM                                 
293400      PERFORM PUT-NXUNIQ                                                  
293500     ELSE                                                                 
293600      ADD MYINCREMENT TO NXUNIQ-UNIQ-NUM                                  
293700      PERFORM UPDATE-NXUNIQ.                                              
293800     PERFORM UNLOCK-NXUNIQ.                                               
293900*----------------------------------------------------------------         
294000 GET-NEXT-SPECUNIQ.                                                       
294100     MOVE "PRSPEC" TO SEARCH-KEY.                                         
294200     MOVE 20 TO MYINCREMENT.                                              
294300     PERFORM  LOCK-NXUNIQ.                                                
294400     PERFORM GET-NXUNIQ-KEYED.                                            
294500     IF NO-ENTRY                                                          
294600      MOVE "PRSPEC" TO NXUNIQ-UNIQ-ID                                     
294700      MOVE MYINCREMENT TO NXUNIQ-UNIQ-NUM                                 
294800      PERFORM PUT-NXUNIQ                                                  
294900     ELSE                                                                 
295000      ADD MYINCREMENT TO NXUNIQ-UNIQ-NUM                                  
295100      PERFORM UPDATE-NXUNIQ.                                              
295200     PERFORM UNLOCK-NXUNIQ.                                               
295300                                                                          
295400 COPY NXUNIQ0 OF J3KLIB.                                                  
295500 COPY NXUNIQ1 OF J3KLIB.                                                  
295600 COPY NXUNIQ2 OF J3KLIB.                                                  
295700 COPY NXUNIQ3 OF J3KLIB.                                                  
295800 COPY NXUNIQ4 OF J3KLIB.                                                  
295900 COPY NXUNIQ5 OF J3KLIB.                                                  
296000 COPY NXUNIQ6 OF J3KLIB.                                                  
296100 COPY NXUNIQ7 OF J3KLIB.                                                  
296200 COPY NXUNIQ8 OF J3KLIB.                                                  
296300                                                                          
296400 COPY FFFLDS0 OF J3KLIB.                                                  
296500 COPY FFFLDS1 OF J3KLIB.                                                  
296600 COPY FFFLDS2 OF J3KLIB.                                                  
296700 COPY FFFLDS3 OF J3KLIB.                                                  
296800 COPY FFFLDS4 OF J3KLIB.                                                  
296900 COPY FFFLDS5 OF J3KLIB.                                                  
297000 COPY FFFLDS6 OF J3KLIB.                                                  
297100 COPY FFFLDS7 OF J3KLIB.                                                  
297200 COPY FFFLDS8 OF J3KLIB.                                                  
297300                                                                          
297400 COPY FMMSTR0 OF J3KLIB.                                                  
297500 COPY FMMSTR1 OF J3KLIB.                                                  
297600 COPY FMMSTR2 OF J3KLIB.                                                  
297700 COPY FMMSTR3 OF J3KLIB.                                                  
297800 COPY FMMSTR4 OF J3KLIB.                                                  
297900 COPY FMMSTR5 OF J3KLIB.                                                  
298000*------------------------------*                                          
298100 PUT-FMMSTR.                                                              
298200     Move FMMSTR-FM-UNIQUE to Search-Key-I2.                              
298300     Move "FM-UNIQUE;" To Search-Item.                                    
298400     CALL "DBFIND" USING DATA-BASE-NAME (MIGDB ) FMMSTR                   
298500         MODE-1 STATUS-AREA SEARCH-ITEM SEARCH-KEY.                       
298600     IF IMAGE-ERRORS AND NOT NO-ENTRY GO TO 9000-IMAGE-ERROR.             
298700     IF ENTRIES-IN-CHAIN = ZERO MOVE 17 TO CONDITION-WORD.                
298800     IF NO-ENTRY                                                          
298900      CALL "DBPUT" USING DATA-BASE-NAME (MIGDB ) FMMSTR                   
299000         MODE-1 STATUS-AREA ALL-ITEMS FMMSTR-BUFFER                       
299100      IF IMAGE-ERRORS GO TO 9000-IMAGE-ERROR.                             
299200                                                                          
299300 COPY FMMSTR7 OF J3KLIB.                                                  
299400 COPY FMMSTR8 OF J3KLIB.                                                  
299500 COPY FMMSTR9 OF J3KLIB.                                                  
299600                                                                          
299700 COPY FFMSTR0 OF J3KLIB.                                                  
299800 COPY FFMSTR1 OF J3KLIB.                                                  
299900 COPY FFMSTR2 OF J3KLIB.                                                  
300000 COPY FFMSTR3 OF J3KLIB.                                                  
300100 COPY FFMSTR4 OF J3KLIB.                                                  
300200 COPY FFMSTR5 OF J3KLIB.                                                  
300300 COPY FFMSTR6 OF J3KLIB.                                                  
300400 COPY FFMSTR7 OF J3KLIB.                                                  
300500 COPY FFMSTR8 OF J3KLIB.                                                  
300600                                                                          
300700 COPY PRSPEC0 OF J3KLIB.                                                  
300800 COPY PRSPEC1 OF J3KLIB.                                                  
300900 COPY PRSPEC2 OF J3KLIB.                                                  
301000 COPY PRSPEC3 OF J3KLIB.                                                  
301100 COPY PRSPEC4 OF J3KLIB.                                                  
301200 COPY PRSPEC5 OF J3KLIB.                                                  
301300 COPY PRSPEC6 OF J3KLIB.                                                  
301400 COPY PRSPEC7 OF J3KLIB.                                                  
301500 COPY PRSPEC8 OF J3KLIB.                                                  
301600                                                                          
301700 COPY SRVMST0 OF J3KLIB.                                                  
301800 COPY SRVMST1 OF J3KLIB.                                                  
301900 COPY SRVMST2 OF J3KLIB.                                                  
302000 COPY SRVMST3 OF J3KLIB.                                                  
302100 COPY SRVMST4 OF J3KLIB.                                                  
302200 COPY SRVMST5 OF J3KLIB.                                                  
302300 COPY SRVMST6 OF J3KLIB.                                                  
302400 COPY SRVMST7 OF J3KLIB.                                                  
302500 COPY SRVMST8 OF J3KLIB.                                                  
302600*---------------------------------------------------------                
302700 9000-IMAGE-ERROR.                                                        
302800D    DISPLAY "9000-IMAGE-ERROR".                                          
302900     CALL "DBEXPLAIN" USING STATUS-AREA.                                  
303000     GO TO 9900-ABEND.                                                    
303100                                                                          
303200*--------------------------------------------------------------           
303300 CREATE-GLOBAL-PANEL.                                                     
303400D    Display "CREATE-GLOBAL-PANEL".                                       
303500     INITIALIZE FMMSTR-BUFFER.                                            
303600     MOVE 1                  TO FMMSTR-SVR-UNIQUE                         
303700     MOVE FFMSTR-VFIL-UNIQUE TO FMMSTR-VFIL-UNIQUE                        
303800     PERFORM GET-NEXT-FMUNIQ                                              
303900     MOVE NXUNIQ-UNIQ-NUM     TO FMMSTR-FM-UNIQUE                         
304000     Move "$GLOBAL"           To FMMSTR-FRM-NAME.                         
304100     Move 0                   To FMMSTR-FRM-NUMBER.                       
304200     Move SFCNT               To FMMSTR-FLDCNT.                           
304300     Move 0                   To FMMSTR-BUF-LEN.                          
304400     Move spaces              To FMMSTR-NEXT-FRM.                         
304500     Move spaces              To FMMSTR-REPEAT-OPT.                       
304600     Move spaces              To FMMSTR-NFORM-OPT.                        
304700     Move "X"                 To FMMSTR-FKEY-DEF.                         
304800     Move spaces              To FMMSTR-REPRODUCED-FR.                    
304900     Move "Global Settings"   To FMMSTR-COMMENT.                          
305000     Add 1 to My-New-FRMCNT.                                              
305100     PERFORM LOCK-FMMSTR.                                                 
305200     PERFORM PUT-FMMSTR.                                                  
305300     PERFORM UNLOCK-FMMSTR.                                               
305400                                                                          
305500     INITIALIZE LINK-FILEINFO.                                            
305600     MOVE FFMSTR-VFIL-NAME    TO LINK-MPEFILENAME.                        
305700     MOVE FFMSTR-VFIL-CREATOR TO LINK-CREATOR.                            
305800     MOVE FFMSTR-VFIL-ACCT    TO LINK-ACCOUNT.                            
305900     MOVE FFMSTR-VFIL-GROUP   TO LINK-GROUP.                              
306000     MOVE FFMSTR-VFIL-BYTES   TO LINK-BYTES.                              
306100     MOVE FFMSTR-VERSION      TO LINK-VERSION.                            
306200     MOVE FFMSTR-NBR-OF-FORMS TO LINK-NBROFFORMS.                         
306300     MOVE FFMSTR-MAX-FLDS     TO LINK-MAXFIELDS.                          
306400     MOVE FFMSTR-MAX-BUF      TO LINK-MAXBUFSIZE.                         
306500     MOVE FFMSTR-SAVE-FLDS    TO LINK-SFCOUNT.                            
306600     MOVE FFMSTR-HEAD-FRM     TO LINK-HEADFORM.                           
306700     INITIALIZE GDATA-FUNCTION-KEYS.                                      
306800     Perform Varying Frdidx From 1 By 1                                   
306900        Until ( Frdidx > Frdcnt )                                         
307000       Move Frdstr(Frdidx)(1:2) To Ascii-Character                        
307100       If   (Frdstr(Frdidx)(4:15) = SPACES)                               
307200             And (Frdstr(Frdidx)(3:1) = "H")                              
307300             And (Ascii-Value  >  140)                                    
307400             And (Ascii-Value  <  180)                                    
307500        Move Frdstr(Frdidx)(19:128) To GDATA-FUNCTION-KEYS                
307600       End-If                                                             
307700     End-Perform.                                                         
307800     IF GDATA-FUNCTION-KEYS = SPACES                                      
307900      MOVE "  "                 TO LINK-GLOBAL-KEY-DEF                    
308000     ELSE                                                                 
308100      MOVE "X "                 TO LINK-GLOBAL-KEY-DEF.                   
308200     MOVE FFMSTR-DEF-ENH      TO LINK-DEFAULT-ENH.                        
308300     MOVE FFMSTR-DEF-TYPE     TO LINK-DEFAULT-DTYPE.                      
308400     MOVE "O"                 TO LINK-DEFAULT-FTYPE.                      
308500     MOVE FFMSTR-ERR-ENH      TO LINK-ERRENH.                             
308600     MOVE FFMSTR-WIN-ENH      TO LINK-WINENH.                             
308700     MOVE FFMSTR-WIN-POS      TO LINK-WINPOS.                             
308800                                                                          
308900*                                                                         
309000     MOVE 0 TO GLBIDX.                                                    
309100     INITIALIZE GDATA-ITEMS.                                              
309200     ADD 1                                  TO GLBIDX.                    
309300     MOVE "MPEFILENAME"                     TO GLOBAL-NAME.               
309400     MOVE LINK-MPEFILENAME                  TO GLOBAL-VALUE.              
309500     COMPUTE GLOBAL-LENGTH = FUNCTION LENGTH(LINK-MPEFILENAME).           
309600     PERFORM ADD-GLOBAL-FIELD.                                            
309700*                                                                         
309800     INITIALIZE GDATA-ITEMS.                                              
309900     ADD 1                                  TO GLBIDX.                    
310000     MOVE "CREATOR"                     TO GLOBAL-NAME.                   
310100     MOVE LINK-CREATOR                  TO GLOBAL-VALUE.                  
310200     COMPUTE GLOBAL-LENGTH = FUNCTION LENGTH(LINK-CREATOR).               
310300     PERFORM ADD-GLOBAL-FIELD.                                            
310400*                                                                         
310500     INITIALIZE GDATA-ITEMS.                                              
310600     ADD 1                                  TO GLBIDX.                    
310700     MOVE "ACCOUNT"                     TO GLOBAL-NAME.                   
310800     MOVE LINK-ACCOUNT                  TO GLOBAL-VALUE.                  
310900     COMPUTE GLOBAL-LENGTH = FUNCTION LENGTH(LINK-ACCOUNT).               
311000     PERFORM ADD-GLOBAL-FIELD.                                            
311100*                                                                         
311200     INITIALIZE GDATA-ITEMS.                                              
311300     ADD 1                                  TO GLBIDX.                    
311400     MOVE "GROUP"                     TO GLOBAL-NAME.                     
311500     MOVE LINK-GROUP                  TO GLOBAL-VALUE.                    
311600     COMPUTE GLOBAL-LENGTH = FUNCTION LENGTH(LINK-GROUP).                 
311700     PERFORM ADD-GLOBAL-FIELD.                                            
311800*                                                                         
311900     INITIALIZE GDATA-ITEMS.                                              
312000     ADD 1                                  TO GLBIDX.                    
312100     MOVE "BYTES"                     TO GLOBAL-NAME.                     
312200     MOVE LINK-BYTES                  TO GLOBAL-VALUE.                    
312300     COMPUTE GLOBAL-LENGTH = FUNCTION LENGTH(LINK-BYTES).                 
312400     PERFORM ADD-GLOBAL-FIELD.                                            
312500*                                                                         
312600     INITIALIZE GDATA-ITEMS.                                              
312700     ADD 1                                  TO GLBIDX.                    
312800     MOVE "VERSION"                     TO GLOBAL-NAME.                   
312900     MOVE LINK-VERSION                  TO GLOBAL-VALUE.                  
313000     COMPUTE GLOBAL-LENGTH = FUNCTION LENGTH(LINK-VERSION).               
313100     PERFORM ADD-GLOBAL-FIELD.                                            
313200*                                                                         
313300     INITIALIZE GDATA-ITEMS.                                              
313400     ADD 1                                  TO GLBIDX.                    
313500     MOVE "NBROFFORMS"                     TO GLOBAL-NAME.                
313600     MOVE LINK-NBROFFORMS                  TO GLOBAL-VALUE.               
313700     COMPUTE GLOBAL-LENGTH = FUNCTION LENGTH(LINK-NBROFFORMS).            
313800     PERFORM ADD-GLOBAL-FIELD.                                            
313900*                                                                         
314000     INITIALIZE GDATA-ITEMS.                                              
314100     ADD 1                                  TO GLBIDX.                    
314200     MOVE "MAXFIELDS"                     TO GLOBAL-NAME.                 
314300     MOVE LINK-MAXFIELDS                  TO GLOBAL-VALUE.                
314400     COMPUTE GLOBAL-LENGTH = FUNCTION LENGTH(LINK-MAXFIELDS).             
314500     PERFORM ADD-GLOBAL-FIELD.                                            
314600*                                                                         
314700     INITIALIZE GDATA-ITEMS.                                              
314800     ADD 1                                  TO GLBIDX.                    
314900     MOVE "MAXBUFSIZE"                     TO GLOBAL-NAME.                
315000     MOVE LINK-MAXBUFSIZE                  TO GLOBAL-VALUE.               
315100     COMPUTE GLOBAL-LENGTH = FUNCTION LENGTH(LINK-MAXBUFSIZE).            
315200     PERFORM ADD-GLOBAL-FIELD.                                            
315300*                                                                         
315400     INITIALIZE GDATA-ITEMS.                                              
315500     ADD 1                                  TO GLBIDX.                    
315600     MOVE "SFCOUNT"                     TO GLOBAL-NAME.                   
315700     MOVE LINK-SFCOUNT                  TO GLOBAL-VALUE.                  
315800     COMPUTE GLOBAL-LENGTH = FUNCTION LENGTH(LINK-SFCOUNT).               
315900     PERFORM ADD-GLOBAL-FIELD.                                            
316000*                                                                         
316100     INITIALIZE GDATA-ITEMS.                                              
316200     ADD 1                                  TO GLBIDX.                    
316300     MOVE "HEADFORM"                     TO GLOBAL-NAME.                  
316400     MOVE LINK-HEADFORM                  TO GLOBAL-VALUE.                 
316500     COMPUTE GLOBAL-LENGTH = FUNCTION LENGTH(LINK-HEADFORM).              
316600     PERFORM ADD-GLOBAL-FIELD.                                            
316700*                                                                         
316800     INITIALIZE GDATA-ITEMS.                                              
316900     ADD 1                                  TO GLBIDX.                    
317000     MOVE "GLOBAL-KEY-DEF"                     TO GLOBAL-NAME.            
317100     MOVE LINK-GLOBAL-KEY-DEF                  TO GLOBAL-VALUE.           
317200     COMPUTE GLOBAL-LENGTH = FUNCTION LENGTH(LINK-GLOBAL-KEY-DEF).        
317300     PERFORM ADD-GLOBAL-FIELD.                                            
317400*                                                                         
317500     INITIALIZE GDATA-ITEMS.                                              
317600     ADD 1                                  TO GLBIDX.                    
317700     MOVE "DEFAULT-ENH"                     TO GLOBAL-NAME.               
317800     MOVE LINK-DEFAULT-ENH                  TO GLOBAL-VALUE.              
317900     COMPUTE GLOBAL-LENGTH = FUNCTION LENGTH(LINK-DEFAULT-ENH).           
318000     PERFORM ADD-GLOBAL-FIELD.                                            
318100*                                                                         
318200     INITIALIZE GDATA-ITEMS.                                              
318300     ADD 1                                  TO GLBIDX.                    
318400     MOVE "DEFAULT-DTYPE"                     TO GLOBAL-NAME.             
318500     MOVE LINK-DEFAULT-DTYPE                  TO GLOBAL-VALUE.            
318600     COMPUTE GLOBAL-LENGTH = FUNCTION LENGTH(LINK-DEFAULT-DTYPE).         
318700     PERFORM ADD-GLOBAL-FIELD.                                            
318800*                                                                         
318900     INITIALIZE GDATA-ITEMS.                                              
319000     ADD 1                                  TO GLBIDX.                    
319100     MOVE "DEFAULT-FTYPE"                     TO GLOBAL-NAME.             
319200     MOVE LINK-DEFAULT-FTYPE                  TO GLOBAL-VALUE.            
319300     COMPUTE GLOBAL-LENGTH = FUNCTION LENGTH(LINK-DEFAULT-FTYPE).         
319400     PERFORM ADD-GLOBAL-FIELD.                                            
319500*                                                                         
319600     INITIALIZE GDATA-ITEMS.                                              
319700     ADD 1                                  TO GLBIDX.                    
319800     MOVE "ERRENH"                     TO GLOBAL-NAME.                    
319900     MOVE LINK-ERRENH                  TO GLOBAL-VALUE.                   
320000     COMPUTE GLOBAL-LENGTH = FUNCTION LENGTH(LINK-ERRENH).                
320100     PERFORM ADD-GLOBAL-FIELD.                                            
320200*                                                                         
320300     INITIALIZE GDATA-ITEMS.                                              
320400     ADD 1                                  TO GLBIDX.                    
320500     MOVE "WINENH"                     TO GLOBAL-NAME.                    
320600     MOVE LINK-WINENH                  TO GLOBAL-VALUE.                   
320700     COMPUTE GLOBAL-LENGTH = FUNCTION LENGTH(LINK-WINENH).                
320800     PERFORM ADD-GLOBAL-FIELD.                                            
320900*                                                                         
321000     INITIALIZE GDATA-ITEMS.                                              
321100     ADD 1                                  TO GLBIDX.                    
321200     MOVE "WINPOS"                     TO GLOBAL-NAME.                    
321300     MOVE LINK-WINPOS                  TO GLOBAL-VALUE.                   
321400     COMPUTE GLOBAL-LENGTH = FUNCTION LENGTH(LINK-WINPOS).                
321500     PERFORM ADD-GLOBAL-FIELD.                                            
321600                                                                          
321700     INITIALIZE FFFLDS-BUFFER SFIDX.                                      
321800     move 1 to bufpos.                                                    
321900     If FILE-SAVE-FIELDS(1) > 0                                           
322000      Perform Varying SFIDX From 1 By 1                                   
322100        Until SFIDX > SFCNT                                               
322200       INITIALIZE FFFLDS-BUFFER                                           
322300       Move 1                   to FFFLDS-SVR-UNIQUE                      
322400       Move FFMSTR-VFIL-UNIQUE  to FFFLDS-VFIL-UNIQUE                     
322500       Move FMMSTR-FM-UNIQUE    to FFFLDS-FM-UNIQUE                       
322600       PERFORM GET-NEXT-FFFUNIQ                                           
322700       MOVE NXUNIQ-UNIQ-NUM     TO FFFLDS-VFLD-UNIQUE                     
322800       Move 1                   To FFFLDS-SRN-X                           
322900       Move SFIDX               To FFFLDS-SRN-Y                           
323000       Move SFIDX               To FFFLDS-SRN-ORD-NUM                     
323100       Move SF-FLD(SFIDX)       To FFFLDS-VFLD-NAME                       
323200       Move SF-TYPE(SFIDX)      To FFFLDS-VFLD-DATATYPE                   
323300       Move SF-INIT(SFIDX)      To FFFLDS-VFLD-INITVAL                    
323400       Move SF-LEN(SFIDX)       To FFFLDS-VFLD-LENGTH                     
323500       Move bufpos to FFFLDS-BUF-X                                        
323600       Compute                                                            
323700         FFFLDS-BUF-Y = FFFLDS-BUF-X + SF-LEN(SFIDX)                      
323800       END-COMPUTE                                                        
323900       Move FFFLDS-BUF-Y to bufpos                                        
324000       Add 1 to My-New-FLDCNT                                             
324100       PERFORM LOCK-FFFLDS                                                
324200       PERFORM PUT-FFFLDS                                                 
324300       PERFORM UNLOCK-FFFLDS                                              
324400      end-Perform.                                                        
324500                                                                          
324600     Perform Varying GLBIDX From 1 By 1                                   
324700      Until GLBIDX > 8                                                    
324800      INITIALIZE FFFLDS-BUFFER                                            
324900      Move 1                   to FFFLDS-SVR-UNIQUE                       
325000      Move FFMSTR-VFIL-UNIQUE  to FFFLDS-VFIL-UNIQUE                      
325100      Move FMMSTR-FM-UNIQUE    to FFFLDS-FM-UNIQUE                        
325200      PERFORM GET-NEXT-FFFUNIQ                                            
325300      MOVE NXUNIQ-UNIQ-NUM     TO FFFLDS-VFLD-UNIQUE                      
325400      Move 2                   To FFFLDS-SRN-X                            
325500      MOVE "FK"                TO FFFLDS-VFLD-TYPE                        
325600      MOVE "FKEY"              TO FFFLDS-VFLD-NAME                        
325700      MOVE 0                   TO FFFLDS-SRN-ORD-NUM                      
325800      STRING GKEY-LINE1(GLBIDX) GKEY-LINE2(GLBIDX)                        
325900       DELIMITED BY SIZE     INTO FFFLDS-VFLD-INITVAL                     
326000      IF GLBIDX < 5                                                       
326100       COMPUTE                                                            
326200        FFFLDS-SRN-Y = ((GLBIDX * 8) - ( 8 - GLBIDX))                     
326300       END-COMPUTE                                                        
326400      ELSE                                                                
326500       COMPUTE                                                            
326600        FFFLDS-SRN-Y = ((GLBIDX * 8) +  GLBIDX)                           
326700       END-COMPUTE                                                        
326800      END-IF                                                              
326900      MOVE 16                  TO FFFLDS-VFLD-LENGTH                      
327000      move "HI"                TO FFFLDS-VFLD-ENHANCE                     
327100      Add 1 to My-New-FLDCNT                                              
327200      PERFORM LOCK-FFFLDS                                                 
327300      PERFORM PUT-FFFLDS                                                  
327400      PERFORM UNLOCK-FFFLDS                                               
327500     end-Perform.                                                         
327600*----------------------------------------------------------------         
327700 ADD-GLOBAL-FIELD.                                                        
327800     INITIALIZE FFFLDS-BUFFER.                                            
327900     MOVE 1                   TO FFFLDS-SVR-UNIQUE.                       
328000     MOVE FFMSTR-VFIL-UNIQUE  TO FFFLDS-VFIL-UNIQUE.                      
328100     MOVE FMMSTR-FM-UNIQUE    TO FFFLDS-FM-UNIQUE.                        
328200     PERFORM GET-NEXT-FFFUNIQ.                                            
328300     MOVE NXUNIQ-UNIQ-NUM     TO FFFLDS-VFLD-UNIQUE.                      
328400     MOVE 60                  TO FFFLDS-SRN-X.                            
328500     MOVE GLBIDX              TO FFFLDS-SRN-Y.                            
328600     MOVE GLBIDX              TO FFFLDS-SRN-ORD-NUM.                      
328700     MOVE GLOBAL-NAME         TO FFFLDS-VFLD-NAME.                        
328800     MOVE "CHAR"              TO FFFLDS-VFLD-DATATYPE.                    
328900     MOVE GLOBAL-VALUE        TO FFFLDS-VFLD-INITVAL.                     
329000     MOVE GLOBAL-LENGTH       TO FFFLDS-VFLD-LENGTH.                      
329100     MOVE BUFPOS              TO FFFLDS-BUF-X.                            
329200     MOVE FFFLDS-BUF-Y        TO BUFPOS.                                  
329300     Compute FFFLDS-BUF-Y = FFFLDS-BUF-X + FFFLDS-VFLD-LENGTH.            
329400     Add 1 to My-New-FLDCNT.                                              
329500     PERFORM LOCK-FFFLDS.                                                 
329600     PERFORM PUT-FFFLDS.                                                  
329700     PERFORM UNLOCK-FFFLDS.                                               
329800     Add 1 to My-New-FLDCNT.                                              
329900                                                                          
330000*----------------------------------------------------------------         
330100 DELETE-FORMDATA.                                                         
330200                                                                          
330300                                                                          
330400*                                                                         
330500* Prepare for form data reload, this paragraph will delete                
330600* all records related to a formsfile from the following                   
330700* data sets:                                                              
330800*                                                                         
330900* FFFLDS: The formsfile FIELDS data set.                                  
331000* FFMSTR: The formsfile FILE data set.                                    
331100* FMMSTR: The formsfile FORMS data set.                                   
331200* PRSPEC: The formfile PROCESSING SPECS data set.                         
331300*                                                                         
331400     Display "Find and Delete records for " SCREEN-FORMS-FILE.            
331500                                                                          
331600 BEGIN-DELETE.                                                            
331700     Initialize FFMSTR-BUFFER FFIDX GFILE-COUNT.                          
331800     Move 999999999 To FFFLDS-Del-Cnt FMMSTR-Del-Cnt.                     
331900     Perform Rewind-FMMSTR.                                               
332000     Perform Varying FFIDX From 1 by 1                                    
332100       Until END-OF-FILE                                                  
332200          Or FFIDX > 10000                                                
332300      Initialize FFMSTR-BUFFER                                            
332400      Perform Get-FFMSTR-Serial                                           
332500      IF NOT END-OF-FILE                                                  
332600       IF FFMSTR-VFIL-NAME = SCREEN-FORMS-FILE                            
332700        MOVE FFMSTR-VFIL-UNIQUE TO GFILE-COUNT                            
332800        DISPLAY " ****************** "                                    
332900        DISPLAY " DELETING FORMSFILE " SCREEN-FORMS-FILE                  
333000        DISPLAY " ****************** "                                    
333100        Perform Lock-FFMSTR                                               
333200        Perform Delete-FFMSTR                                             
333300        Perform Unlock-FFMSTR                                             
333400       END-IF                                                             
333500      END-IF                                                              
333600     End-Perform.                                                         
333700     If GFILE-COUNT = 0                                                   
333800       Display "GREAT! No PRE-EXISTING records for: "                     
333900        SCREEN-FORMS-FILE                                                 
334000       Go to DELETE-FORMDATA-EXIT.                                        
334100                                                                          
334200*                                                                         
334300 Delete-Fields.                                                           
334400     Display "Delete-Fields " GFILE-COUNT.                                
334500     Initialize FFFLDS-Rec-Cnt FFFLDS-Del-Cnt FFFLDS-Buffer.              
334600     Move GFILE-COUNT to Search-Key-I2.                                   
334700     Move "VFIL-UNIQUE;" To Search-Item.                                  
334800     Move 999999999 To PRSPEC-Del-Cnt.                                    
334900     Perform Find-FFFLDS.                                                 
335000     If CONDITION-WORD = 0 and Entries-In-Chain > 0                       
335100      Move Entries-In-Chain To FFFLDS-Rec-Cnt                             
335200      DISPLAY FFFLDS-Rec-Cnt " FIELDS FOUND"                              
335300      Perform Varying FFFIDX From 1 by 1                                  
335400        Until END-OF-CHAIN or FFFIDX > 100000                             
335500       initialize FFFLDS-BUFFER                                           
335600       Perform Get-FFFLDS-Chained                                         
335700       If not END-OF-CHAIN                                                
335800        Move Status-Area to Save-Status                                   
335900        Perform Delete-ProcSpecs until PRSPEC-Del-Cnt = 0                 
336000        Move Save-Status To Status-Area                                   
336100        Perform Get-FFFLDS-Direct                                         
336200        Perform Lock-FFFLDS                                               
336300        Perform Delete-FFFLDS                                             
336400        Add 1 To FFFLDS-Del-Cnt                                           
336500        Perform Unlock-FFFLDS                                             
336600       End-If                                                             
336700      End-Perform.                                                        
336800      DISPLAY FFFLDS-Del-Cnt " FIELDS DELETED".                           
336900      IF FFFLDS-Del-Cnt > 0                                               
337000       GO TO Delete-Fields.                                               
337100*                                                                         
337200 Delete-Forms.                                                            
337300     Display "Delete-Forms " GFILE-COUNT.                                 
337400     Initialize FMMSTR-Rec-Cnt FMMSTR-Del-Cnt FMMSTR-Buffer.              
337500     Move GFILE-COUNT to Search-Key-I2.                                   
337600     Move "VFIL-UNIQUE;" To Search-Item.                                  
337700     Perform Find-FMMSTR.                                                 
337800     If CONDITION-WORD = 0 and Entries-In-Chain > 0                       
337900      Move Entries-In-Chain To FMMSTR-Rec-Cnt                             
338000      DISPLAY FMMSTR-Rec-Cnt " FORMS FOUND"                               
338100      Perform Varying FFFIDX From 1 by 1                                  
338200        Until END-OF-CHAIN or FFFIDX > 100000                             
338300       initialize FMMSTR-BUFFER                                           
338400       Perform Get-FMMSTR-Chained                                         
338500       If not END-OF-CHAIN                                                
338600        Perform Get-FMMSTR-Direct                                         
338700        Perform Lock-FMMSTR                                               
338800        Perform Delete-FMMSTR                                             
338900        Add 1 To FMMSTR-Del-Cnt                                           
339000        Perform Unlock-FMMSTR                                             
339100       End-If                                                             
339200      End-Perform.                                                        
339300      DISPLAY FMMSTR-Del-Cnt " FORMS DELETED".                            
339400      IF FMMSTR-Del-Cnt > 0                                               
339500       GO TO Delete-Forms.                                                
339600      GO TO BEGIN-DELETE.                                                 
339700                                                                          
339800 Delete-ProcSpecs.                                                        
339900     Display "Delete-ProcSpecs " FFFLDS-VFLD-UNIQUE.                      
340000     Initialize PRSPEC-Rec-Cnt PRSPEC-Del-Cnt PRSPEC-Buffer.              
340100     Move FFFLDS-VFLD-UNIQUE to Search-Key-I2.                            
340200     Move "VFLD-UNIQUE;" To Search-Item.                                  
340300     Perform Find-PRSPEC.                                                 
340400     If NOT NO-ENTRY                                                      
340500      Move Entries-In-Chain To PRSPEC-Rec-Cnt                             
340600      DISPLAY PRSPEC-Rec-Cnt " PROCSPECS FOUND"                           
340700      Perform Varying PRSIDX From 1 by 1                                  
340800        Until END-OF-CHAIN or PRSIDX > PRSPEC-Rec-Cnt                     
340900       Initialize PRSPEC-BUFFER                                           
341000       Perform Get-PRSPEC-Chained                                         
341100       If not END-OF-CHAIN                                                
341200        Perform Lock-PRSPEC                                               
341300        Perform Delete-PRSPEC                                             
341400        Add 1 To PRSPEC-Del-Cnt                                           
341500        Perform Unlock-PRSPEC                                             
341600       End-If                                                             
341700      End-Perform.                                                        
341800      DISPLAY PRSPEC-Del-Cnt " PROCSPECS DELETED".                        
341900                                                                          
342000 DELETE-FORMDATA-EXIT.                                                    
342100     EXIT.                                                                
342200                                                                          
