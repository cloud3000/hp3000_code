001000$CONTROL POST85, BOUNDS, LINES=59, LIST                                   
001100******************************************************************080702ma
001200*   COPYRIGHT 2007 - 2009 J3K Solutions All rights reserved.      080702ma
001300*            Turbo Image Migration PREP System                    080702ma
001400*                                                                 080702ma
001500*        This program will "Create" the migration data            080812ma
001600*        base in the J3K account, and adds the server rec         080702ma
001700*                                                                 080702ma
001800*   http://www.j3ksolutions.com                                   080702ma
001900*   mailto:support@j3ksolutions.com                               080702ma
002000******************************************************************080702ma
002100*                                                *                        
002200*                                                                         
002300 IDENTIFICATION DIVISION.                                                 
002400 PROGRAM-ID.     MIG900.                                                  
002500 AUTHOR.     MICHAEL ANDERSON.                                            
002600 ENVIRONMENT DIVISION.                                                    
002700 CONFIGURATION SECTION.                                                   
002800 SOURCE-COMPUTER. HP-3000.                                                
002900*  SOURCE-COMPUTER. HP-3000 WITH DEBUGGING MODE.                          
003000 OBJECT-COMPUTER. HP-3000.                                                
003100*                                                                         
003200 INPUT-OUTPUT SECTION.                                                    
003300 FILE-CONTROL.                                                            
003400    SELECT WORK-FILE     ASSIGN TO "DBLIST,,,,5000".                      
003500    SELECT SCHEMA-FILE   ASSIGN TO "SCHEM,,,DISC".                        
003600    SELECT JOB-FILE      ASSIGN TO "DBJOB,,,DISC".                        
003700                                                                          
003800 DATA DIVISION.                                                           
003900  FILE SECTION.                                                           
004000                                                                          
004100 FD  WORK-FILE.                                                           
004200 01  WRK-REC.                                                             
004300     05  WRK-FOUND-DB          PIC X(36).                                 
004400     05  WRK-FILL-DB           PIC X(45).                                 
004500 FD  SCHEMA-FILE.                                                         
004600 01  SCHMA                PIC X(80).                                      
004700 FD  JOB-FILE.                                                            
004800 01  JOBREC                PIC X(80).                                     
004900                                                                          
005000$PAGE "WORKING STORAGE"                                                   
005100 WORKING-STORAGE SECTION.                                                 
005200 01  HPVAR-NAME        PIC X(20) VALUE "ITOSQLS_STATUS~  ".               
005300 01  HPVAR-ITEM        PIC S9(9) COMP VALUE -1.                           
005400 01  HPVAR-ITEMNUM     PIC S9(9) COMP VALUE 1.                            
005500 01  HPVAR-STAT        PIC S9(9) COMP VALUE 0.                            
005600 01  DS-IDX            PIC S9(9) COMP VALUE 0.                            
005700 01  DI-IDX            PIC S9(9) COMP VALUE 0.                            
005800 01  DISP-99           PIC Z(9).                                          
005900 01 MYDBCAP    PIC S9(9) COMP VALUE 0.                                    
006000 01 MYDSCAP    PIC S9(9) COMP VALUE 0.                                    
006100 01 MYFLDCAP   PIC S9(9) COMP VALUE 0.                                    
006200 01 MYFFILCAP  PIC S9(9) COMP VALUE 0.                                    
006300 01 MYFMCAP    PIC S9(9) COMP VALUE 0.                                    
006400 01 MYFFFLDCAP PIC S9(9) COMP VALUE 0.                            080828ma
006500 01 MYFFspecCAP PIC S9(9) COMP VALUE 0.                           080828ma
006600 01 MY16CAP    PIC S9(9) COMP VALUE 0.                                    
006700                                                                          
006800 01  GETINFO-DATA.                                                        
006900    05  GINFO-LEN                PIC S9(4) COMP.                          
007000    05  GINFO-STR                PIC X(128).                              
007100    05  GINFO-PARM               PIC S9(4) COMP.                          
007200 01  PARSED-DATA.                                                         
007300    05  ITEMS-PARSED             PIC S9(4) COMP.                          
007400        88 PARSE-IS-COMPLETE VALUES ARE 3 THRU 99.                        
007500    05  PARSED-STRING            PIC X(128).                              
007600    05  NEXT-STRING              PIC X(128).                              
007700    05  STRING-POINTER             PIC S9(4) COMP.                        
007800    05  GX                       PIC S9(4) COMP.                          
007900    05  GY                       PIC S9(4) COMP.                          
008000    05  PX                       PIC S9(4) COMP.                          
008100                                                                          
008200 COPY SRVMST OF J3KLIB.                                                   
008300                                                                          
008400 01  FULL-CURRENT-DATE.                                                   
008500         05  C-DATE.                                                      
008600             10  C-YEAR       PIC 9(4).                                   
008700             10  C-MONTH      PIC 99.                                     
008800             10  C-DAY        PIC 99.                                     
008900         05  C-TIME.                                                      
009000             10  C-HOUR       PIC 99.                                     
009100             10  C-MINUTES    PIC 99.                                     
009200             10  C-SECONDS    PIC 99.                                     
009300             10  C-SEC-HUND   PIC 99.                                     
009400         05  C-TIME-DIFF.                                                 
009500             10  O-GMT-DIR    PIC X.                                      
009600             10  O-HOUR       PIC 99.                                     
009700             10  O-MINUTES    PIC 99.                                     
009800 01 ERROR-MSG                PIC X(80) VALUE SPACES.                      
009900 01 NUMDEC                 PIC S9(4) COMP.                                
010000 01 NUMERR                 PIC S9(4) COMP.                                
010100 01 NUM1                   PIC X(14).                                     
010200 01 NUM2                   PIC S9(14). 01  DB-MISC.                       
010300     02  RE-READ           PIC S9(4) COMP VALUE 1.                        
010400     02  MAX-DB            PIC S9(4) COMP VALUE 100.                      
010500     02  SERIAL            PIC S9(4) COMP VALUE 2.                        
010600     02  BACKWARD          PIC S9(4) COMP VALUE 3.                        
010700     02  DIRECT            PIC S9(4) COMP VALUE 4.                        
010800     02  CHAINED           PIC S9(4) COMP VALUE 5.                        
010900     02  BACK-CHAINED      PIC S9(4) COMP VALUE 6.                        
011000     02  KEYED             PIC S9(4) COMP VALUE 7.                        
011100     02  MODE-1            PIC S9(4) COMP VALUE 1.                        
011200     02  MODE-3            PIC S9(4) COMP VALUE 3.                        
011300     02  MODE-4            PIC S9(4) COMP VALUE 4.                        
011400     02  MODE-20           PIC S9(4) COMP VALUE 20.                       
011500     02  MODE-104          PIC S9(4) COMP VALUE 104.                      
011600     02  MODE-102          PIC S9(4) COMP VALUE 102.                      
011700     02  MODE-103          PIC S9(4) COMP VALUE 103.                      
011800     02  MODE-202          PIC S9(4) COMP VALUE 202.                      
011900     02  MODE-203          PIC S9(4) COMP VALUE 203.                      
012000     02  MODE-301          PIC S9(4) COMP VALUE 301.                      
012100     02  MODE-406          PIC S9(4) COMP VALUE 406.                      
012200     02  MODE-5            PIC S9(4) COMP VALUE 5.                        
012300     02  MODE-N            PIC S9(4) COMP VALUE 0.                        
012400     02  IREAD-LEN         PIC S9(4) COMP VALUE 0.                        
012500     02  IMAGE-ERRNUM      PIC S9(4) COMP VALUE 0.                        
012600     02  CALL-STRING       PIC X(80) VALUE SPACES.                        
012700     02  CSLEN             PIC S9(4) COMP VALUE 0.                        
012800     02  ERROR-STRING      PIC X(80) VALUE SPACES.                        
012900     02  ESLEN             PIC S9(4) COMP VALUE 0.                        
013000     02  NULL-ITEM         PIC XXXX VALUE "; ".                           
013100     02  ALL-ITEMS         PIC XX VALUE "@;".                             
013200     02  SEARCH-ITEM       PIC X(18).                                     
013300     02  SEARCH-KEY        PIC X(64).                                     
013400     02  SEARCH-KEYI2 REDEFINES SEARCH-KEY.                               
013500         03 SEARCH-KEYI32  PIC S9(9) COMP.                                
013600         03 FILLER         PIC X(60).                                     
013700     02  STATUS-AREA.                                                     
013800         03  CONDITION-WORD    PIC S9(4) COMP VALUE  0.                   
013900             88  NO-IMAGE-ERRORS         VALUE  0.                        
014000             88  IMAGE-ERRORS                                             
014100                 VALUES ARE -9999 THRU -1, 1 THRU  9999.                  
014200             88  END-OF-FILE             VALUE 11.                        
014300             88  BEG-OF-FILE             VALUE 12.                        
014400             88  BEG-OF-CHAIN            VALUE 14.                        
014500             88  END-OF-CHAIN            VALUE 15.                        
014600             88  NO-ENTRY                VALUE 17.                        
014700         03  RECORD-LENGTH     PIC S9(4) COMP VALUE  0.                   
014800         03  RECORD-NUMBER     PIC S9(9) COMP VALUE  0.                   
014900         03  ENTRIES-IN-CHAIN  PIC S9(9) COMP VALUE  0.                   
015000         03  PREV-RECORD-NO    PIC S9(9) COMP VALUE  0.                   
015100         03  NEXT-RECORD-NO    PIC S9(9) COMP VALUE  0.                   
015200 01  MIGDB    PIC S9(4) COMP VALUE  9.                                    
015300 01  MYDB     PIC S9(4) COMP VALUE  9.                                    
015400 01  MIGDB-STATUS.                                                        
015500     03  FILLER    PIC S9(4) COMP VALUE  0.                               
015600     03  FILLER    PIC S9(4) COMP VALUE  0.                               
015700     03  FILLER    PIC S9(9) COMP VALUE  0.                               
015800     03  FILLER    PIC S9(9) COMP VALUE  0.                               
015900     03  FILLER    PIC S9(9) COMP VALUE  0.                               
016000     03  FILLER    PIC S9(9) COMP VALUE  0.                               
016100 01  FIRST-TIME-SW         PIC X.                                         
016200     88  FIRST-TIME        VALUE "1".                                     
016300                                                                          
016400 01  ERRORS-SW             PIC X.                                         
016500     88  ERRORS            VALUE "1".                                     
016600                                                                          
016700 01  EDIT-ERRORS-SW        PIC X.                                         
016800     88  EDIT-ERRORS       VALUE "1".                                     
016900                                                                          
017000 01  BAD-KEY-SW            PIC X.                                         
017100     88  BAD-KEY           VALUE "1".                                     
017200                                                                          
017300 01  Last-Column-SW       PIC X.                                          
017400     88  Last-Column      VALUE "1".                                      
017500                                                                          
017600 01  X-FLOWTEST-JCW          PIC X(8) VALUE "FLOWTEST".                   
017700 01  X-FLOWTEST-VALUE        PIC S9(4) COMP VALUE 0.                      
017800     88  X-FLOWTEST          VALUE 1.                                     
017900                                                                          
018000 01 TARGET-FIELD                    PIC X(64) VALUE SPACES.               
018100 01 DWNSHFT-SW                      PIC X.                                
018200    88 OK-TO-DOWNSHIFT VALUE "1".                                         
018300 01 MYIDX                           PIC S9(4) COMP VALUE 0.               
018400 01 SOURCE-FIELD                    PIC X(64) VALUE SPACES.               
018500 01 ASCII-CHARACTERS.                                                     
018600    02 TWO-BYTES                    PIC XX VALUE SPACES.                  
018700    02 SIXTEEN-BITS REDEFINES TWO-BYTES.                                  
018800       05 ASCII-INT                 PIC S9(4) COMP.                       
018900    02 TWO-CHARS    REDEFINES TWO-BYTES.                                  
019000       05 FILLER                    PIC X.                                
019100       05 ASCII-CHAR                PIC X.                                
019200                                                                          
019300                                                                          
019400 01 ABORT-SWITCHES.                                                       
019500    02 ON-IMAGE-ERRORS     PIC X VALUE "0".                               
019600       88 ABORT-ON-IMAGE-ERRORS  VALUE "9".                               
019700                                                                          
019800 01  DATA-BASE-COMMON.                                                    
019900     02  DB-PTR                    PIC S9(4) COMP.                        
020000     02  DB-CNT                    PIC S9(4) COMP.                        
020100     02  DB-MAX                    PIC S9(4) COMP.                        
020200     02  DB-IDX                    PIC S9(4) COMP.                        
020300     02  DB-POINTER-STORAGE.                                              
020400         03 DB-POINTER-ENTRIES OCCURS 100 TIMES.                          
020500            04 DBPTR               PIC S9(4) COMP.                        
020600                                                                          
020700     02  SAVE-STATUS.                                                     
020800         03  CONDITION-SAVED   PIC S9(4) COMP.                            
020900         03  SAVED-LENGTH      PIC S9(4) COMP.                            
021000         03  SAVED-NUMBER      PIC S9(9) COMP.                            
021100         03  SAVED-IN-CHAIN    PIC S9(9) COMP.                            
021200         03  PREV-SAVED-NO     PIC S9(9) COMP.                            
021300         03  NEXT-SAVED-NO     PIC S9(9) COMP.                            
021400                                                                          
021500     02 DATABASE-TABLE.                                                   
021600         03 DATA-BASE-NAMES            OCCURS 512 TIMES.                  
021700            05 DATA-BASE-NAME.                                            
021800             10 IMAGE-WORD           PIC XX.                              
021900             10 DBNAME               PIC X(26).                           
022000            05 DATA-BASE-PASS          PIC X(08).                         
022100                                                                          
022200 01 A-TABLE-SW               PIC X VALUE "0".                             
022300    88 ITS-A-TABLE    VALUE "1".                                          
022400 01 DOW                      PIC S9(4) COMP  VALUE 0.                     
022500 01 INSPECT-IDX              PIC S9(4) COMP  VALUE 0.                     
022600 01 NUMDATE                  PIC S9(9) COMP  VALUE 0.                     
022700                                                                          
022800 01 WHO-INTRINSIC-PARMS.                                                  
022900    15  WHO-TERM-DEV-NO        PIC S9999 COMP.                            
023000    15  WHO-MODE               PIC S9999 COMP.                            
023100    15  WHO-CAPABILITY         PIC S9(6) COMP.                            
023200    15  WHO-LATTR              PIC S9(6) COMP.                            
023300    15  WHO-USERN.                                                        
023400        20 BYTE1-6             PIC X(6).                                  
023500        20 SCHOOL-NUMBER       PIC XX.                                    
023600    15  WHO-GROUPN             PIC X(8).                                  
023700    15  WHO-ACCTN              PIC X(8).                                  
023800    15  WHO-HOMEN              PIC X(8).                                  
023900                                                                          
024000 01 DP-IDX                  PIC S9(9) COMP  VALUE 0.                      
024100 01 MyHpSusan               PIC S9(9) COMP  VALUE 0.                      
024200 01 MYHPVERSION             PIC X(24) VALUE SPACES.                       
024300 01 MYHPCPUNAME             PIC X(24) VALUE SPACES.                       
024400 01 MYHPLOCIPADDR           PIC X(24) VALUE SPACES.                       
024500 01 MYMSG                   PIC X(79) VALUE SPACES.                       
024600 01 SI-IDX                  PIC S9(9) COMP  VALUE 0.                      
024700 01 DISPZ4                  PIC ZZ,ZZZ,ZZZ VALUE ZERO.                    
024800 01 CSTR                     PIC X(255)      VALUE SPACES.                
024900 01 CMD                     PIC X(255)      VALUE SPACES.                 
025000 01 CERR                     PIC S9(4) COMP  VALUE 0.                     
025100 01 CPARM                    PIC S9(4) COMP  VALUE 0.                     
025200 01 CMSG                     PIC S9(4) COMP  VALUE 2.                     
025300 01 STR-PTR                  PIC S9(4) COMP  VALUE 0.                     
025400 01 OCCURS-VALUE             PIC S9(4) COMP  VALUE 0.                     
025500 01  EXTFILE-STATUS            PIC X   VALUE "0".                         
025600     88 EXTFILE-EOF                    VALUE "9".                         
025700 01 OCCURS-LAST              PIC S9(4) COMP  VALUE 0.                     
025800 01 My-BaseName              Pic X(28) Value Spaces.                      
025900 01 M               Pic X(78) Value Spaces.                               
026000 01 OCCURS-PTR               PIC S9(4) COMP  VALUE 0.                     
026100 01 NUM-X                    PIC S9(4) COMP  VALUE 0.                     
026200 01 My-Bytes                  pic S9(4) Comp  Value 0.                    
026300 01 DASH-PTR                 PIC S9(4) COMP  VALUE 0.                     
026400 01 VAR-LEN                  PIC S9(4) COMP  VALUE 0.                     
026500 01 SHOWTIME-STR.                                                         
026600    02 FILLER PIC X(8) VALUE "SHOWTIME".                                  
026700    02 FILLER PIC X    VALUE %15.                                         
026800 01 DATE-EDITING.                                                         
026900    05 RAW-DATE.                                                          
027000       10 D1     PIC X   VALUE SPACES.                                    
027100       10 D2     PIC X   VALUE SPACES.                                    
027200       10 D3     PIC X   VALUE SPACES.                                    
027300       10 D4     PIC X   VALUE SPACES.                                    
027400       10 D5     PIC X   VALUE SPACES.                                    
027500       10 D6     PIC X   VALUE SPACES.                                    
027600       10 D7     PIC X   VALUE SPACES.                                    
027700       10 D8     PIC X   VALUE SPACES.                                    
027800    05 EDITED-DATE.                                                       
027900       10 D5     PIC X   VALUE SPACES.                                    
028000       10 D6     PIC X   VALUE SPACES.                                    
028100       10 FILLER PIC X   VALUE "/".                                       
028200       10 D7     PIC X   VALUE SPACES.                                    
028300       10 D8     PIC X   VALUE SPACES.                                    
028400       10 FILLER PIC X   VALUE "/".                                       
028500       10 D1     PIC X   VALUE SPACES.                                    
028600       10 D2     PIC X   VALUE SPACES.                                    
028700       10 D3     PIC X   VALUE SPACES.                                    
028800       10 D4     PIC X   VALUE SPACES.                                    
028900                                                                          
029000* 1: Database new limits (# of sets = 240,                                
029100*                         # of items = 1200,                              
029200*                         # paths per masters = 64)                       
029300* 0: Database old limits (# of sets = 199,                                
029400*                         # of items = 1024,                              
029500*                         # paths per master = 16)                        
029600                                                                          
029700 01 Db-Info-406-Word-17.                                                  
029800    05  BIT1             PIC 9.                                           
029900    05  BIT2             PIC 9.                                           
030000    05  BIT3             PIC 9.                                           
030100    05  BIT4             PIC 9.                                           
030200    05  BIT5             PIC 9.                                           
030300    05  BIT6             PIC 9.                                           
030400    05  BIT7             PIC 9.                                           
030500    05  BIT8             PIC 9.                                           
030600    05  BIT9             PIC 9.                                           
030700        88 Database-Newlimits Value 1.                                    
030800        88 Database-Oldlimits Value 0.                                    
030900    05  BIT10            PIC 9.                                           
031000        88 Database-Entrynumber-Format Value 1.                           
031100        88 Database-Entryname-Format   Value 0.                           
031200    05  BIT11            PIC 9.                                           
031300    05  BIT12            PIC 9.                                           
031400        88 Expandable-Master-Dataset     Value 1.                         
031500        88 No-Expandable-Master-Dataset   Value 0.                        
031600    05  BIT13            PIC 9.                                           
031700        88 B-Tree      Value 1.                                           
031800        88 No-B-Tree   Value 0.                                           
031900    05  BIT14            PIC 9.                                           
032000    05  BIT15            PIC 9.                                           
032100    05  BIT16            PIC 9.                                           
032200 01  BINARY-VALUE.                                                        
032300     05 BIT-ZERO                     PIC 9.                               
032400     05 BIT OCCURS 15 TIMES          PIC 9.                               
032500                                                                          
032600 01 NUMERIC-EDITS.                                                        
032700    02 Split-Word        Pic S9(4) Comp.                                  
032800    02 Splating-a-word Redefines Split-Word.                              
032900       05 Split-Word-1 Pic x.                                             
033000       05 Split-Word-2 Pic x.                                             
033100    02 CHR3              PIC XXX.                                         
033200    02 Y1                PIC 9.                                           
033300    02 Y2                PIC 99.                                          
033400    02 Y3                PIC 999.                                         
033500    02 Y4                PIC 9999.                                        
033600    02 Y5                PIC 99999.                                       
033700    02 CHR6              PIC XXXXXX.                                      
033800    02 Z1                PIC 9.                                           
033900    02 Z2                PIC 99.                                          
034000    02 Z3                PIC 999.                                         
034100    02 Z4                PIC 9999.                                        
034200    02 Z5                PIC 99999.                                       
034300 01 Collate-Str          Pic x(64).                                       
034400 01  WS-LOGON-DESC                       VALUE SPACES.                    
034500     05  WS-LD-JOB-NAME      PIC  X(16).                                  
034600     05  WS-LD-ACCT-NAME     PIC  X(16).                                  
034700     05  WS-LD-ACCT-PASS     PIC  X(16).                                  
034800     05  WS-LD-USER-NAME     PIC  X(16).                                  
034900     05  WS-LD-USER-PASS     PIC  X(16).                                  
035000     05  WS-LD-GROUP-NAME    PIC  X(16).                                  
035100     05  WS-LD-GROUP-PASS    PIC  X(16).                                  
035200 01  WS-ERR PIC S9(4) COMP VALUE 0.                                       
035300 01  WS-ERR-MSG PIC X(80) VALUE SPACES.                                   
035400 01  TDAY                PIC X(8)  VALUE SPACES.                          
035500 01  TNUMDAY             PIC S9(9) COMP VALUE 0.                          
035600 01  TDOW                PIC S9(4) COMP VALUE 0.                          
035700 01  DDAY                PIC X(8)  VALUE SPACES.                          
035800 01  DNUMDAY             PIC S9(9) COMP VALUE 0.                          
035900 01  DDOW                PIC S9(4) COMP VALUE 0.                          
036000 01  DCNT                PIC S9(4) COMP VALUE 0.                          
036100 COPY AMSMODE OF J3KLIB.                                                  
036200                                                                          
036300*=================================================================        
036400$PAGE  "Main logical flow"                                                
036500*=================================================================        
036600 PROCEDURE DIVISION.                                                      
036700 BEGIN-0000.                                                              
036800     CALL   INTRINSIC "WHO"                                               
036900     USING  WHO-MODE WHO-CAPABILITY WHO-LATTR WHO-USERN                   
037000            WHO-GROUPN WHO-ACCTN WHO-HOMEN WHO-TERM-DEV-NO.               
037100     MOVE WHO-MODE TO AMSMODE.                                            
037200     IF WHO-ACCTN(1:3) <> "SYS" OR                                        
037300        WHO-USERN(1:7) <> "MANAGER" OR                                    
037400        WHO-GROUPN(1:3) <> "J3K"                                          
037500       DISPLAY "PLEASE LOGON AS MANAGER.SYS,J3K"                          
037600       DISPLAY "This program will not run as "                            
037700               WHO-USERN "." WHO-ACCTN "," WHO-GROUPN                     
037800       STOP RUN.                                                          
037900     Move "Turbo Image/SQL Documentation Tool version C.8.4" to m.        
038000     PERFORM MSG-PROCESS.                                                 
038100     Move "------------------------------------------------" to m.        
038200     PERFORM MSG-PROCESS.                                                 
038300     Move "***             MIG900.PUB.J3K               ***" to m.        
038400     PERFORM MSG-PROCESS.                                                 
038500     Move "***                                          ***" to m.        
038600     PERFORM MSG-PROCESS.                                                 
038700     Move "***       Creating J3K file structure        ***" to m.        
038800     PERFORM MSG-PROCESS.                                                 
038900     Move "***                                          ***" to m.        
039000     PERFORM MSG-PROCESS.                                                 
039100     Move "------------------------------------------------" to m.        
039200     PERFORM MSG-PROCESS.                                                 
039300     Move "Copyright 2007 TIW Corporation" to m.                  100627ma
039400     PERFORM MSG-PROCESS.                                                 
039500     CALL "GETCURRENT" USING TDAY TNUMDAY TDOW.                           
039600*    INITIALIZE DDAY DNUMDAY DDOW.                                        
039700*    MOVE "20070520" TO DDAY.                                             
039800*    CALL "DAYNUM" USING DDAY DNUMDAY DDOW.                               
039900*    COMPUTE DCNT = DNUMDAY - TNUMDAY.                                    
040000*    IF DCNT < 0                                                          
040100*     MOVE "--------------------------------------------" to m            
040200*    PERFORM MSG-PROCESS                                                  
040300*     MOVE "***                                      ***" to m            
040400*    PERFORM MSG-PROCESS                                                  
040500*     MOVE "***                                      ***" to m            
040600*    PERFORM MSG-PROCESS                                                  
040700*     MOVE "***   This DEMO version has expired      ***" to m            
040800*    PERFORM MSG-PROCESS                                                  
040900*     MOVE "***   Email: Support@J3KSolutions.com    ***" to m            
041000*    PERFORM MSG-PROCESS                                                  
041100*     MOVE "***                                      ***" to m            
041200*    PERFORM MSG-PROCESS                                                  
041300*     MOVE "***                                      ***" to m            
041400*    PERFORM MSG-PROCESS                                                  
041500*     MOVE "--------------------------------------------" to m            
041600*    PERFORM MSG-PROCESS                                                  
041700*     CALL INTRINSIC "QUIT" USING \0\                                     
041800*    ELSE                                                                 
041900*     MOVE DCNT TO Z2                                                     
042000*     STRING "DEMO Period has " z2 " days remaining."                     
042100*      DELIMITED BY SIZE INTO m                                           
042200*     END-STRING                                                          
042300*     PERFORM MSG-PROCESS.                                                
042400*     MOVE "Expiration date is: May 20, 2007" to m.                       
042500*    PERFORM MSG-PROCESS.                                                 
042600     INITIALIZE WS-LOGON-DESC WS-ERR WS-ERR-MSG.                          
042700     MOVE "J3KDIAG" TO WS-LD-JOB-NAME.                                    
042800     MOVE "MANAGER" TO WS-LD-USER-NAME.                                   
042900     MOVE "J3K"     TO WS-LD-ACCT-NAME.                                   
043000     MOVE "PUB"     TO WS-LD-GROUP-NAME.                                  
043100     CALL "CHGLOGON" USING WS-LOGON-DESC WS-ERR WS-ERR-MSG.               
043200     IF WS-ERR <> 0                                                       
043300      DISPLAY "UNABLE TO CHANGE LOGON"                                    
043400      DISPLAY WS-ERR-MSG                                                  
043500      CALL INTRINSIC "QUIT" USING \3\ END-CALL                            
043600     ELSE                                                                 
043700      CALL   INTRINSIC "WHO"                                              
043800       USING  WHO-MODE WHO-CAPABILITY WHO-LATTR WHO-USERN                 
043900              WHO-GROUPN WHO-ACCTN WHO-HOMEN WHO-TERM-DEV-NO              
044000      END-CALL                                                            
044100     END-IF                                                               
044200     INITIALIZE WS-ERR-MSG                                                
044300     STRING "J3KDIAG," DELIMITED BY SIZE                                  
044400             WHO-USERN DELIMITED BY SPACE                                 
044500             "."       DELIMITED BY SIZE                                  
044600             WHO-ACCTN DELIMITED BY SPACE                                 
044700             ","       DELIMITED BY SIZE                                  
044800             WHO-GROUPN DELIMITED BY SPACES                               
044900         INTO WS-ERR-MSG.                                                 
045000     string "Logon: " delimited by size                                   
045100            ws-err-msg delimited by size into m                           
045200     PERFORM MSG-PROCESS.                                                 
045300     move "Creating the migration database" to m                          
045400     PERFORM MSG-PROCESS.                                                 
045500     Perform ShowTime.                                                    
045600     PERFORM CREATE-MIGDB.                                                
045700     PERFORM GET-HPSUSAN.                                                 
045800     PERFORM GET-HPVERSION.                                               
045900     PERFORM GET-HPCPUNAME.                                               
046000     PERFORM GET-HPLOCIPADDR.                                             
046100     Initialize DATABASE-TABLE My-BaseName.                               
046200     MOVE 128 TO GINFO-LEN.                                               
046300     MOVE 9 TO MIGDB.                                                     
046400     MOVE "MIGDB.PUB.J3K" TO DbName(MIGDB)                                
046500     MOVE ";" TO NULL-ITEM.                                               
046600     CALL "DBOPEN" USING                                                  
046700      DATA-BASE-NAME(MIGDB) NULL-ITEM MODE-1 STATUS-AREA.                 
046800     IF IMAGE-ERRORS PERFORM 9000-IMAGE-ERROR.                            
046900     MOVE STATUS-AREA TO MIGDB-STATUS.                                    
047000     INITIALIZE SRVMST-BUFFER.                                            
047100     Move 1 to SEARCH-KEYI32.                                             
047200     Perform Get-SRVMST-Keyed.                                            
047300     If No-Entry                                                          
047400      MOVE  1 TO SRVMST-SVR-UNIQUE                                        
047500      MOVE  MYHPCPUNAME   TO SRVMST-SVR-NAME                              
047600      MOVE  MYHPLOCIPADDR TO SRVMST-SVR-IPADDR                            
047700      MOVE  MYHpSusan     TO SRVMST-SVR-SUSAN                             
047800      MOVE  MYHPVERSION   TO SRVMST-SVR-MPEVERSION                        
047900      PERFORM LOCK-SRVMST                                                 
048000      PERFORM PUT-SRVMST                                                  
048100      IF NOT IMAGE-ERRORS                                                 
048200       MOVE "File structure created, " TO M                               
048300       PERFORM MSG-PROCESS                                                
048400       Perform ShowTime.                                                  
048500      PERFORM UNLOCK-SRVMST.                                              
048600     CALL "DBCLOSE" USING DATA-BASE-NAME(MIGDB)                           
048700                          NULL-ITEM MODE-1 STATUS-AREA.                   
048800     STOP RUN.                                                            
048900*=================================================================        
049000$page "MISC SubParagraphs"                                                
049100*=================================================================        
049200*---------------------------------------------------------                
049300 GET-NUM.                                                                 
049400D    DISPLAY "GET-NUM".                                                   
049500     INITIALIZE NUM2 NUMDEC NUMERR.                                       
049600     CALL "NUMGET" USING NUM1 NUM2 NUMDEC NUMERR.                         
049700     IF NUMERR NOT = 0 MOVE 0 TO NUM2.                                    
049800     IF NUMDEC NOT = 0 MOVE 0 TO NUM2.                                    
049900*---------------------------------------------------------                
050000 MPE-COMMAND.                                                             
050100D    DISPLAY "MPE-COMMAND".                                               
050200     INITIALIZE CSTR.                                                     
050300     STRING CMD DELIMITED BY "  " %15 DELIMITED BY SIZE INTO CSTR.        
050400     Move 2 To CMSG.                                                      
050500     CALL INTRINSIC "HPCICOMMAND" USING                                   
050600          CSTR CERR CPARM CMSG.                                           
050700     INITIALIZE CMD.                                                      
050800*---------------------------------------------------------                
050900 SHOWTIME.                                                                
051000     CALL INTRINSIC "HPCICOMMAND" USING                                   
051100          SHOWTIME-STR CERR CPARM CMSG.                                   
051200*---------------------------------------------------------                
051300 COPY SRVMST0 OF J3KLIB.                                                  
051400 COPY SRVMST1 OF J3KLIB.                                                  
051500 COPY SRVMST2 OF J3KLIB.                                                  
051600 COPY SRVMST3 OF J3KLIB.                                                  
051700 COPY SRVMST4 OF J3KLIB.                                                  
051800 COPY SRVMST5 OF J3KLIB.                                                  
051900 COPY SRVMST6 OF J3KLIB.                                                  
052000 COPY SRVMST7 OF J3KLIB.                                                  
052100 COPY SRVMST8 OF J3KLIB.                                                  
052200                                                                          
052300*---------------------------------------------------------                
052400 9000-IMAGE-ERROR.                                                        
052500D    DISPLAY "9000-IMAGE-ERROR".                                          
052600     CALL "DBEXPLAIN" USING STATUS-AREA.                                  
052700*---------------------------------------------------------                
052800*---------------------------------------------------------                
052900 9999-RETURN.                                                             
053000D    DISPLAY "9999-RETURN".                                               
053100     GOBACK.                                                              
053200*--------------------------------------------------------                 
053300 GET-HPSUSAN.                                                             
053400     MOVE "HPSUSAN~" TO HPVAR-NAME.                                       
053500     MOVE 1 TO HPVAR-ITEMNUM.                                             
053600     INITIALIZE HPVAR-ITEM HPVAR-STAT.                                    
053700     CALL INTRINSIC "HPCIGETVAR" USING HPVAR-NAME                         
053800         HPVAR-STAT HPVAR-ITEMNUM MYHPSUSAN.                              
053900D     DISPLAY "HPSUSAN: " MYHPSUSAN.                                      
054000                                                                          
054100                                                                          
054200*--------------------------------------------------------                 
054300 GET-HPVERSION.                                                           
054400     MOVE "HPVERSION~" TO HPVAR-NAME.                                     
054500     MOVE 2 TO HPVAR-ITEMNUM.                                             
054600     INITIALIZE MYHPVERSION HPVAR-STAT.                                   
054700     CALL INTRINSIC "HPCIGETVAR" USING HPVAR-NAME                         
054800         HPVAR-STAT HPVAR-ITEMNUM MYHPVERSION.                            
054900D    DISPLAY "HPVERSION: " MYHPVERSION.                                   
055000*--------------------------------------------------------                 
055100 GET-HPCPUNAME.                                                           
055200     MOVE "HPCPUNAME~" TO HPVAR-NAME.                                     
055300     MOVE 2 TO HPVAR-ITEMNUM.                                             
055400     INITIALIZE MYHPCPUNAME HPVAR-STAT.                                   
055500     CALL INTRINSIC "HPCIGETVAR" USING HPVAR-NAME                         
055600         HPVAR-STAT HPVAR-ITEMNUM MYHPCPUNAME.                            
055700D    DISPLAY "HPCPUNAME: " MYHPCPUNAME.                                   
055800                                                                          
055900*--------------------------------------------------------                 
056000 GET-HPLOCIPADDR.                                                         
056100     MOVE "HPLOCIPADDR~" TO HPVAR-NAME.                                   
056200     MOVE 2 TO HPVAR-ITEMNUM.                                             
056300     INITIALIZE MYHPLOCIPADDR HPVAR-STAT.                                 
056400     CALL INTRINSIC "HPCIGETVAR" USING HPVAR-NAME                         
056500         HPVAR-STAT HPVAR-ITEMNUM MYHPLOCIPADDR.                          
056600D    DISPLAY "HPLOCIPADDR: " MYHPLOCIPADDR.                               
056700*---------------------------------------------------------                
056800 CREATE-MIGDB.                                                            
056900     move "Purge STDMSG,temp > $null" to cmd.                             
057000     PERFORM MPE-COMMAND.                                                 
057100     move "Build STDMSG;rec=-80,1,f,ascii;temp" to cmd.                   
057200     PERFORM MPE-COMMAND.                                                 
057300     move "File XIO=STDMSG,oldtemp" to cmd.                               
057400     PERFORM MPE-COMMAND.                                                 
057500     STRING "listfile @.@.@;seleq=[code=-400]"                            
057600            ";format=qualify > *XIO"                                      
057700      DELIMITED BY SIZE INTO CMD.                                         
057800     PERFORM MPE-COMMAND.                                                 
057900     move "Setvar _numrecs Finfo('STDMSG','EOF')" TO CMD                  
058000     PERFORM MPE-COMMAND.                                                 
058100*---------------------------                                              
058200* Number of databases                                                     
058300     MOVE "MIGBASES~" TO HPVAR-NAME.                                      
058400     MOVE 1 TO HPVAR-ITEMNUM.                                             
058500     INITIALIZE MYHPLOCIPADDR HPVAR-STAT.                                 
058600     CALL INTRINSIC "HPCIGETVAR" USING HPVAR-NAME                         
058700         HPVAR-STAT HPVAR-ITEMNUM HPVAR-ITEM.                             
058800     MOVE HPVAR-ITEM TO DISPZ4.                                           
058900    STRING "Number of Databases on this server:       " DISPZ4            
059000        DELIMITED BY SIZE INTO M.                                         
059100     PERFORM MSG-PROCESS.                                                 
059200     MOVE HPVAR-ITEM TO MYDBCAP.                                          
059300*---------------------------                                              
059400* Number of data sets                                                     
059500     MOVE "MIGSETS~" TO HPVAR-NAME.                                       
059600     MOVE 1 TO HPVAR-ITEMNUM.                                             
059700     INITIALIZE MYHPLOCIPADDR HPVAR-STAT.                                 
059800     CALL INTRINSIC "HPCIGETVAR" USING HPVAR-NAME                         
059900         HPVAR-STAT HPVAR-ITEMNUM HPVAR-ITEM.                             
060000     MOVE HPVAR-ITEM TO DISPZ4.                                           
060100    STRING "Number of Data sets on this server:       " DISPZ4            
060200        DELIMITED BY SIZE INTO M.                                         
060300     PERFORM MSG-PROCESS.                                                 
060400     MOVE HPVAR-ITEM TO MYDSCAP.                                          
060500                                                                          
060600*---------------------------                                              
060700* Number of data fields                                                   
060800     MOVE "MIGFIELDS~" TO HPVAR-NAME.                                     
060900     MOVE 1 TO HPVAR-ITEMNUM.                                             
061000     INITIALIZE MYHPLOCIPADDR HPVAR-STAT.                                 
061100     CALL INTRINSIC "HPCIGETVAR" USING HPVAR-NAME                         
061200         HPVAR-STAT HPVAR-ITEMNUM HPVAR-ITEM.                             
061300     MOVE HPVAR-ITEM TO DISPZ4.                                           
061400    STRING "Number of Data fields on this server:     " DISPZ4            
061500        DELIMITED BY SIZE INTO M.                                         
061600     PERFORM MSG-PROCESS.                                                 
061700     MOVE HPVAR-ITEM TO MYFLDCAP.                                         
061800*****************     compute MYFLDCAP = ( MYFLDCAP * 2 ).                
061900                                                                          
062000*---------------------------                                              
062100* Number of formfiles                                                     
062200     MOVE "MIG_FM_FILES~" TO HPVAR-NAME.                                  
062300     MOVE 1 TO HPVAR-ITEMNUM.                                             
062400     INITIALIZE MYHPLOCIPADDR HPVAR-STAT.                                 
062500     CALL INTRINSIC "HPCIGETVAR" USING HPVAR-NAME                         
062600         HPVAR-STAT HPVAR-ITEMNUM HPVAR-ITEM.                             
062700     MOVE HPVAR-ITEM TO DISPZ4.                                           
062800    STRING "Number of formsfiles on this server:      " DISPZ4            
062900        DELIMITED BY SIZE INTO M.                                         
063000     PERFORM MSG-PROCESS.                                                 
063100     MOVE HPVAR-ITEM TO MYFFILCAP.                                        
063200                                                                          
063300*---------------------------                                              
063400* Number of formsfile forms                                               
063500     MOVE "MIG_FM_FORMS~" TO HPVAR-NAME.                                  
063600     MOVE 1 TO HPVAR-ITEMNUM.                                             
063700     INITIALIZE MYHPLOCIPADDR HPVAR-STAT.                                 
063800     CALL INTRINSIC "HPCIGETVAR" USING HPVAR-NAME                         
063900         HPVAR-STAT HPVAR-ITEMNUM HPVAR-ITEM.                             
064000     MOVE HPVAR-ITEM TO DISPZ4.                                           
064100    STRING "Number of formsfile forms on this server: " DISPZ4            
064200        DELIMITED BY SIZE INTO M.                                         
064300     PERFORM MSG-PROCESS.                                                 
064400     MOVE HPVAR-ITEM TO MYFMCAP.                                          
064500                                                                          
064600*---------------------------                                              
064700* Number of formsfile fields                                              
064800     MOVE "MIG_FM_FIELDS~" TO HPVAR-NAME.                                 
064900     MOVE 1 TO HPVAR-ITEMNUM.                                             
065000     INITIALIZE MYHPLOCIPADDR HPVAR-STAT.                                 
065100     CALL INTRINSIC "HPCIGETVAR" USING HPVAR-NAME                         
065200         HPVAR-STAT HPVAR-ITEMNUM HPVAR-ITEM.                             
065300     MOVE HPVAR-ITEM TO DISPZ4.                                           
065400    STRING "Number of formsfile fields on this server: " DISPZ4           
065500        DELIMITED BY SIZE INTO M.                                         
065600     PERFORM MSG-PROCESS.                                                 
065700     MOVE HPVAR-ITEM TO MYFFFLDCAP.                                       
065800                                                                          
065900*---------------------------                                      080828ma
066000* Number of fields Specs                                          080828ma
066100     MOVE "MIG_FM_SPECS~" TO HPVAR-NAME.                          080828ma
066200     MOVE 1 TO HPVAR-ITEMNUM.                                     080828ma
066300     INITIALIZE MYHPLOCIPADDR HPVAR-STAT.                         080828ma
066400     CALL INTRINSIC "HPCIGETVAR" USING HPVAR-NAME                 080828ma
066500         HPVAR-STAT HPVAR-ITEMNUM HPVAR-ITEM.                     080828ma
066600     MOVE HPVAR-ITEM TO DISPZ4.                                   080828ma
066700    STRING "Processing Specs on this server: " DISPZ4             081117ma
066800        DELIMITED BY SIZE INTO M.                                 080828ma
066900     PERFORM MSG-PROCESS.                                         080828ma
067000     MOVE HPVAR-ITEM TO MYFFspecCAP.                              080828ma
067100                                                                  080828ma
067200     MOVE "PURGE SCHEM" to CMD.                                           
067300     PERFORM MPE-COMMAND.                                                 
067400     STRING "BUILD SCHEM" Delimited By Size                               
067500       ";REC=-80,1,F,ASCII;DISC=2048" Delimited by Size InTO CMD.         
067600     PERFORM MPE-COMMAND.                                                 
067700     OPEN OUTPUT SCHEMA-FILE.                                             
067800*// **************************************************************        
067900     MOVE "$control BlockMax = 2048                  " TO SCHMA.          
068000     WRITE SCHMA.                                                         
068100     INITIALIZE SCHMA.                                                    
068200     STRING "<< J3K Solutions MIGRATION SCHEMA >>"                        
068300      DELIMITED BY SIZE INTO SCHMA.                                       
068400     WRITE SCHMA.                                                         
068500     MOVE "Begin data base MIGDB;                    " TO SCHMA.          
068600     WRITE SCHMA.                                                         
068700     MOVE "Passwords:                                " TO SCHMA.          
068800     WRITE SCHMA.                                                         
068900     MOVE "  3 J3K ;                                 " TO SCHMA.          
069000     WRITE SCHMA.                                                         
069100     MOVE "                                          " TO SCHMA.          
069200     WRITE SCHMA.                                                         
069300     MOVE "Items:                                    " TO SCHMA.          
069400     WRITE SCHMA.                                                         
069500     MOVE "    ANYNAME16     , X16;                 " TO SCHMA.           
069600     WRITE SCHMA.                                                         
069700     MOVE "    ANYNAME28     , X28;                 " TO SCHMA.           
069800     WRITE SCHMA.                                                         
069900     MOVE "    BUF-LEN       ,  I4;                 " TO SCHMA.           
070000     WRITE SCHMA.                                                         
070100     MOVE "    BUF-X         ,  I4;                 " TO SCHMA.           
070200     WRITE SCHMA.                                                         
070300     MOVE "    BUF-Y         ,  I4;                 " TO SCHMA.           
070400     WRITE SCHMA.                                                         
070500     MOVE "    DATAPATH      , X128;                " TO SCHMA.           
070600     WRITE SCHMA.                                                         
070700     MOVE "    DB-ACCT       ,  X8;                 " TO SCHMA.           
070800     WRITE SCHMA.                                                         
070900     MOVE "    DB-BYTES      ,  I4;                 " TO SCHMA.           
071000     WRITE SCHMA.                                                         
071100     MOVE "    DB-COST       ,  I4;                 " TO SCHMA.           
071200     WRITE SCHMA.                                                         
071300     MOVE "    DB-CREATOR    ,  X8;                 " TO SCHMA.           
071400     WRITE SCHMA.                                                         
071500     MOVE "    DB-GROUP      ,  X8;                 " TO SCHMA.           
071600     WRITE SCHMA.                                                         
071700     MOVE "    DB-MIG        ,  X2;                 " TO SCHMA.           
071800     WRITE SCHMA.                                                         
071900     MOVE "    DB-NAME       , X28;                 " TO SCHMA.           
072000     WRITE SCHMA.                                                         
072100     MOVE "    DB-RECCNT     ,  I4;                 " TO SCHMA.           
072200     WRITE SCHMA.                                                         
072300     MOVE "    DB-SETCNT     ,  I4;                 " TO SCHMA.           
072400     WRITE SCHMA.                                                         
072500     MOVE "    DB-UNIQUE     ,  I2;                 " TO SCHMA.           
072600     WRITE SCHMA.                                                         
072700     MOVE "    DS-BYTES      ,  I4;                 " TO SCHMA.           
072800     WRITE SCHMA.                                                         
072900     MOVE "    DS-COST       ,  I4;                 " TO SCHMA.           
073000     WRITE SCHMA.                                                         
073100     MOVE "    DS-NAME       , X16;                 " TO SCHMA.           
073200     WRITE SCHMA.                                                         
073300     MOVE "    DS-RECCNT     ,  I4;                 " TO SCHMA.           
073400     WRITE SCHMA.                                                         
073500     MOVE "    DS-RECLEN     ,  I4;                 " TO SCHMA.           
073600     WRITE SCHMA.                                                         
073700     MOVE "    DS-TYPE       ,  X2;                 " TO SCHMA.           
073800     WRITE SCHMA.                                                         
073900     MOVE "    DS-UNIQUE     ,  I2;                 " TO SCHMA.           
074000     WRITE SCHMA.                                                 100226ma
074210     MOVE "    DEF-ENH       ,  X4;                 " TO SCHMA.   100226ma
074211     WRITE SCHMA.                                                 100226ma
074230     MOVE "    DEF-TYPE      ,  X4;                 " TO SCHMA.   100226ma
074231     WRITE SCHMA.                                                 100226ma
074250     MOVE "    ERR-ENH       ,  X4;                 " TO SCHMA.   100226ma
074260     WRITE SCHMA.                                                         
074300     MOVE "    VFIL-ACCT     ,  X8;                 " TO SCHMA.           
074400     WRITE SCHMA.                                                         
074500     MOVE "    VFIL-BYTES    ,  I4;                 " TO SCHMA.           
074600     WRITE SCHMA.                                                         
074700     MOVE "    VFIL-COST     ,  I4;                 " TO SCHMA.           
074800     WRITE SCHMA.                                                         
074900     MOVE "    VFIL-CREATOR  ,  X8;                 " TO SCHMA.           
075000     WRITE SCHMA.                                                         
075100     MOVE "    VFIL-GROUP    ,  X8;                 " TO SCHMA.           
075200     WRITE SCHMA.                                                         
075300     MOVE "    VFIL-MIG      ,  X2;                 " TO SCHMA.           
075400     WRITE SCHMA.                                                         
075500     MOVE "    VFIL-NAME     , X28;                 " TO SCHMA.           
075600     WRITE SCHMA.                                                         
075700     MOVE "    VFIL-TYPE     ,  X8;                 " TO SCHMA.           
075800     WRITE SCHMA.                                                         
075900     MOVE "    VFIL-UNIQUE   ,  I2;                 " TO SCHMA.           
076000     WRITE SCHMA.                                                         
076100     MOVE "    IFLD-CVT-METHD, X16;                 " TO SCHMA.           
076200     WRITE SCHMA.                                                         
076300     MOVE "    VFLD-DATATYPE  ,  X4;                 " TO SCHMA.          
076400     WRITE SCHMA.                                                         
076500     MOVE "    VFLD-INITVAL   ,  X80;                 " TO SCHMA. 080828ma
076600     WRITE SCHMA.                                                 080828ma
076700     MOVE "    VFLD-ENHANCE   ,  X4;                 " TO SCHMA.          
076800     WRITE SCHMA.                                                         
076900     MOVE "    IFLD-LEN       ,  I2;                 " TO SCHMA.          
077000     WRITE SCHMA.                                                         
077100     MOVE "    VFLD-LENGTH    ,  I2;                 " TO SCHMA.          
077200     WRITE SCHMA.                                                         
077300     MOVE "    IFLD-MAX-VAL , X64;                 " TO SCHMA.            
077400     WRITE SCHMA.                                                         
077500     MOVE "    IFLD-MIN-VAL , X64;                 " TO SCHMA.            
077600     WRITE SCHMA.                                                         
077700     MOVE "    IFLD-NAME      , X16;                 " TO SCHMA.          
077800     WRITE SCHMA.                                                         
077900     MOVE "    VFLD-NAME      , X16;                 " TO SCHMA.          
078000     WRITE SCHMA.                                                         
078100     MOVE "    IFLD-NUM       ,  I2;                 " TO SCHMA.          
078200     WRITE SCHMA.                                                         
078300     MOVE "    VFLD-NUM       ,  I2;                 " TO SCHMA.          
078400     WRITE SCHMA.                                                         
078500     MOVE "    IFLD-POSITION  ,  I2;                 " TO SCHMA.          
078600     WRITE SCHMA.                                                         
078700     MOVE "    VFLD-POSITION  ,  I2;                 " TO SCHMA.          
078800     WRITE SCHMA.                                                         
078900     MOVE "    IFLD-SUBLEN    ,  I2;                 " TO SCHMA.          
079000     WRITE SCHMA.                                                         
079100     MOVE "    IFLD-TYPE      ,  X2;                 " TO SCHMA.          
079200     WRITE SCHMA.                                                         
079300     MOVE "    VFLD-TYPE     ,  X4;                 " TO SCHMA.           
079400     WRITE SCHMA.                                                         
079500     MOVE "    IFLD-UNIQUE    ,  I2;                 " TO SCHMA.          
079600     WRITE SCHMA.                                                         
079700     MOVE "    VFLD-UNIQUE    ,  I2;                 " TO SCHMA.          
079800     WRITE SCHMA.                                                         
079900     MOVE "    IFLD-X         ,  I2;                 " TO SCHMA.          
080000     WRITE SCHMA.                                                         
080100     MOVE "    IFLD-Y         ,  I2;                 " TO SCHMA.          
080200     WRITE SCHMA.                                                         
080300     MOVE "    FLDCNT        ,  I4;                 " TO SCHMA.           
080400     WRITE SCHMA.                                                         
080500     MOVE "    FM-UNIQUE     ,  I2;                 " TO SCHMA.           
080600     WRITE SCHMA.                                                         
080700     MOVE "    FRM-NAME      , X16;                 " TO SCHMA.           
080800     WRITE SCHMA.                                                         
080900     MOVE "    FRM-NUMBER    ,  I2;                 " TO SCHMA.           
081000     WRITE SCHMA.                                                         
081100     MOVE "    FTP-IPADDR    , X16;                 " TO SCHMA.           
081200     WRITE SCHMA.                                                         
081300     MOVE "    FTP-NAME      , X16;                 " TO SCHMA.           
081400     WRITE SCHMA.                                                         
081500     MOVE "    FTP-USER      , X16;                 " TO SCHMA.           
081600     WRITE SCHMA.                                                         
081700     MOVE "    FTP-WORD      , X16;                 " TO SCHMA.           
081800     WRITE SCHMA.                                                         
081900     MOVE "    HEAD-FRM      , X16;                 " TO SCHMA.           
082000     WRITE SCHMA.                                                         
082100     MOVE "    LOGPATH       , X128;                " TO SCHMA.           
082200     WRITE SCHMA.                                                         
082300     MOVE "    MAX-BUF       ,  I2;                 " TO SCHMA.           
082400     WRITE SCHMA.                                                         
082500     MOVE "    MAX-FLDS      ,  I2;                 " TO SCHMA.           
082600     WRITE SCHMA.                                                         
082700     MOVE "    NBR-OF-FORMS  ,  I2;                 " TO SCHMA.           
082800     WRITE SCHMA.                                                         
082900     MOVE "    NEXT-FRM      , X16;                 " TO SCHMA.           
083000     WRITE SCHMA.                                                         
083100     MOVE "    NFORM-OPT     , X2;                 " TO SCHMA.            
083200     WRITE SCHMA.                                                         
083300     MOVE "    PAN-NAME      , X16;                 " TO SCHMA.           
083400     WRITE SCHMA.                                                         
083500     MOVE "    PAN-TYPE      , X6;                  " TO SCHMA.           
083510     WRITE SCHMA.                                                 081215ma
083610     MOVE "    PRODNAME1      , X36;                " TO SCHMA.   081215ma
083700     WRITE SCHMA.                                                 081215ma
083800     MOVE "    PRODNAME2      , X36;                " TO SCHMA.   081215ma
083900     WRITE SCHMA.                                                 081215ma
084000     MOVE "    PRODNAME3      , X36;                " TO SCHMA.   081215ma
084100     WRITE SCHMA.                                                 081215ma
084900     MOVE "  PRSPEC-SEQ      , I2;                  " TO SCHMA.           
085000     WRITE SCHMA.                                                         
085100     MOVE "  FDSPEC-TEXT     , 15X80;               " TO SCHMA.   081124ma
085200     WRITE SCHMA.                                                 081124ma
085300     MOVE "  PRSPEC-TEXT     , X80;                  " TO SCHMA.  081124ma
085400     WRITE SCHMA.                                                 081124ma
085500     MOVE "    REPEAT-OPT    , X2;                  " TO SCHMA.           
085600     WRITE SCHMA.                                                         
085700     MOVE "    SAVE-FLDS     ,  I2;                 " TO SCHMA.           
085800     WRITE SCHMA.                                                         
085900     MOVE "    SERV-NAME     ,  X8;                 " TO SCHMA.           
086000     WRITE SCHMA.                                                         
086100     MOVE "    SERV-PORT     ,  Z6;                 " TO SCHMA.           
086200     WRITE SCHMA.                                                         
086300     MOVE "    SERV-PROG     , X28;                 " TO SCHMA.           
086400     WRITE SCHMA.                                                         
086500     MOVE "    SQL-NAME      , X32;                 " TO SCHMA.           
086600     WRITE SCHMA.                                                         
086700     MOVE "    SQL-TYPE      , X16;                 " TO SCHMA.           
086800     WRITE SCHMA.                                                         
086900     MOVE "    SRN-ORD-NUM   ,  I2;                 " TO SCHMA.           
087000     WRITE SCHMA.                                                         
087100     MOVE "    SRN-SX        ,  I2;                 " TO SCHMA.   080812ma
087200     WRITE SCHMA.                                                 080812ma
087300     MOVE "    SRN-SY        ,  I2;                 " TO SCHMA.   080812ma
087400     WRITE SCHMA.                                                 080812ma
087500     MOVE "    SRN-EX        ,  I2;                 " TO SCHMA.   080812ma
087600     WRITE SCHMA.                                                 080812ma
087700     MOVE "    SRN-EY        ,  I2;                 " TO SCHMA.   080812ma
087800     WRITE SCHMA.                                                 080812ma
087900     MOVE "    SVR-DBCNT     ,  I4;                 " TO SCHMA.           
088000     WRITE SCHMA.                                                         
088100     MOVE "    SVR-DSCNT     ,  I4;                 " TO SCHMA.           
088200     WRITE SCHMA.                                                         
088300     MOVE "    SVR-FLDCNT    ,  I4;                 " TO SCHMA.           
088400     WRITE SCHMA.                                                         
088500     MOVE "    SVR-VFILCNT   ,  I4;                 " TO SCHMA.           
088600     WRITE SCHMA.                                                         
088700     MOVE "    SVR-VFRMCNT   ,  I4;                 " TO SCHMA.           
088800     WRITE SCHMA.                                                         
088900     MOVE "    SVR-VFLDCNT   ,  I4;                 " TO SCHMA.           
089000     WRITE SCHMA.                                                         
089100     MOVE "    SVR-IPADDR    , X16;                 " TO SCHMA.           
089200     WRITE SCHMA.                                                         
089300     MOVE "    SVR-MPEVERSION,  X8;                 " TO SCHMA.           
089400     WRITE SCHMA.                                                         
089500     MOVE "    SVR-NAME      , X24;                 " TO SCHMA.           
089600     WRITE SCHMA.                                                         
089700     MOVE "    SVR-REC-COST  ,  I4;                 " TO SCHMA.           
089800     WRITE SCHMA.                                                         
089900     MOVE "    SVR-RECCNT    ,  I4;                 " TO SCHMA.           
090000     WRITE SCHMA.                                                         
090100     MOVE "    SVR-SUSAN     ,  I2;                 " TO SCHMA.           
090200     WRITE SCHMA.                                                         
090300     MOVE "    SVR-UNIQUE    ,  I2;                 " TO SCHMA.           
090400     WRITE SCHMA.                                                         
090500     MOVE "    UNIQ-ID       ,  X8;                 " TO SCHMA.           
090600     WRITE SCHMA.                                                         
090700     MOVE "    UNIQ-NUM      ,  I2;                 " TO SCHMA.           
090800     WRITE SCHMA.                                                         
090900     MOVE "    VERSION       ,  I4;                 " TO SCHMA.           
091000     WRITE SCHMA.                                                         
091100     MOVE "    WIN-ENH       ,  x4;                 " TO SCHMA.           
091200     WRITE SCHMA.                                                         
091300     MOVE "    WIN-POS       ,  I2;                 " TO SCHMA.           
091400     WRITE SCHMA.                                                         
091500     MOVE "    WS-NAME       , X16;                 " TO SCHMA.           
091600     WRITE SCHMA.                                                         
091700     MOVE "    WS-OCTET1     ,  I2;                 " TO SCHMA.           
091800     WRITE SCHMA.                                                         
091900     MOVE "    WS-OCTET2     ,  I2;                 " TO SCHMA.           
092000     WRITE SCHMA.                                                         
092100     MOVE "    WS-OCTET3     ,  I2;                 " TO SCHMA.           
092200     WRITE SCHMA.                                                         
092300     MOVE "    WS-OCTET4     ,  I2;                 " TO SCHMA.           
092400     WRITE SCHMA.                                                 080902ma
092500     MOVE "    REPRODUCED-FR ,  X16;                " TO SCHMA.   080902ma
092600     WRITE SCHMA.                                                 080902ma
092700     MOVE "    FKEY-DEF      ,  X2;                 " TO SCHMA.   080902ma
092800     WRITE SCHMA.                                                 080902ma
092900     MOVE "    COMMENT       ,  X80;                " TO SCHMA.   080902ma
093000     WRITE SCHMA.                                                 080902ma
093010     MOVE "    DEFAULT-FTYPE ,  X2;                 " TO SCHMA.   100627ma
093110     WRITE SCHMA.                                                 100627ma
093111     MOVE "    DEFAULT-DTYPE ,  X4;                 " TO SCHMA.   100627ma
093130     WRITE SCHMA.                                                 100627ma
093140     MOVE "                                         " TO SCHMA.           
093200     WRITE SCHMA.                                                         
093300     MOVE "                                         " TO SCHMA.           
093400     WRITE SCHMA.                                                         
093500     MOVE "  Sets:                                  " TO SCHMA.           
093600     WRITE SCHMA.                                                         
093700*// **************************************************************        
093800*//  DATASET:                              DBUNIQ-MSTR                    
093900     IF MYDBCAP < 1 MOVE 20 TO MYDBCAP.                                   
094000     COMPUTE MYDBCAP = MYDBCAP * 1.2.                                     
094100     MOVE MYDBCAP TO DISP-99                                              
094200     MOVE "Name: DBUNIQ-MSTR      , Automatic(3/3);" TO SCHMA.            
094300     WRITE SCHMA.                                                         
094400     MOVE "Entry:" TO SCHMA.                                              
094500     WRITE SCHMA.                                                         
094600     MOVE "DB-UNIQUE       (3);" TO SCHMA.                                
094700     WRITE SCHMA.                                                         
094800     INITIALIZE SCHMA.                                                    
094900     STRING "Cap:" DISP-99 ";" DELIMITED BY SIZE INTO SCHMA.              
095000     WRITE SCHMA.                                                         
095100*// **************************************************************        
095200*//  DATASET:                              DSUNIQ-MSTR                    
095300     IF MYDSCAP < 1 MOVE 20 TO MYDSCAP.                                   
095400     COMPUTE MYDSCAP = MYDSCAP * 1.2.                                     
095500     MOVE MYDSCAP TO DISP-99                                              
095600     MOVE "Name: DSUNIQ-MSTR      , Automatic(3/3);" TO SCHMA.            
095700     WRITE SCHMA.                                                         
095800     MOVE "Entry:" TO SCHMA.                                              
095900     WRITE SCHMA.                                                         
096000     MOVE "DS-UNIQUE       (2);" TO SCHMA.                                
096100     WRITE SCHMA.                                                         
096200     INITIALIZE SCHMA.                                                    
096300     STRING "Cap:" DISP-99 ";" DELIMITED BY SIZE INTO SCHMA.              
096400     WRITE SCHMA.                                                         
096500*// **************************************************************        
096600*//  DATASET:                              FLDUNIQ-MSTR                   
096700     IF MYFLDCAP < 1 MOVE 20 TO MYFLDCAP.                                 
096800     MOVE MYFLDCAP TO DISP-99                                             
096900     MOVE "Name: FLDUNIQ-MSTR      , Automatic(3/3);" TO SCHMA.           
097000     WRITE SCHMA.                                                         
097100     MOVE "Entry:" TO SCHMA.                                              
097200     WRITE SCHMA.                                                         
097300     MOVE "IFLD-UNIQUE       (1);" TO SCHMA.                              
097400     WRITE SCHMA.                                                         
097500     INITIALIZE SCHMA.                                                    
097600     STRING "Cap:" DISP-99 ";" DELIMITED BY SIZE INTO SCHMA.              
097700     WRITE SCHMA.                                                         
097800*// **************************************************************        
097900*//  DATASET:                              VFLDUNIQ-MSTR                  
098000     IF MYFFFLDCAP < 1 MOVE 20 TO MYFFFLDCAP.                             
098100     MOVE MYFFFLDCAP TO DISP-99                                           
098200     MOVE "Name: VFLDUNIQ-MSTR      , Automatic(3/3);" TO SCHMA.          
098300     WRITE SCHMA.                                                         
098400     MOVE "Entry:" TO SCHMA.                                              
098500     WRITE SCHMA.                                                         
098600     MOVE "VFLD-UNIQUE       (2);" TO SCHMA.                              
098700     WRITE SCHMA.                                                         
098800     INITIALIZE SCHMA.                                                    
098900     STRING "Cap:" DISP-99 ";" DELIMITED BY SIZE INTO SCHMA.              
099000     WRITE SCHMA.                                                         
099100*// **************************************************************        
099200*//  DATASET:                              FFUNIQ-MSTR                    
099300     IF MYFFILCAP < 1 MOVE 20 TO MYFFILCAP.                               
099400     MOVE MYFFILCAP TO DISP-99                                            
099500     MOVE "Name: FFUNIQ-MSTR      , Automatic(3/3);" TO SCHMA.            
099600     WRITE SCHMA.                                                         
099700     MOVE "Entry:" TO SCHMA.                                              
099800     WRITE SCHMA.                                                         
099900     MOVE "VFIL-UNIQUE       (3);" TO SCHMA.                              
100000     WRITE SCHMA.                                                         
100100     INITIALIZE SCHMA.                                                    
100200     STRING "Cap:" DISP-99 ";" DELIMITED BY SIZE INTO SCHMA.              
100300     WRITE SCHMA.                                                         
100400*// **************************************************************        
100500*//  DATASET:                              FMUNIQ-MSTR                    
100600     IF MYFMCAP < 1 MOVE 20 TO MYFMCAP.                                   
100700     MOVE MYFMCAP TO DISP-99                                              
100800     MOVE "Name: FMUNIQ-MSTR      , Automatic(3/3);" TO SCHMA.            
100900     WRITE SCHMA.                                                         
101000     MOVE "Entry:" TO SCHMA.                                              
101100     WRITE SCHMA.                                                         
101200     MOVE "VFIL-UNIQUE       (2);" TO SCHMA.                              
101300     WRITE SCHMA.                                                         
101400     INITIALIZE SCHMA.                                                    
101500     STRING "Cap:" DISP-99 ";" DELIMITED BY SIZE INTO SCHMA.              
101600     WRITE SCHMA.                                                         
101700                                                                          
101800                                                                          
101900*// **************************************************************        
102000*//  DATASET:                              NAME28MSTR                     
102100     MOVE MYFMCAP TO DISP-99                                              
102200     MOVE "Name: NAME28MSTR      , Automatic(3/3);" TO SCHMA.             
102300     WRITE SCHMA.                                                         
102400     MOVE "Entry:" TO SCHMA.                                              
102500     WRITE SCHMA.                                                         
102600     MOVE "ANYNAME28       (2);" TO SCHMA.                                
102700     WRITE SCHMA.                                                         
102800     INITIALIZE SCHMA.                                                    
102900     STRING "Cap:" DISP-99 ";" DELIMITED BY SIZE INTO SCHMA.              
103000     WRITE SCHMA.                                                         
103100*// **************************************************************        
103200*//  DATASET:                              NAME16MSTR                     
103300     COMPUTE MY16CAP = MYDSCAP + MYFFFLDCAP.                              
103400     MOVE MY16CAP TO DISP-99                                              
103500     MOVE "Name: NAME16MSTR      , Automatic(3/3);" TO SCHMA.             
103600     WRITE SCHMA.                                                         
103700     MOVE "Entry:" TO SCHMA.                                              
103800     WRITE SCHMA.                                                         
103900     MOVE "ANYNAME16       (4);" TO SCHMA.                                
104000     WRITE SCHMA.                                                         
104100     INITIALIZE SCHMA.                                                    
104200     STRING "Cap:" DISP-99 ";" DELIMITED BY SIZE INTO SCHMA.              
104300     WRITE SCHMA.                                                         
104400*// **************************************************************        
104500*//  DATASET:                              SERVER-MSTR                    
104600     MOVE "Name: SERVER-MSTR,      MANUAL   (3/3);" TO SCHMA.             
104700     WRITE SCHMA.                                                         
104800     MOVE "Entry:                                 " TO SCHMA.             
104900     WRITE SCHMA.                                                         
105000     MOVE "  SVR-UNIQUE   (6),                    " TO SCHMA.             
105100     WRITE SCHMA.                                                         
105200     MOVE "  SVR-NAME        ,                    " TO SCHMA.             
105300     WRITE SCHMA.                                                         
105400     MOVE "  SVR-IPADDR      ,                    " TO SCHMA.             
105500     WRITE SCHMA.                                                         
105600     MOVE "  SVR-DBCNT       ,                    " TO SCHMA.             
105700     WRITE SCHMA.                                                         
105800     MOVE "  SVR-DSCNT       ,                    " TO SCHMA.             
105900     WRITE SCHMA.                                                         
106000     MOVE "  SVR-FLDCNT      ,                    " TO SCHMA.             
106100     WRITE SCHMA.                                                         
106200     MOVE "  SVR-RECCNT      ,                    " TO SCHMA.             
106300     WRITE SCHMA.                                                         
106400     MOVE "  SVR-VFILCNT     ,                    " TO SCHMA.             
106500     WRITE SCHMA.                                                         
106600     MOVE "  SVR-VFRMCNT     ,                    " TO SCHMA.             
106700     WRITE SCHMA.                                                         
106800     MOVE "  SVR-VFLDCNT     ,                    " TO SCHMA.             
106900     WRITE SCHMA.                                                         
107000     MOVE "  SVR-SUSAN       ,                    " TO SCHMA.             
107100     WRITE SCHMA.                                                         
107200     MOVE "  SVR-REC-COST    ,                    " TO SCHMA.             
107300     WRITE SCHMA.                                                         
107400     MOVE "  SVR-MPEVERSION  ;                    " TO SCHMA.             
107500     WRITE SCHMA.                                                         
107600     MOVE "Cap: 1;                                " TO SCHMA.             
107700     WRITE SCHMA.                                                         
107800     MOVE "                                       " TO SCHMA.             
107900     WRITE SCHMA.                                                         
108000*// **************************************************************        
108100*//  DATASET:                              FTP-MSTR                       
108200     MOVE "Name: FTP-MSTR,      MANUAL   (3/3);   " TO SCHMA.             
108300     WRITE SCHMA.                                                         
108400     MOVE "Entry:                                 " TO SCHMA.             
108500     WRITE SCHMA.                                                         
108600     MOVE "  FTP-NAME     (0),                    " TO SCHMA.             
108700     WRITE SCHMA.                                                         
108800     MOVE "  FTP-USER        ,                    " TO SCHMA.             
108900     WRITE SCHMA.                                                         
109000     MOVE "  FTP-WORD        ,                    " TO SCHMA.             
109100     WRITE SCHMA.                                                         
109200     MOVE "  FTP-IPADDR      ;                    " TO SCHMA.             
109300     WRITE SCHMA.                                                         
109400     MOVE "Cap: 1;                                " TO SCHMA.             
109500     WRITE SCHMA.                                                         
109600     MOVE "                                       " TO SCHMA.             
109700     WRITE SCHMA.                                                         
109800*// **************************************************************        
109900*//  DATASET:                              DB-MSTR                        
110000     MOVE "Name: DB-MSTR,      DETAIL   (3/3);    " TO SCHMA.             
110100     WRITE SCHMA.                                                         
110200     MOVE "Entry:                                 " TO SCHMA.             
110300     WRITE SCHMA.                                                         
110400     MOVE "  SVR-UNIQUE(!SERVER-MSTR(DB-UNIQUE)), " TO SCHMA.             
110500     WRITE SCHMA.                                                         
110600     MOVE "  DB-UNIQUE      (DBUNIQ-MSTR),        " TO SCHMA.             
110700     WRITE SCHMA.                                                         
110800     MOVE "  DB-NAME        (NAME28MSTR),          " TO SCHMA.            
110900     WRITE SCHMA.                                                         
111000     MOVE "  DB-CREATOR     ,                     " TO SCHMA.             
111100     WRITE SCHMA.                                                         
111200     MOVE "  DB-ACCT        ,                     " TO SCHMA.             
111300     WRITE SCHMA.                                                         
111400     MOVE "  DB-GROUP       ,                     " TO SCHMA.             
111500     WRITE SCHMA.                                                         
111600     MOVE "  DB-BYTES       ,                     " TO SCHMA.             
111700     WRITE SCHMA.                                                         
111800     MOVE "  SQL-NAME       ,                     " TO SCHMA.             
111900     WRITE SCHMA.                                                         
112000     MOVE "  DATAPATH       ,                     " TO SCHMA.             
112100     WRITE SCHMA.                                                         
112200     MOVE "  LOGPATH        ,                     " TO SCHMA.             
112300     WRITE SCHMA.                                                         
112400     MOVE "  DB-SETCNT      ,                     " TO SCHMA.             
112500     WRITE SCHMA.                                                         
112600     MOVE "  DB-RECCNT      ,                     " TO SCHMA.             
112700     WRITE SCHMA.                                                         
112800     MOVE "  DB-MIG         ,                     " TO SCHMA.             
112900     WRITE SCHMA.                                                         
113000     MOVE "  DB-COST        ;                     " TO SCHMA.             
113100     WRITE SCHMA.                                                         
113200     MOVE MYDBCAP TO DISP-99.                                             
113300     INITIALIZE SCHMA.                                                    
113400     STRING "Cap:" DISP-99 ";" DELIMITED BY SIZE INTO SCHMA.              
113500     WRITE SCHMA.                                                         
113600     MOVE "                                       " TO SCHMA.             
113700     WRITE SCHMA.                                                         
113800*// **************************************************************        
113900*//  DATASET:                              DS-MSTR                        
114000     MOVE "Name: DS-MSTR,      DETAIL   (3/3);    " TO SCHMA.             
114100     WRITE SCHMA.                                                         
114200     MOVE "Entry:                                 " TO SCHMA.             
114300     WRITE SCHMA.                                                         
114400     MOVE "  DB-UNIQUE (DBUNIQ-MSTR(DS-UNIQUE)),  " TO SCHMA.             
114500     WRITE SCHMA.                                                         
114600     MOVE "  DS-UNIQUE      ( !DSUNIQ-MSTR),      " TO SCHMA.             
114700     WRITE SCHMA.                                                         
114800     MOVE "  SVR-UNIQUE     (SERVER-MSTR),        " TO SCHMA.             
114900     WRITE SCHMA.                                                         
115000     MOVE "  DS-NAME        (NAME16MSTR),         " TO SCHMA.             
115100     WRITE SCHMA.                                                         
115200     MOVE "  SQL-NAME       ,                     " TO SCHMA.             
115300     WRITE SCHMA.                                                         
115400     MOVE "  DS-TYPE        ,                     " TO SCHMA.             
115500     WRITE SCHMA.                                                         
115600     MOVE "  DS-RECCNT      ,                     " TO SCHMA.             
115700     WRITE SCHMA.                                                         
115800     MOVE "  DS-RECLEN      ,                     " TO SCHMA.             
115900     WRITE SCHMA.                                                         
116000     MOVE "  DS-BYTES       ,                     " TO SCHMA.             
116100     WRITE SCHMA.                                                         
116200     MOVE "  DS-COST        ;                     " TO SCHMA.             
116300     WRITE SCHMA.                                                         
116400     MOVE MYDSCAP TO DISP-99.                                             
116500     INITIALIZE SCHMA.                                                    
116600     STRING "Cap:" DISP-99 ";" DELIMITED BY SIZE INTO SCHMA.              
116700     WRITE SCHMA.                                                         
116800     MOVE "                                       " TO SCHMA.             
116900     WRITE SCHMA.                                                         
117000*// **************************************************************        
117100*//  DATASET:                              DB-FIELDS                      
117200*// **************************************************************        
117300     MOVE "Name: DB-FIELDS,      DETAIL   (3/3);  " TO SCHMA.             
117400     WRITE SCHMA.                                                         
117500     MOVE "Entry:                                 " TO SCHMA.             
117600     WRITE SCHMA.                                                         
117700     MOVE "  DS-UNIQUE (DSUNIQ-MSTR(IFLD-UNIQUE)), " TO SCHMA.            
117800     WRITE SCHMA.                                                         
117900     MOVE "  IFLD-UNIQUE     ( !FLDUNIQ-MSTR),     " TO SCHMA.            
118000     WRITE SCHMA.                                                         
118100     MOVE "  DB-UNIQUE      (DBUNIQ-MSTR),        " TO SCHMA.             
118200     WRITE SCHMA.                                                         
118300     MOVE "  SVR-UNIQUE     (SERVER-MSTR),        " TO SCHMA.             
118400     WRITE SCHMA.                                                         
118500     MOVE "  IFLD-NAME       (NAME16MSTR),         " TO SCHMA.            
118600     WRITE SCHMA.                                                         
118700     MOVE "  IFLD-LEN         ,                    " TO SCHMA.            
118800     WRITE SCHMA.                                                         
118900     MOVE "  IFLD-X           ,                    " TO SCHMA.            
119000     WRITE SCHMA.                                                         
119100     MOVE "  IFLD-Y           ,                    " TO SCHMA.            
119200     WRITE SCHMA.                                                         
119300     MOVE "  IFLD-SUBLEN      ,                    " TO SCHMA.            
119400     WRITE SCHMA.                                                         
119500     MOVE "  SQL-NAME        ,                    " TO SCHMA.             
119600     WRITE SCHMA.                                                         
119700     MOVE "  IFLD-TYPE        ,                    " TO SCHMA.            
119800     WRITE SCHMA.                                                         
119900     MOVE "  SQL-TYPE        ,                    " TO SCHMA.             
120000     WRITE SCHMA.                                                         
120100     MOVE "  IFLD-CVT-METHD  ,                    " TO SCHMA.             
120200     WRITE SCHMA.                                                         
120300     MOVE "  IFLD-MAX-VAL   ,                    " TO SCHMA.              
120400     WRITE SCHMA.                                                         
120500     MOVE "  IFLD-MIN-VAL   ;                    " TO SCHMA.              
120600     WRITE SCHMA.                                                         
120700     MOVE MYFLDCAP TO DISP-99.                                            
120800     INITIALIZE SCHMA.                                                    
120900     STRING "Cap:" DISP-99 ";" DELIMITED BY SIZE INTO SCHMA.              
121000     WRITE SCHMA.                                                         
121100     MOVE "                                       " TO SCHMA.             
121200     WRITE SCHMA.                                                         
121300*// **************************************************************        
121400*//  DATASET:                              FFILE-M                        
121500     MOVE "Name: FF-MSTR,      DETAIL   (3/3);    " TO SCHMA.             
121600     WRITE SCHMA.                                                         
121700     MOVE "Entry:                                 " TO SCHMA.             
121800     WRITE SCHMA.                                                         
121900     MOVE "  SVR-UNIQUE(!SERVER-MSTR(VFIL-UNIQUE)), " TO SCHMA.           
122000     WRITE SCHMA.                                                         
122100     MOVE "  VFIL-UNIQUE      (FFUNIQ-MSTR),        " TO SCHMA.           
122200     WRITE SCHMA.                                                         
122300     MOVE "  VFIL-NAME        (NAME28MSTR),          " TO SCHMA.          
122400     WRITE SCHMA.                                                         
122500     MOVE "  VFIL-CREATOR     ,                     " TO SCHMA.           
122600     WRITE SCHMA.                                                         
122700     MOVE "  VFIL-ACCT        ,                     " TO SCHMA.           
122800     WRITE SCHMA.                                                         
122900     MOVE "  VFIL-GROUP       ,                     " TO SCHMA.           
123000     WRITE SCHMA.                                                         
123100     MOVE "  VFIL-BYTES       ,                     " TO SCHMA.           
123200     WRITE SCHMA.                                                         
123300     MOVE "  VFIL-TYPE       ,                     " TO SCHMA.            
123400     WRITE SCHMA.                                                         
123500     MOVE "  PAN-NAME       ,                     " TO SCHMA.             
123600     WRITE SCHMA.                                                         
123700     MOVE "  PRODNAME1      ,                     " TO SCHMA.     081215ma
123800     WRITE SCHMA.                                                 081215ma
123900     MOVE "  PRODNAME2      ,                     " TO SCHMA.     081215ma
124000     WRITE SCHMA.                                                 081215ma
124100     MOVE "  PRODNAME3      ,                     " TO SCHMA.     081215ma
124200     WRITE SCHMA.                                                 081215ma
125100     MOVE "  VERSION        ,                     " TO SCHMA.     081215ma
125200     WRITE SCHMA.                                                         
125300     MOVE "  NBR-OF-FORMS   ,                     " TO SCHMA.             
125400     WRITE SCHMA.                                                         
125500     MOVE "  MAX-FLDS       ,                     " TO SCHMA.     081215ma
125600     WRITE SCHMA.                                                         
125700     MOVE "  MAX-BUF        ,                     " TO SCHMA.     081215ma
125800     WRITE SCHMA.                                                         
125900     MOVE "  SAVE-FLDS      ,                     " TO SCHMA.     081215ma
126000     WRITE SCHMA.                                                         
126100     MOVE "  HEAD-FRM       ,                     " TO SCHMA.     081215ma
126200     WRITE SCHMA.                                                         
126300     MOVE "  DEF-ENH        ,                     " TO SCHMA.     100226ma
126510     WRITE SCHMA.                                                 100226ma
126511     MOVE "  DEF-TYPE       ,                     " TO SCHMA.     100226ma
126530     WRITE SCHMA.                                                 100226ma
126531     MOVE "  ERR-ENH        ,                     " TO SCHMA.     100226ma
126550     WRITE SCHMA.                                                 100226ma
126560     MOVE "  WIN-ENH        ,                     " TO SCHMA.     081215ma
126600     WRITE SCHMA.                                                         
126700     MOVE "  WIN-POS        ,                     " TO SCHMA.     081215ma
126800     WRITE SCHMA.                                                         
126900     MOVE "  VFIL-MIG       ,                     " TO SCHMA.     081215ma
127000     WRITE SCHMA.                                                         
127100     MOVE "  VFIL-COST      ;                     " TO SCHMA.     081215ma
127200     WRITE SCHMA.                                                         
127300     MOVE MYFFILCAP TO DISP-99.                                           
127400     INITIALIZE SCHMA.                                                    
127500     STRING "Cap:" DISP-99 ";" DELIMITED BY SIZE INTO SCHMA.              
127600     WRITE SCHMA.                                                         
127700     MOVE "                                       " TO SCHMA.             
127800     WRITE SCHMA.                                                         
127900*// **************************************************************        
128000*//  DATASET:                              FM-MSTR                        
128100     MOVE "Name: FM-MSTR,      DETAIL   (3/3);    " TO SCHMA.             
128200     WRITE SCHMA.                                                         
128300     MOVE "Entry:                                 " TO SCHMA.             
128400     WRITE SCHMA.                                                         
128500     MOVE "  VFIL-UNIQUE (FFUNIQ-MSTR(FM-UNIQUE)),  " TO SCHMA.           
128600     WRITE SCHMA.                                                         
128700     MOVE "  FM-UNIQUE      ( !FMUNIQ-MSTR),      " TO SCHMA.             
128800     WRITE SCHMA.                                                         
128900     MOVE "  SVR-UNIQUE     (SERVER-MSTR),        " TO SCHMA.             
129000     WRITE SCHMA.                                                         
129100     MOVE "  FRM-NAME        (NAME16MSTR),         " TO SCHMA.            
129200     WRITE SCHMA.                                                         
129300     MOVE "  PAN-NAME        ,                     " TO SCHMA.            
129400     WRITE SCHMA.                                                         
129500     MOVE "  PAN-TYPE        ,                     " TO SCHMA.            
129600     WRITE SCHMA.                                                         
129700     MOVE "  FRM-NUMBER      ,                     " TO SCHMA.            
129800     WRITE SCHMA.                                                         
129900     MOVE "  FLDCNT          ,                     " TO SCHMA.            
130000     WRITE SCHMA.                                                         
130100     MOVE "  BUF-LEN         ,                     " TO SCHMA.            
130200     WRITE SCHMA.                                                         
130300     MOVE "  NEXT-FRM        ,                     " TO SCHMA.            
130400     WRITE SCHMA.                                                         
130500     MOVE "  REPEAT-OPT      ,                     " TO SCHMA.            
130600     WRITE SCHMA.                                                         
130700     MOVE "  NFORM-OPT       ,                     " TO SCHMA.    080902ma
130800     WRITE SCHMA.                                                         
130900     MOVE "  REPRODUCED-FR   ,                     " TO SCHMA.    080902ma
131000     WRITE SCHMA.                                                 080902ma
131100     MOVE "  FKEY-DEF        ,                     " TO SCHMA.    080902ma
131200     WRITE SCHMA.                                                 080902ma
131300     MOVE "  COMMENT         ,                     " TO SCHMA.    100627ma
131400     WRITE SCHMA.                                                 080902ma
131410     MOVE "  DEFAULT-FTYPE   ,                     " TO SCHMA.    100627ma
131510     WRITE SCHMA.                                                 100627ma
131520     MOVE "  DEFAULT-DTYPE   ;                     " TO SCHMA.    100627ma
131531     WRITE SCHMA.                                                 100627ma
131540     MOVE MYFMCAP TO DISP-99.                                             
131600     INITIALIZE SCHMA.                                                    
131700     STRING "Cap:" DISP-99 ";" DELIMITED BY SIZE INTO SCHMA.              
131800     WRITE SCHMA.                                                         
131900     MOVE "                                       " TO SCHMA.             
132000     WRITE SCHMA.                                                         
132100*// **************************************************************        
132200*//  DATASET:                              FM-FIELDS                      
132300*// **************************************************************        
132400     MOVE "Name: FF-FIELDS,      DETAIL   (3/3);  " TO SCHMA.             
132500     WRITE SCHMA.                                                         
132600     MOVE "Entry:                                 " TO SCHMA.             
132700     WRITE SCHMA.                                                         
132800     MOVE "  FM-UNIQUE (FMUNIQ-MSTR(VFLD-UNIQUE))," TO SCHMA.             
132900     WRITE SCHMA.                                                         
133000     MOVE "  VFLD-UNIQUE     ( !VFLDUNIQ-MSTR),   " TO SCHMA.             
133100     WRITE SCHMA.                                                         
133200     MOVE "  VFIL-UNIQUE      (FFUNIQ-MSTR),      " TO SCHMA.             
133300     WRITE SCHMA.                                                         
133400     MOVE "  SVR-UNIQUE     (SERVER-MSTR),        " TO SCHMA.             
133500     WRITE SCHMA.                                                         
133600     MOVE "  VFLD-NAME       (NAME16MSTR),         " TO SCHMA.            
133700     WRITE SCHMA.                                                         
133800     MOVE "  BUF-X           ,                    " TO SCHMA.             
133900     WRITE SCHMA.                                                         
134000     MOVE "  BUF-Y           ,                    " TO SCHMA.             
134100     WRITE SCHMA.                                                         
134200     MOVE "  SRN-SX          ,                    " TO SCHMA.     080812ma
134300     WRITE SCHMA.                                                 080812ma
134400     MOVE "  SRN-SY          ,                    " TO SCHMA.     080812ma
134500     WRITE SCHMA.                                                 080812ma
134600     MOVE "  SRN-EX          ,                    " TO SCHMA.     080812ma
134700     WRITE SCHMA.                                                 080812ma
134800     MOVE "  SRN-EY          ,                    " TO SCHMA.     080812ma
134900     WRITE SCHMA.                                                 080812ma
135000     MOVE "  PAN-NAME        ,                    " TO SCHMA.             
135100     WRITE SCHMA.                                                         
135200     MOVE "  SRN-ORD-NUM     ,                    " TO SCHMA.             
135300     WRITE SCHMA.                                                         
135400     MOVE "  VFLD-NUM         ,                    " TO SCHMA.            
135500     WRITE SCHMA.                                                         
135600     MOVE "  VFLD-LENGTH      ,                    " TO SCHMA.            
135700     WRITE SCHMA.                                                         
135800     MOVE "  VFLD-POSITION    ,                    " TO SCHMA.            
135900     WRITE SCHMA.                                                         
136000     MOVE "  VFLD-ENHANCE   ,   " TO SCHMA.                       080828ma
136100     WRITE SCHMA.                                                         
136200     MOVE "  VFLD-TYPE      ,   " TO SCHMA.                       080828ma
136300     WRITE SCHMA.                                                         
136400     MOVE "  VFLD-DATATYPE  ,   " TO SCHMA.                       080828ma
136500     WRITE SCHMA.                                                 080828ma
136600     MOVE "  VFLD-INITVAL    ,   " TO SCHMA.                      081120ma
136700     WRITE SCHMA.                                                 081120ma
136800     MOVE "  FDSPEC-TEXT    ;   " TO SCHMA.                       081124ma
136900     WRITE SCHMA.                                                 081120ma
137000     MOVE MYFFFLDCAP TO DISP-99.                                          
137100     INITIALIZE SCHMA.                                                    
137200     STRING "Cap:" DISP-99 ";" DELIMITED BY SIZE INTO SCHMA.              
137300     WRITE SCHMA.                                                         
137400     MOVE "                                       " TO SCHMA.             
137500     WRITE SCHMA.                                                 081120ma
137600*// **************************************************************        
137700*//  DATASET:                              VFLD-PROCSPECS                 
137800*// **************************************************************        
137900     MOVE "Name: VFLD-PROCSPECS, DETAIL   (3/3);  " TO SCHMA.             
138000     WRITE SCHMA.                                                         
138100     MOVE "Entry:                                 " TO SCHMA.             
138200     WRITE SCHMA.                                                         
138300     MOVE "  VFLD-UNIQUE (!VFLDUNIQ-MSTR(PRSPEC-SEQ))," TO SCHMA.         
138400     WRITE SCHMA.                                                         
138500     MOVE "  PRSPEC-SEQ      ,         " TO SCHMA.                        
138600     WRITE SCHMA.                                                         
138700     MOVE "  PRSPEC-TEXT   ;                      " TO SCHMA.             
138800     WRITE SCHMA.                                                         
138900     MOVE MYFFspecCAP TO DISP-99.                                 080828ma
139000     INITIALIZE SCHMA.                                                    
139100     STRING "Cap:" DISP-99 ";" DELIMITED BY SIZE INTO SCHMA.              
139200     WRITE SCHMA.                                                         
139300     MOVE "                                       " TO SCHMA.             
139400     WRITE SCHMA.                                                         
139500     MOVE "                                       " TO SCHMA.             
139600     WRITE SCHMA.                                                         
139700*// **************************************************************        
139800*//  DATASET:                              SERVICES                       
139900     MOVE "Name: SERVICES,      MANUAL   (3/3);   " TO SCHMA.             
140000     WRITE SCHMA.                                                         
140100     MOVE "Entry:                                 " TO SCHMA.             
140200     WRITE SCHMA.                                                         
140300     MOVE "   SERV-NAME (0),                      " TO SCHMA.             
140400     WRITE SCHMA.                                                         
140500     MOVE "   SERV-PROG    ,                      " TO SCHMA.             
140600     WRITE SCHMA.                                                         
140700     MOVE "   SERV-PORT    ;                      " TO SCHMA.             
140800     WRITE SCHMA.                                                         
140900     MOVE "Cap: 28;                               " TO SCHMA.             
141000     WRITE SCHMA.                                                         
141100     MOVE "                                       " TO SCHMA.             
141200     WRITE SCHMA.                                                         
141300     MOVE "                                       " TO SCHMA.             
141400     WRITE SCHMA.                                                         
141500*// **************************************************************        
141600*//  DATASET:                              WSTBL                          
141700     MOVE "Name: WSTBL,      MANUAL   (3/3);    " TO SCHMA.               
141800     WRITE SCHMA.                                                         
141900     MOVE "Entry:                                 " TO SCHMA.             
142000     WRITE SCHMA.                                                         
142100     MOVE "   WS-NAME   (0),                      " TO SCHMA.             
142200     WRITE SCHMA.                                                         
142300     MOVE "   WS-OCTET1    ,                      " TO SCHMA.             
142400     WRITE SCHMA.                                                         
142500     MOVE "   WS-OCTET2    ,                      " TO SCHMA.             
142600     WRITE SCHMA.                                                         
142700     MOVE "   WS-OCTET3    ,                      " TO SCHMA.             
142800     WRITE SCHMA.                                                         
142900     MOVE "   WS-OCTET4    ;                      " TO SCHMA.             
143000     WRITE SCHMA.                                                         
143100     MOVE "Cap: 7;                                " TO SCHMA.             
143200     WRITE SCHMA.                                                         
143300     MOVE "                                       " TO SCHMA.             
143400     WRITE SCHMA.                                                         
143500*// **************************************************************        
143600*//  DATASET:                              NEXTUNIQ                       
143700     MOVE "Name: NEXTUNIQ,      MANUAL   (3/3);   " TO SCHMA.             
143800     WRITE SCHMA.                                                         
143900     MOVE "Entry:                                 " TO SCHMA.             
144000     WRITE SCHMA.                                                         
144100     MOVE "   UNIQ-ID   (0),                      " TO SCHMA.             
144200     WRITE SCHMA.                                                         
144300     MOVE "   UNIQ-NUM     ;                      " TO SCHMA.             
144400     WRITE SCHMA.                                                         
144500     MOVE "Cap: 14;                                " TO SCHMA.            
144600     WRITE SCHMA.                                                         
144700     MOVE "                                       " TO SCHMA.             
144800     WRITE SCHMA.                                                         
144900     MOVE "                                       " TO SCHMA.             
145000     WRITE SCHMA.                                                         
145100     MOVE "end. << Schema by: J3K Solutions >>    " TO SCHMA.             
145200     WRITE SCHMA.                                                         
145300     CLOSE SCHEMA-FILE.                                                   
145400     move "Purge STDMSG,temp > $null" to cmd.                             
145500     PERFORM MPE-COMMAND.                                                 
145600     move "Build STDMSG;rec=-80,1,f,ascii;temp" to cmd.                   
145700     PERFORM MPE-COMMAND.                                                 
145800     move "File XIO=STDMSG,oldtemp" to cmd.                               
145900     PERFORM MPE-COMMAND.                                                 
146000     MOVE "ECHO MIGDB > *XIO" TO CMD.                                     
146100     PERFORM MPE-COMMAND.                                                 
146200     MOVE "ECHO Y >> *XIO" TO CMD.                                        
146300     PERFORM MPE-COMMAND.                                                 
146400     MOVE "RUN DBUTIL.PUB.SYS,PURGE < *XIO > $NULL" TO CMD.               
146500     PERFORM MPE-COMMAND.                                                 
146600     MOVE "FILE DBSTEXT=SCHEM" TO CMD.                                    
146700     PERFORM MPE-COMMAND.                                                 
146840     MOVE "FILE DBSLIST=SCHEM;DEV=LP,1" TO CMD.                           
146900     PERFORM MPE-COMMAND.                                                 
147000     MOVE "Compiling Database Schema, " TO M.                             
147100     PERFORM MSG-PROCESS.                                                 
147200     PERFORM SHOWTIME.                                                    
147300     MOVE "RUN DBSCHEMA.PUB.SYS;PARM=7 "  TO CMD.                         
147400     PERFORM MPE-COMMAND.                                                 
147500     MOVE "Building Database File Structure, " TO M.                      
147600     PERFORM MSG-PROCESS.                                                 
147700     PERFORM SHOWTIME.                                                    
147800     MOVE "ECHO CREATE MIGDB > *XIO" TO CMD.                              
147900     PERFORM MPE-COMMAND.                                                 
148000     MOVE "ECHO RELEASE MIGDB >> *XIO" TO CMD.                            
148100     PERFORM MPE-COMMAND.                                                 
148200     MOVE "ECHO EXIT >> *XIO" TO CMD.                                     
148300     PERFORM MPE-COMMAND.                                                 
148400     MOVE "RUN DBUTIL.PUB.SYS < *XIO > $NULL" TO CMD.                     
148500     PERFORM MPE-COMMAND.                                                 
148600*------------------------------------------------------------             
148700 MSG-PROCESS.                                                             
148800     DISPLAY M.                                                           
148900     INITIALIZE CSTR.                                                     
149000     STRING "TELLOP " M  %15 DELIMITED BY SIZE INTO CSTR.                 
149100     Move 2 To CMSG.                                                      
149200     IF BATCH-PROCESS OR NOT-INTERACTIVE                                  
149300      CALL INTRINSIC "HPCICOMMAND" USING                                  
149400           CSTR CERR CPARM CMSG.                                          
149500     INITIALIZE M CMD.                                                    
