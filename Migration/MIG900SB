001000$CONTROL POST85, BOUNDS, LINES=59, LIST                                   
001010******************************************************************080702ma
001110*   COPYRIGHT 2007 - 2009 J3K Solutions All rights reserved.      080702ma
001120*            Turbo Image Migration PREP System                    080702ma
001121*                                                                 080702ma
001130*        This program will "Create" the migration data            080812ma
001141*        base in the J3K account, and adds the server rec         080702ma
001142*                                                                 080702ma
001150*   http://www.j3ksolutions.com                                   080702ma
001160*   mailto:support@j3ksolutions.com                               080702ma
001170******************************************************************080702ma
001300*                                                *                        
001400*                                                                         
001500 IDENTIFICATION DIVISION.                                                 
001600 PROGRAM-ID.     MIG900.                                                  
001700 AUTHOR.     MICHAEL ANDERSON.                                            
001800 ENVIRONMENT DIVISION.                                                    
001900 CONFIGURATION SECTION.                                                   
002000 SOURCE-COMPUTER. HP-3000.                                                
002100*  SOURCE-COMPUTER. HP-3000 WITH DEBUGGING MODE.                          
002200 OBJECT-COMPUTER. HP-3000.                                                
002300*                                                                         
002400 INPUT-OUTPUT SECTION.                                                    
002500 FILE-CONTROL.                                                            
002600    SELECT WORK-FILE     ASSIGN TO "DBLIST,,,,5000".                      
002700    SELECT SCHEMA-FILE   ASSIGN TO "SCHEM,,,DISC".                        
002800    SELECT JOB-FILE      ASSIGN TO "DBJOB,,,DISC".                        
002900                                                                          
003000 DATA DIVISION.                                                           
003100  FILE SECTION.                                                           
003200                                                                          
003300 FD  WORK-FILE.                                                           
003400 01  WRK-REC.                                                             
003500     05  WRK-FOUND-DB          PIC X(36).                                 
003600     05  WRK-FILL-DB           PIC X(45).                                 
003700 FD  SCHEMA-FILE.                                                         
003800 01  SCHMA                PIC X(80).                                      
003900 FD  JOB-FILE.                                                            
004000 01  JOBREC                PIC X(80).                                     
004100                                                                          
004200$PAGE "WORKING STORAGE"                                                   
004300 WORKING-STORAGE SECTION.                                                 
004400 01  HPVAR-NAME        PIC X(20) VALUE "ITOSQLS_STATUS~  ".               
004500 01  HPVAR-ITEM        PIC S9(9) COMP VALUE -1.                           
004600 01  HPVAR-ITEMNUM     PIC S9(9) COMP VALUE 1.                            
004700 01  HPVAR-STAT        PIC S9(9) COMP VALUE 0.                            
004800 01  DS-IDX            PIC S9(9) COMP VALUE 0.                            
004900 01  DI-IDX            PIC S9(9) COMP VALUE 0.                            
005000 01  DISP-99           PIC Z(9).                                          
005100 01 MYDBCAP    PIC S9(9) COMP VALUE 0.                                    
005200 01 MYDSCAP    PIC S9(9) COMP VALUE 0.                                    
005300 01 MYFLDCAP   PIC S9(9) COMP VALUE 0.                                    
005400 01 MYFFILCAP  PIC S9(9) COMP VALUE 0.                                    
005500 01 MYFMCAP    PIC S9(9) COMP VALUE 0.                                    
005600 01 MYFFFLDCAP PIC S9(9) COMP VALUE 0.                            080828ma
005610 01 MYFFspecCAP PIC S9(9) COMP VALUE 0.                           080828ma
005700 01 MY16CAP    PIC S9(9) COMP VALUE 0.                                    
005800                                                                          
005900 01  GETINFO-DATA.                                                        
006000    05  GINFO-LEN                PIC S9(4) COMP.                          
006100    05  GINFO-STR                PIC X(128).                              
006200    05  GINFO-PARM               PIC S9(4) COMP.                          
006300 01  PARSED-DATA.                                                         
006400    05  ITEMS-PARSED             PIC S9(4) COMP.                          
006500        88 PARSE-IS-COMPLETE VALUES ARE 3 THRU 99.                        
006600    05  PARSED-STRING            PIC X(128).                              
006700    05  NEXT-STRING              PIC X(128).                              
006800    05  STRING-POINTER             PIC S9(4) COMP.                        
006900    05  GX                       PIC S9(4) COMP.                          
007000    05  GY                       PIC S9(4) COMP.                          
007100    05  PX                       PIC S9(4) COMP.                          
007200                                                                          
007300 COPY SRVMST OF J3KLIB.                                                   
007400                                                                          
007500 01  FULL-CURRENT-DATE.                                                   
007600         05  C-DATE.                                                      
007700             10  C-YEAR       PIC 9(4).                                   
007800             10  C-MONTH      PIC 99.                                     
007900             10  C-DAY        PIC 99.                                     
008000         05  C-TIME.                                                      
008100             10  C-HOUR       PIC 99.                                     
008200             10  C-MINUTES    PIC 99.                                     
008300             10  C-SECONDS    PIC 99.                                     
008400             10  C-SEC-HUND   PIC 99.                                     
008500         05  C-TIME-DIFF.                                                 
008600             10  O-GMT-DIR    PIC X.                                      
008700             10  O-HOUR       PIC 99.                                     
008800             10  O-MINUTES    PIC 99.                                     
008900 01 ERROR-MSG                PIC X(80) VALUE SPACES.                      
009000 01 NUMDEC                 PIC S9(4) COMP.                                
009100 01 NUMERR                 PIC S9(4) COMP.                                
009200 01 NUM1                   PIC X(14).                                     
009300 01 NUM2                   PIC S9(14). 01  DB-MISC.                       
009400     02  RE-READ           PIC S9(4) COMP VALUE 1.                        
009500     02  MAX-DB            PIC S9(4) COMP VALUE 100.                      
009600     02  SERIAL            PIC S9(4) COMP VALUE 2.                        
009700     02  BACKWARD          PIC S9(4) COMP VALUE 3.                        
009800     02  DIRECT            PIC S9(4) COMP VALUE 4.                        
009900     02  CHAINED           PIC S9(4) COMP VALUE 5.                        
010000     02  BACK-CHAINED      PIC S9(4) COMP VALUE 6.                        
010100     02  KEYED             PIC S9(4) COMP VALUE 7.                        
010200     02  MODE-1            PIC S9(4) COMP VALUE 1.                        
010300     02  MODE-3            PIC S9(4) COMP VALUE 3.                        
010400     02  MODE-4            PIC S9(4) COMP VALUE 4.                        
010500     02  MODE-20           PIC S9(4) COMP VALUE 20.                       
010600     02  MODE-104          PIC S9(4) COMP VALUE 104.                      
010700     02  MODE-102          PIC S9(4) COMP VALUE 102.                      
010800     02  MODE-103          PIC S9(4) COMP VALUE 103.                      
010900     02  MODE-202          PIC S9(4) COMP VALUE 202.                      
011000     02  MODE-203          PIC S9(4) COMP VALUE 203.                      
011100     02  MODE-301          PIC S9(4) COMP VALUE 301.                      
011200     02  MODE-406          PIC S9(4) COMP VALUE 406.                      
011300     02  MODE-5            PIC S9(4) COMP VALUE 5.                        
011400     02  MODE-N            PIC S9(4) COMP VALUE 0.                        
011500     02  IREAD-LEN         PIC S9(4) COMP VALUE 0.                        
011600     02  IMAGE-ERRNUM      PIC S9(4) COMP VALUE 0.                        
011700     02  CALL-STRING       PIC X(80) VALUE SPACES.                        
011800     02  CSLEN             PIC S9(4) COMP VALUE 0.                        
011900     02  ERROR-STRING      PIC X(80) VALUE SPACES.                        
012000     02  ESLEN             PIC S9(4) COMP VALUE 0.                        
012100     02  NULL-ITEM         PIC XXXX VALUE "; ".                           
012200     02  ALL-ITEMS         PIC XX VALUE "@;".                             
012300     02  SEARCH-ITEM       PIC X(18).                                     
012400     02  SEARCH-KEY        PIC X(64).                                     
012500     02  SEARCH-KEYI2 REDEFINES SEARCH-KEY.                               
012600         03 SEARCH-KEYI32  PIC S9(9) COMP.                                
012700         03 FILLER         PIC X(60).                                     
012800     02  STATUS-AREA.                                                     
012900         03  CONDITION-WORD    PIC S9(4) COMP VALUE  0.                   
013000             88  NO-IMAGE-ERRORS         VALUE  0.                        
013100             88  IMAGE-ERRORS                                             
013200                 VALUES ARE -9999 THRU -1, 1 THRU  9999.                  
013300             88  END-OF-FILE             VALUE 11.                        
013400             88  BEG-OF-FILE             VALUE 12.                        
013500             88  BEG-OF-CHAIN            VALUE 14.                        
013600             88  END-OF-CHAIN            VALUE 15.                        
013700             88  NO-ENTRY                VALUE 17.                        
013800         03  RECORD-LENGTH     PIC S9(4) COMP VALUE  0.                   
013900         03  RECORD-NUMBER     PIC S9(9) COMP VALUE  0.                   
014000         03  ENTRIES-IN-CHAIN  PIC S9(9) COMP VALUE  0.                   
014100         03  PREV-RECORD-NO    PIC S9(9) COMP VALUE  0.                   
014200         03  NEXT-RECORD-NO    PIC S9(9) COMP VALUE  0.                   
014300 01  MIGDB    PIC S9(4) COMP VALUE  9.                                    
014400 01  MYDB     PIC S9(4) COMP VALUE  9.                                    
014500 01  MIGDB-STATUS.                                                        
014600     03  FILLER    PIC S9(4) COMP VALUE  0.                               
014700     03  FILLER    PIC S9(4) COMP VALUE  0.                               
014800     03  FILLER    PIC S9(9) COMP VALUE  0.                               
014900     03  FILLER    PIC S9(9) COMP VALUE  0.                               
015000     03  FILLER    PIC S9(9) COMP VALUE  0.                               
015100     03  FILLER    PIC S9(9) COMP VALUE  0.                               
015200 01  FIRST-TIME-SW         PIC X.                                         
015300     88  FIRST-TIME        VALUE "1".                                     
015400                                                                          
015500 01  ERRORS-SW             PIC X.                                         
015600     88  ERRORS            VALUE "1".                                     
015700                                                                          
015800 01  EDIT-ERRORS-SW        PIC X.                                         
015900     88  EDIT-ERRORS       VALUE "1".                                     
016000                                                                          
016100 01  BAD-KEY-SW            PIC X.                                         
016200     88  BAD-KEY           VALUE "1".                                     
016300                                                                          
016400 01  Last-Column-SW       PIC X.                                          
016500     88  Last-Column      VALUE "1".                                      
016600                                                                          
016700 01  X-FLOWTEST-JCW          PIC X(8) VALUE "FLOWTEST".                   
016800 01  X-FLOWTEST-VALUE        PIC S9(4) COMP VALUE 0.                      
016900     88  X-FLOWTEST          VALUE 1.                                     
017000                                                                          
017100 01 TARGET-FIELD                    PIC X(64) VALUE SPACES.               
017200 01 DWNSHFT-SW                      PIC X.                                
017300    88 OK-TO-DOWNSHIFT VALUE "1".                                         
017400 01 MYIDX                           PIC S9(4) COMP VALUE 0.               
017500 01 SOURCE-FIELD                    PIC X(64) VALUE SPACES.               
017600 01 ASCII-CHARACTERS.                                                     
017700    02 TWO-BYTES                    PIC XX VALUE SPACES.                  
017800    02 SIXTEEN-BITS REDEFINES TWO-BYTES.                                  
017900       05 ASCII-INT                 PIC S9(4) COMP.                       
018000    02 TWO-CHARS    REDEFINES TWO-BYTES.                                  
018100       05 FILLER                    PIC X.                                
018200       05 ASCII-CHAR                PIC X.                                
018300                                                                          
018400                                                                          
018500 01 ABORT-SWITCHES.                                                       
018600    02 ON-IMAGE-ERRORS     PIC X VALUE "0".                               
018700       88 ABORT-ON-IMAGE-ERRORS  VALUE "9".                               
018800                                                                          
018900 01  DATA-BASE-COMMON.                                                    
019000     02  DB-PTR                    PIC S9(4) COMP.                        
019100     02  DB-CNT                    PIC S9(4) COMP.                        
019200     02  DB-MAX                    PIC S9(4) COMP.                        
019300     02  DB-IDX                    PIC S9(4) COMP.                        
019400     02  DB-POINTER-STORAGE.                                              
019500         03 DB-POINTER-ENTRIES OCCURS 100 TIMES.                          
019600            04 DBPTR               PIC S9(4) COMP.                        
019700                                                                          
019800     02  SAVE-STATUS.                                                     
019900         03  CONDITION-SAVED   PIC S9(4) COMP.                            
020000         03  SAVED-LENGTH      PIC S9(4) COMP.                            
020100         03  SAVED-NUMBER      PIC S9(9) COMP.                            
020200         03  SAVED-IN-CHAIN    PIC S9(9) COMP.                            
020300         03  PREV-SAVED-NO     PIC S9(9) COMP.                            
020400         03  NEXT-SAVED-NO     PIC S9(9) COMP.                            
020500                                                                          
020600     02 DATABASE-TABLE.                                                   
020700         03 DATA-BASE-NAMES            OCCURS 512 TIMES.                  
020800            05 DATA-BASE-NAME.                                            
020900             10 IMAGE-WORD           PIC XX.                              
021000             10 DBNAME               PIC X(26).                           
021100            05 DATA-BASE-PASS          PIC X(08).                         
021200                                                                          
021300 01 A-TABLE-SW               PIC X VALUE "0".                             
021400    88 ITS-A-TABLE    VALUE "1".                                          
021500 01 DOW                      PIC S9(4) COMP  VALUE 0.                     
021600 01 INSPECT-IDX              PIC S9(4) COMP  VALUE 0.                     
021700 01 NUMDATE                  PIC S9(9) COMP  VALUE 0.                     
021800                                                                          
021900 01 WHO-INTRINSIC-PARMS.                                                  
022000    15  WHO-TERM-DEV-NO        PIC S9999 COMP.                            
022100    15  WHO-MODE               PIC S9999 COMP.                            
022200    15  WHO-CAPABILITY         PIC S9(6) COMP.                            
022300    15  WHO-LATTR              PIC S9(6) COMP.                            
022400    15  WHO-USERN.                                                        
022500        20 BYTE1-6             PIC X(6).                                  
022600        20 SCHOOL-NUMBER       PIC XX.                                    
022700    15  WHO-GROUPN             PIC X(8).                                  
022800    15  WHO-ACCTN              PIC X(8).                                  
022900    15  WHO-HOMEN              PIC X(8).                                  
023000                                                                          
023100 01 DP-IDX                  PIC S9(9) COMP  VALUE 0.                      
023200 01 MyHpSusan               PIC S9(9) COMP  VALUE 0.                      
023300 01 MYHPVERSION             PIC X(24) VALUE SPACES.                       
023400 01 MYHPCPUNAME             PIC X(24) VALUE SPACES.                       
023500 01 MYHPLOCIPADDR           PIC X(24) VALUE SPACES.                       
023600 01 MYMSG                   PIC X(79) VALUE SPACES.                       
023700 01 SI-IDX                  PIC S9(9) COMP  VALUE 0.                      
023800 01 DISPZ4                  PIC ZZ,ZZZ,ZZZ VALUE ZERO.                    
023900 01 CSTR                     PIC X(255)      VALUE SPACES.                
024000 01 CMD                     PIC X(255)      VALUE SPACES.                 
024100 01 CERR                     PIC S9(4) COMP  VALUE 0.                     
024200 01 CPARM                    PIC S9(4) COMP  VALUE 0.                     
024300 01 CMSG                     PIC S9(4) COMP  VALUE 2.                     
024400 01 STR-PTR                  PIC S9(4) COMP  VALUE 0.                     
024500 01 OCCURS-VALUE             PIC S9(4) COMP  VALUE 0.                     
024600 01  EXTFILE-STATUS            PIC X   VALUE "0".                         
024700     88 EXTFILE-EOF                    VALUE "9".                         
024800 01 OCCURS-LAST              PIC S9(4) COMP  VALUE 0.                     
024900 01 My-BaseName              Pic X(28) Value Spaces.                      
025000 01 M               Pic X(78) Value Spaces.                               
025100 01 OCCURS-PTR               PIC S9(4) COMP  VALUE 0.                     
025200 01 NUM-X                    PIC S9(4) COMP  VALUE 0.                     
025300 01 My-Bytes                  pic S9(4) Comp  Value 0.                    
025400 01 DASH-PTR                 PIC S9(4) COMP  VALUE 0.                     
025500 01 VAR-LEN                  PIC S9(4) COMP  VALUE 0.                     
025600 01 SHOWTIME-STR.                                                         
025700    02 FILLER PIC X(8) VALUE "SHOWTIME".                                  
025800    02 FILLER PIC X    VALUE %15.                                         
025900 01 DATE-EDITING.                                                         
026000    05 RAW-DATE.                                                          
026100       10 D1     PIC X   VALUE SPACES.                                    
026200       10 D2     PIC X   VALUE SPACES.                                    
026300       10 D3     PIC X   VALUE SPACES.                                    
026400       10 D4     PIC X   VALUE SPACES.                                    
026500       10 D5     PIC X   VALUE SPACES.                                    
026600       10 D6     PIC X   VALUE SPACES.                                    
026700       10 D7     PIC X   VALUE SPACES.                                    
026800       10 D8     PIC X   VALUE SPACES.                                    
026900    05 EDITED-DATE.                                                       
027000       10 D5     PIC X   VALUE SPACES.                                    
027100       10 D6     PIC X   VALUE SPACES.                                    
027200       10 FILLER PIC X   VALUE "/".                                       
027300       10 D7     PIC X   VALUE SPACES.                                    
027400       10 D8     PIC X   VALUE SPACES.                                    
027500       10 FILLER PIC X   VALUE "/".                                       
027600       10 D1     PIC X   VALUE SPACES.                                    
027700       10 D2     PIC X   VALUE SPACES.                                    
027800       10 D3     PIC X   VALUE SPACES.                                    
027900       10 D4     PIC X   VALUE SPACES.                                    
028000                                                                          
028100* 1: Database new limits (# of sets = 240,                                
028200*                         # of items = 1200,                              
028300*                         # paths per masters = 64)                       
028400* 0: Database old limits (# of sets = 199,                                
028500*                         # of items = 1024,                              
028600*                         # paths per master = 16)                        
028700                                                                          
028800 01 Db-Info-406-Word-17.                                                  
028900    05  BIT1             PIC 9.                                           
029000    05  BIT2             PIC 9.                                           
029100    05  BIT3             PIC 9.                                           
029200    05  BIT4             PIC 9.                                           
029300    05  BIT5             PIC 9.                                           
029400    05  BIT6             PIC 9.                                           
029500    05  BIT7             PIC 9.                                           
029600    05  BIT8             PIC 9.                                           
029700    05  BIT9             PIC 9.                                           
029800        88 Database-Newlimits Value 1.                                    
029900        88 Database-Oldlimits Value 0.                                    
030000    05  BIT10            PIC 9.                                           
030100        88 Database-Entrynumber-Format Value 1.                           
030200        88 Database-Entryname-Format   Value 0.                           
030300    05  BIT11            PIC 9.                                           
030400    05  BIT12            PIC 9.                                           
030500        88 Expandable-Master-Dataset     Value 1.                         
030600        88 No-Expandable-Master-Dataset   Value 0.                        
030700    05  BIT13            PIC 9.                                           
030800        88 B-Tree      Value 1.                                           
030900        88 No-B-Tree   Value 0.                                           
031000    05  BIT14            PIC 9.                                           
031100    05  BIT15            PIC 9.                                           
031200    05  BIT16            PIC 9.                                           
031300 01  BINARY-VALUE.                                                        
031400     05 BIT-ZERO                     PIC 9.                               
031500     05 BIT OCCURS 15 TIMES          PIC 9.                               
031600                                                                          
031700 01 NUMERIC-EDITS.                                                        
031800    02 Split-Word        Pic S9(4) Comp.                                  
031900    02 Splating-a-word Redefines Split-Word.                              
032000       05 Split-Word-1 Pic x.                                             
032100       05 Split-Word-2 Pic x.                                             
032200    02 CHR3              PIC XXX.                                         
032300    02 Y1                PIC 9.                                           
032400    02 Y2                PIC 99.                                          
032500    02 Y3                PIC 999.                                         
032600    02 Y4                PIC 9999.                                        
032700    02 Y5                PIC 99999.                                       
032800    02 CHR6              PIC XXXXXX.                                      
032900    02 Z1                PIC 9.                                           
033000    02 Z2                PIC 99.                                          
033100    02 Z3                PIC 999.                                         
033200    02 Z4                PIC 9999.                                        
033300    02 Z5                PIC 99999.                                       
033400 01 Collate-Str          Pic x(64).                                       
033500 01  WS-LOGON-DESC                       VALUE SPACES.                    
033600     05  WS-LD-JOB-NAME      PIC  X(16).                                  
033700     05  WS-LD-ACCT-NAME     PIC  X(16).                                  
033800     05  WS-LD-ACCT-PASS     PIC  X(16).                                  
033900     05  WS-LD-USER-NAME     PIC  X(16).                                  
034000     05  WS-LD-USER-PASS     PIC  X(16).                                  
034100     05  WS-LD-GROUP-NAME    PIC  X(16).                                  
034200     05  WS-LD-GROUP-PASS    PIC  X(16).                                  
034300 01  WS-ERR PIC S9(4) COMP VALUE 0.                                       
034400 01  WS-ERR-MSG PIC X(80) VALUE SPACES.                                   
034500 01  TDAY                PIC X(8)  VALUE SPACES.                          
034600 01  TNUMDAY             PIC S9(9) COMP VALUE 0.                          
034700 01  TDOW                PIC S9(4) COMP VALUE 0.                          
034800 01  DDAY                PIC X(8)  VALUE SPACES.                          
034900 01  DNUMDAY             PIC S9(9) COMP VALUE 0.                          
035000 01  DDOW                PIC S9(4) COMP VALUE 0.                          
035100 01  DCNT                PIC S9(4) COMP VALUE 0.                          
035200 COPY AMSMODE OF J3KLIB.                                                  
035300                                                                          
035400*=================================================================        
035500$PAGE  "Main logical flow"                                                
035600*=================================================================        
035700 PROCEDURE DIVISION.                                                      
035800 BEGIN-0000.                                                              
035900     CALL   INTRINSIC "WHO"                                               
036000     USING  WHO-MODE WHO-CAPABILITY WHO-LATTR WHO-USERN                   
036100            WHO-GROUPN WHO-ACCTN WHO-HOMEN WHO-TERM-DEV-NO.               
036200     MOVE WHO-MODE TO AMSMODE.                                            
036300     IF WHO-ACCTN(1:3) <> "SYS" OR                                        
036400        WHO-USERN(1:7) <> "MANAGER" OR                                    
036500        WHO-GROUPN(1:3) <> "J3K"                                          
036600       DISPLAY "PLEASE LOGON AS MANAGER.SYS,J3K"                          
036700       DISPLAY "This program will not run as "                            
036800               WHO-USERN "." WHO-ACCTN "," WHO-GROUPN                     
036900       STOP RUN.                                                          
037000     Move "Turbo Image/SQL Documentation Tool version C.8.4" to m.        
037100     PERFORM MSG-PROCESS.                                                 
037200     Move "------------------------------------------------" to m.        
037300     PERFORM MSG-PROCESS.                                                 
037400     Move "***             MIG900.PUB.J3K               ***" to m.        
037500     PERFORM MSG-PROCESS.                                                 
037600     Move "***                                          ***" to m.        
037700     PERFORM MSG-PROCESS.                                                 
037800     Move "***       Creating J3K file structure        ***" to m.        
037900     PERFORM MSG-PROCESS.                                                 
038000     Move "***                                          ***" to m.        
038100     PERFORM MSG-PROCESS.                                                 
038200     Move "------------------------------------------------" to m.        
038300     PERFORM MSG-PROCESS.                                                 
038400     Move "Copyright 2007 J3K Solutions" to m.                            
038500     PERFORM MSG-PROCESS.                                                 
038600     CALL "GETCURRENT" USING TDAY TNUMDAY TDOW.                           
038700*    INITIALIZE DDAY DNUMDAY DDOW.                                        
038800*    MOVE "20070520" TO DDAY.                                             
038900*    CALL "DAYNUM" USING DDAY DNUMDAY DDOW.                               
039000*    COMPUTE DCNT = DNUMDAY - TNUMDAY.                                    
039100*    IF DCNT < 0                                                          
039200*     MOVE "--------------------------------------------" to m            
039300*    PERFORM MSG-PROCESS                                                  
039400*     MOVE "***                                      ***" to m            
039500*    PERFORM MSG-PROCESS                                                  
039600*     MOVE "***                                      ***" to m            
039700*    PERFORM MSG-PROCESS                                                  
039800*     MOVE "***   This DEMO version has expired      ***" to m            
039900*    PERFORM MSG-PROCESS                                                  
040000*     MOVE "***   Email: Support@J3KSolutions.com    ***" to m            
040100*    PERFORM MSG-PROCESS                                                  
040200*     MOVE "***                                      ***" to m            
040300*    PERFORM MSG-PROCESS                                                  
040400*     MOVE "***                                      ***" to m            
040500*    PERFORM MSG-PROCESS                                                  
040600*     MOVE "--------------------------------------------" to m            
040700*    PERFORM MSG-PROCESS                                                  
040800*     CALL INTRINSIC "QUIT" USING \0\                                     
040900*    ELSE                                                                 
041000*     MOVE DCNT TO Z2                                                     
041100*     STRING "DEMO Period has " z2 " days remaining."                     
041200*      DELIMITED BY SIZE INTO m                                           
041300*     END-STRING                                                          
041400*     PERFORM MSG-PROCESS.                                                
041500*     MOVE "Expiration date is: May 20, 2007" to m.                       
041600*    PERFORM MSG-PROCESS.                                                 
041700     INITIALIZE WS-LOGON-DESC WS-ERR WS-ERR-MSG.                          
041800     MOVE "J3KDIAG" TO WS-LD-JOB-NAME.                                    
041900     MOVE "MANAGER" TO WS-LD-USER-NAME.                                   
042000     MOVE "J3K"     TO WS-LD-ACCT-NAME.                                   
042100     MOVE "PUB"     TO WS-LD-GROUP-NAME.                                  
042200     CALL "CHGLOGON" USING WS-LOGON-DESC WS-ERR WS-ERR-MSG.               
042300     IF WS-ERR <> 0                                                       
042400      DISPLAY "UNABLE TO CHANGE LOGON"                                    
042500      DISPLAY WS-ERR-MSG                                                  
042600      CALL INTRINSIC "QUIT" USING \3\ END-CALL                            
042700     ELSE                                                                 
042800      CALL   INTRINSIC "WHO"                                              
042900       USING  WHO-MODE WHO-CAPABILITY WHO-LATTR WHO-USERN                 
043000              WHO-GROUPN WHO-ACCTN WHO-HOMEN WHO-TERM-DEV-NO              
043100      END-CALL                                                            
043200     END-IF                                                               
043300     INITIALIZE WS-ERR-MSG                                                
043400     STRING "J3KDIAG," DELIMITED BY SIZE                                  
043500             WHO-USERN DELIMITED BY SPACE                                 
043600             "."       DELIMITED BY SIZE                                  
043700             WHO-ACCTN DELIMITED BY SPACE                                 
043800             ","       DELIMITED BY SIZE                                  
043900             WHO-GROUPN DELIMITED BY SPACES                               
044000         INTO WS-ERR-MSG.                                                 
044100     string "Logon: " delimited by size                                   
044200            ws-err-msg delimited by size into m                           
044300     PERFORM MSG-PROCESS.                                                 
044400     move "Creating the migration database" to m                          
044500     PERFORM MSG-PROCESS.                                                 
044600     Perform ShowTime.                                                    
044700     PERFORM CREATE-MIGDB.                                                
044800     PERFORM GET-HPSUSAN.                                                 
044900     PERFORM GET-HPVERSION.                                               
045000     PERFORM GET-HPCPUNAME.                                               
045100     PERFORM GET-HPLOCIPADDR.                                             
045200     Initialize DATABASE-TABLE My-BaseName.                               
045300     MOVE 128 TO GINFO-LEN.                                               
045400     MOVE 9 TO MIGDB.                                                     
045500     MOVE "MIGDB.PUB.J3K" TO DbName(MIGDB)                                
045600     MOVE ";" TO NULL-ITEM.                                               
045700     CALL "DBOPEN" USING                                                  
045800      DATA-BASE-NAME(MIGDB) NULL-ITEM MODE-1 STATUS-AREA.                 
045900     IF IMAGE-ERRORS PERFORM 9000-IMAGE-ERROR.                            
046000     MOVE STATUS-AREA TO MIGDB-STATUS.                                    
046100     INITIALIZE SRVMST-BUFFER.                                            
046200     Move 1 to SEARCH-KEYI32.                                             
046300     Perform Get-SRVMST-Keyed.                                            
046400     If No-Entry                                                          
046500      MOVE  1 TO SRVMST-SVR-UNIQUE                                        
046600      MOVE  MYHPCPUNAME   TO SRVMST-SVR-NAME                              
046700      MOVE  MYHPLOCIPADDR TO SRVMST-SVR-IPADDR                            
046800      MOVE  MYHpSusan     TO SRVMST-SVR-SUSAN                             
046900      MOVE  MYHPVERSION   TO SRVMST-SVR-MPEVERSION                        
047000      PERFORM LOCK-SRVMST                                                 
047100      PERFORM PUT-SRVMST                                                  
047200      IF NOT IMAGE-ERRORS                                                 
047300       MOVE "File structure created, " TO M                               
047400       PERFORM MSG-PROCESS                                                
047500       Perform ShowTime.                                                  
047600      PERFORM UNLOCK-SRVMST.                                              
047700     CALL "DBCLOSE" USING DATA-BASE-NAME(MIGDB)                           
047800                          NULL-ITEM MODE-1 STATUS-AREA.                   
047900     STOP RUN.                                                            
048000*=================================================================        
048100$page "MISC SubParagraphs"                                                
048200*=================================================================        
048300*---------------------------------------------------------                
048400 GET-NUM.                                                                 
048500D    DISPLAY "GET-NUM".                                                   
048600     INITIALIZE NUM2 NUMDEC NUMERR.                                       
048700     CALL "NUMGET" USING NUM1 NUM2 NUMDEC NUMERR.                         
048800     IF NUMERR NOT = 0 MOVE 0 TO NUM2.                                    
048900     IF NUMDEC NOT = 0 MOVE 0 TO NUM2.                                    
049000*---------------------------------------------------------                
049100 MPE-COMMAND.                                                             
049200D    DISPLAY "MPE-COMMAND".                                               
049300     INITIALIZE CSTR.                                                     
049400     STRING CMD DELIMITED BY "  " %15 DELIMITED BY SIZE INTO CSTR.        
049500     Move 2 To CMSG.                                                      
049600     CALL INTRINSIC "HPCICOMMAND" USING                                   
049700          CSTR CERR CPARM CMSG.                                           
049800     INITIALIZE CMD.                                                      
049900*---------------------------------------------------------                
050000 SHOWTIME.                                                                
050100     CALL INTRINSIC "HPCICOMMAND" USING                                   
050200          SHOWTIME-STR CERR CPARM CMSG.                                   
050300*---------------------------------------------------------                
050400 COPY SRVMST0 OF J3KLIB.                                                  
050500 COPY SRVMST1 OF J3KLIB.                                                  
050600 COPY SRVMST2 OF J3KLIB.                                                  
050700 COPY SRVMST3 OF J3KLIB.                                                  
050800 COPY SRVMST4 OF J3KLIB.                                                  
050900 COPY SRVMST5 OF J3KLIB.                                                  
051000 COPY SRVMST6 OF J3KLIB.                                                  
051100 COPY SRVMST7 OF J3KLIB.                                                  
051200 COPY SRVMST8 OF J3KLIB.                                                  
051300                                                                          
051400*---------------------------------------------------------                
051500 9000-IMAGE-ERROR.                                                        
051600D    DISPLAY "9000-IMAGE-ERROR".                                          
051700     CALL "DBEXPLAIN" USING STATUS-AREA.                                  
051800*---------------------------------------------------------                
051900*---------------------------------------------------------                
052000 9999-RETURN.                                                             
052100D    DISPLAY "9999-RETURN".                                               
052200     GOBACK.                                                              
052300*--------------------------------------------------------                 
052400 GET-HPSUSAN.                                                             
052500     MOVE "HPSUSAN~" TO HPVAR-NAME.                                       
052600     MOVE 1 TO HPVAR-ITEMNUM.                                             
052700     INITIALIZE HPVAR-ITEM HPVAR-STAT.                                    
052800     CALL INTRINSIC "HPCIGETVAR" USING HPVAR-NAME                         
052900         HPVAR-STAT HPVAR-ITEMNUM MYHPSUSAN.                              
053000D     DISPLAY "HPSUSAN: " MYHPSUSAN.                                      
053100                                                                          
053200                                                                          
053300*--------------------------------------------------------                 
053400 GET-HPVERSION.                                                           
053500     MOVE "HPVERSION~" TO HPVAR-NAME.                                     
053600     MOVE 2 TO HPVAR-ITEMNUM.                                             
053700     INITIALIZE MYHPVERSION HPVAR-STAT.                                   
053800     CALL INTRINSIC "HPCIGETVAR" USING HPVAR-NAME                         
053900         HPVAR-STAT HPVAR-ITEMNUM MYHPVERSION.                            
054000D    DISPLAY "HPVERSION: " MYHPVERSION.                                   
054100*--------------------------------------------------------                 
054200 GET-HPCPUNAME.                                                           
054300     MOVE "HPCPUNAME~" TO HPVAR-NAME.                                     
054400     MOVE 2 TO HPVAR-ITEMNUM.                                             
054500     INITIALIZE MYHPCPUNAME HPVAR-STAT.                                   
054600     CALL INTRINSIC "HPCIGETVAR" USING HPVAR-NAME                         
054700         HPVAR-STAT HPVAR-ITEMNUM MYHPCPUNAME.                            
054800D    DISPLAY "HPCPUNAME: " MYHPCPUNAME.                                   
054900                                                                          
055000*--------------------------------------------------------                 
055100 GET-HPLOCIPADDR.                                                         
055200     MOVE "HPLOCIPADDR~" TO HPVAR-NAME.                                   
055300     MOVE 2 TO HPVAR-ITEMNUM.                                             
055400     INITIALIZE MYHPLOCIPADDR HPVAR-STAT.                                 
055500     CALL INTRINSIC "HPCIGETVAR" USING HPVAR-NAME                         
055600         HPVAR-STAT HPVAR-ITEMNUM MYHPLOCIPADDR.                          
055700D    DISPLAY "HPLOCIPADDR: " MYHPLOCIPADDR.                               
055800*---------------------------------------------------------                
055900 CREATE-MIGDB.                                                            
056000     move "Purge STDMSG,temp > $null" to cmd.                             
056100     PERFORM MPE-COMMAND.                                                 
056200     move "Build STDMSG;rec=-80,1,f,ascii;temp" to cmd.                   
056300     PERFORM MPE-COMMAND.                                                 
056400     move "File XIO=STDMSG,oldtemp" to cmd.                               
056500     PERFORM MPE-COMMAND.                                                 
056600     STRING "listfile @.@.@;seleq=[code=-400]"                            
056700            ";format=qualify > *XIO"                                      
056800      DELIMITED BY SIZE INTO CMD.                                         
056900     PERFORM MPE-COMMAND.                                                 
057000     move "Setvar _numrecs Finfo('STDMSG','EOF')" TO CMD                  
057100     PERFORM MPE-COMMAND.                                                 
057200*---------------------------                                              
057300* Number of databases                                                     
057400     MOVE "MIGBASES~" TO HPVAR-NAME.                                      
057500     MOVE 1 TO HPVAR-ITEMNUM.                                             
057600     INITIALIZE MYHPLOCIPADDR HPVAR-STAT.                                 
057700     CALL INTRINSIC "HPCIGETVAR" USING HPVAR-NAME                         
057800         HPVAR-STAT HPVAR-ITEMNUM HPVAR-ITEM.                             
057900     MOVE HPVAR-ITEM TO DISPZ4.                                           
058000    STRING "Number of Databases on this server:       " DISPZ4            
058100        DELIMITED BY SIZE INTO M.                                         
058200     PERFORM MSG-PROCESS.                                                 
058300     MOVE HPVAR-ITEM TO MYDBCAP.                                          
058400*---------------------------                                              
058500* Number of data sets                                                     
058600     MOVE "MIGSETS~" TO HPVAR-NAME.                                       
058700     MOVE 1 TO HPVAR-ITEMNUM.                                             
058800     INITIALIZE MYHPLOCIPADDR HPVAR-STAT.                                 
058900     CALL INTRINSIC "HPCIGETVAR" USING HPVAR-NAME                         
059000         HPVAR-STAT HPVAR-ITEMNUM HPVAR-ITEM.                             
059100     MOVE HPVAR-ITEM TO DISPZ4.                                           
059200    STRING "Number of Data sets on this server:       " DISPZ4            
059300        DELIMITED BY SIZE INTO M.                                         
059400     PERFORM MSG-PROCESS.                                                 
059500     MOVE HPVAR-ITEM TO MYDSCAP.                                          
059600                                                                          
059700*---------------------------                                              
059800* Number of data fields                                                   
059900     MOVE "MIGFIELDS~" TO HPVAR-NAME.                                     
060000     MOVE 1 TO HPVAR-ITEMNUM.                                             
060100     INITIALIZE MYHPLOCIPADDR HPVAR-STAT.                                 
060200     CALL INTRINSIC "HPCIGETVAR" USING HPVAR-NAME                         
060300         HPVAR-STAT HPVAR-ITEMNUM HPVAR-ITEM.                             
060400     MOVE HPVAR-ITEM TO DISPZ4.                                           
060500    STRING "Number of Data fields on this server:     " DISPZ4            
060600        DELIMITED BY SIZE INTO M.                                         
060700     PERFORM MSG-PROCESS.                                                 
060800     MOVE HPVAR-ITEM TO MYFLDCAP.                                         
060810*****************     compute MYFLDCAP = ( MYFLDCAP * 2 ).                
060900                                                                          
061000*---------------------------                                              
061100* Number of formfiles                                                     
061200     MOVE "MIG_FM_FILES~" TO HPVAR-NAME.                                  
061300     MOVE 1 TO HPVAR-ITEMNUM.                                             
061400     INITIALIZE MYHPLOCIPADDR HPVAR-STAT.                                 
061500     CALL INTRINSIC "HPCIGETVAR" USING HPVAR-NAME                         
061600         HPVAR-STAT HPVAR-ITEMNUM HPVAR-ITEM.                             
061700     MOVE HPVAR-ITEM TO DISPZ4.                                           
061800    STRING "Number of formsfiles on this server:      " DISPZ4            
061900        DELIMITED BY SIZE INTO M.                                         
062000     PERFORM MSG-PROCESS.                                                 
062100     MOVE HPVAR-ITEM TO MYFFILCAP.                                        
062200                                                                          
062300*---------------------------                                              
062400* Number of formsfile forms                                               
062500     MOVE "MIG_FM_FORMS~" TO HPVAR-NAME.                                  
062600     MOVE 1 TO HPVAR-ITEMNUM.                                             
062700     INITIALIZE MYHPLOCIPADDR HPVAR-STAT.                                 
062800     CALL INTRINSIC "HPCIGETVAR" USING HPVAR-NAME                         
062900         HPVAR-STAT HPVAR-ITEMNUM HPVAR-ITEM.                             
063000     MOVE HPVAR-ITEM TO DISPZ4.                                           
063100    STRING "Number of formsfile forms on this server: " DISPZ4            
063200        DELIMITED BY SIZE INTO M.                                         
063300     PERFORM MSG-PROCESS.                                                 
063400     MOVE HPVAR-ITEM TO MYFMCAP.                                          
063500                                                                          
063600*---------------------------                                              
063700* Number of formsfile fields                                              
063800     MOVE "MIG_FM_FIELDS~" TO HPVAR-NAME.                                 
063900     MOVE 1 TO HPVAR-ITEMNUM.                                             
064000     INITIALIZE MYHPLOCIPADDR HPVAR-STAT.                                 
064100     CALL INTRINSIC "HPCIGETVAR" USING HPVAR-NAME                         
064200         HPVAR-STAT HPVAR-ITEMNUM HPVAR-ITEM.                             
064300     MOVE HPVAR-ITEM TO DISPZ4.                                           
064400    STRING "Number of formsfile fields on this server: " DISPZ4           
064500        DELIMITED BY SIZE INTO M.                                         
064600     PERFORM MSG-PROCESS.                                                 
064700     MOVE HPVAR-ITEM TO MYFFFLDCAP.                                       
064710                                                                          
064711*---------------------------                                      080828ma
064712* Number of fields Specs                                          080828ma
064713     MOVE "MIG_FM_SPECS~" TO HPVAR-NAME.                          080828ma
064714     MOVE 1 TO HPVAR-ITEMNUM.                                     080828ma
064715     INITIALIZE MYHPLOCIPADDR HPVAR-STAT.                         080828ma
064716     CALL INTRINSIC "HPCIGETVAR" USING HPVAR-NAME                 080828ma
064717         HPVAR-STAT HPVAR-ITEMNUM HPVAR-ITEM.                     080828ma
064718     MOVE HPVAR-ITEM TO DISPZ4.                                   080828ma
064719    STRING "Number of formsfile fields on this server: " DISPZ4   080828ma
064720        DELIMITED BY SIZE INTO M.                                 080828ma
064721     PERFORM MSG-PROCESS.                                         080828ma
064722     MOVE HPVAR-ITEM TO MYFFspecCAP.                              080828ma
064723                                                                  080828ma
064800     MOVE "PURGE SCHEM" to CMD.                                           
064900     PERFORM MPE-COMMAND.                                                 
065000     STRING "BUILD SCHEM" Delimited By Size                               
065100       ";REC=-80,1,F,ASCII;DISC=2048" Delimited by Size InTO CMD.         
065200     PERFORM MPE-COMMAND.                                                 
065300     OPEN OUTPUT SCHEMA-FILE.                                             
065400*// **************************************************************        
065500     MOVE "$control BlockMax = 2048                  " TO SCHMA.          
065600     WRITE SCHMA.                                                         
065700     INITIALIZE SCHMA.                                                    
065800     STRING "<< J3K Solutions MIGRATION SCHEMA >>"                        
065900      DELIMITED BY SIZE INTO SCHMA.                                       
066000     WRITE SCHMA.                                                         
066100     MOVE "Begin data base MIGDB;                    " TO SCHMA.          
066200     WRITE SCHMA.                                                         
066300     MOVE "Passwords:                                " TO SCHMA.          
066400     WRITE SCHMA.                                                         
066500     MOVE "  3 J3K ;                                 " TO SCHMA.          
066600     WRITE SCHMA.                                                         
066700     MOVE "                                          " TO SCHMA.          
066800     WRITE SCHMA.                                                         
066900     MOVE "Items:                                    " TO SCHMA.          
067000     WRITE SCHMA.                                                         
067100     MOVE "    ANYNAME16     , X16;                 " TO SCHMA.           
067200     WRITE SCHMA.                                                         
067300     MOVE "    ANYNAME28     , X28;                 " TO SCHMA.           
067400     WRITE SCHMA.                                                         
067500     MOVE "    BUF-LEN       ,  I4;                 " TO SCHMA.           
067600     WRITE SCHMA.                                                         
067700     MOVE "    BUF-X         ,  I4;                 " TO SCHMA.           
067800     WRITE SCHMA.                                                         
067900     MOVE "    BUF-Y         ,  I4;                 " TO SCHMA.           
068000     WRITE SCHMA.                                                         
068100     MOVE "    DATAPATH      , X128;                " TO SCHMA.           
068200     WRITE SCHMA.                                                         
068300     MOVE "    DB-ACCT       ,  X8;                 " TO SCHMA.           
068400     WRITE SCHMA.                                                         
068500     MOVE "    DB-BYTES      ,  I4;                 " TO SCHMA.           
068600     WRITE SCHMA.                                                         
068700     MOVE "    DB-COST       ,  I4;                 " TO SCHMA.           
068800     WRITE SCHMA.                                                         
068900     MOVE "    DB-CREATOR    ,  X8;                 " TO SCHMA.           
069000     WRITE SCHMA.                                                         
069100     MOVE "    DB-GROUP      ,  X8;                 " TO SCHMA.           
069200     WRITE SCHMA.                                                         
069300     MOVE "    DB-MIG        ,  X2;                 " TO SCHMA.           
069400     WRITE SCHMA.                                                         
069500     MOVE "    DB-NAME       , X28;                 " TO SCHMA.           
069600     WRITE SCHMA.                                                         
069700     MOVE "    DB-RECCNT     ,  I4;                 " TO SCHMA.           
069800     WRITE SCHMA.                                                         
069900     MOVE "    DB-SETCNT     ,  I4;                 " TO SCHMA.           
070000     WRITE SCHMA.                                                         
070100     MOVE "    DB-UNIQUE     ,  I2;                 " TO SCHMA.           
070200     WRITE SCHMA.                                                         
070300     MOVE "    DS-BYTES      ,  I4;                 " TO SCHMA.           
070400     WRITE SCHMA.                                                         
070500     MOVE "    DS-COST       ,  I4;                 " TO SCHMA.           
070600     WRITE SCHMA.                                                         
070700     MOVE "    DS-NAME       , X16;                 " TO SCHMA.           
070800     WRITE SCHMA.                                                         
070900     MOVE "    DS-RECCNT     ,  I4;                 " TO SCHMA.           
071000     WRITE SCHMA.                                                         
071100     MOVE "    DS-RECLEN     ,  I4;                 " TO SCHMA.           
071200     WRITE SCHMA.                                                         
071300     MOVE "    DS-TYPE       ,  X2;                 " TO SCHMA.           
071400     WRITE SCHMA.                                                         
071500     MOVE "    DS-UNIQUE     ,  I2;                 " TO SCHMA.           
071600     WRITE SCHMA.                                                         
071700     MOVE "    ERR-ENH       ,  X4;                 " TO SCHMA.           
071800     WRITE SCHMA.                                                         
071900     MOVE "    VFIL-ACCT     ,  X8;                 " TO SCHMA.           
072000     WRITE SCHMA.                                                         
072100     MOVE "    VFIL-BYTES    ,  I4;                 " TO SCHMA.           
072200     WRITE SCHMA.                                                         
072300     MOVE "    VFIL-COST     ,  I4;                 " TO SCHMA.           
072400     WRITE SCHMA.                                                         
072500     MOVE "    VFIL-CREATOR  ,  X8;                 " TO SCHMA.           
072600     WRITE SCHMA.                                                         
072700     MOVE "    VFIL-GROUP    ,  X8;                 " TO SCHMA.           
072800     WRITE SCHMA.                                                         
072900     MOVE "    VFIL-MIG      ,  X2;                 " TO SCHMA.           
073000     WRITE SCHMA.                                                         
073100     MOVE "    VFIL-NAME     , X28;                 " TO SCHMA.           
073200     WRITE SCHMA.                                                         
073300     MOVE "    VFIL-TYPE     ,  X8;                 " TO SCHMA.           
073400     WRITE SCHMA.                                                         
073500     MOVE "    VFIL-UNIQUE   ,  I2;                 " TO SCHMA.           
073600     WRITE SCHMA.                                                         
073700     MOVE "    IFLD-CVT-METHD, X16;                 " TO SCHMA.           
073800     WRITE SCHMA.                                                         
073900     MOVE "    VFLD-DATATYPE  ,  X4;                 " TO SCHMA.          
074000     WRITE SCHMA.                                                         
074010     MOVE "    VFLD-INITVAL   ,  X80;                 " TO SCHMA. 080828ma
074110     WRITE SCHMA.                                                 080828ma
074120     MOVE "    VFLD-ENHANCE   ,  X4;                 " TO SCHMA.          
074200     WRITE SCHMA.                                                         
074300     MOVE "    IFLD-LEN       ,  I2;                 " TO SCHMA.          
074400     WRITE SCHMA.                                                         
074500     MOVE "    VFLD-LENGTH    ,  I2;                 " TO SCHMA.          
074600     WRITE SCHMA.                                                         
074700     MOVE "    IFLD-MAX-VAL , X64;                 " TO SCHMA.            
074800     WRITE SCHMA.                                                         
074900     MOVE "    IFLD-MIN-VAL , X64;                 " TO SCHMA.            
075000     WRITE SCHMA.                                                         
075100     MOVE "    IFLD-NAME      , X16;                 " TO SCHMA.          
075310     WRITE SCHMA.                                                         
075311     MOVE "    VFLD-NAME      , X16;                 " TO SCHMA.          
075330     WRITE SCHMA.                                                         
075430     MOVE "    IFLD-NUM       ,  I2;                 " TO SCHMA.          
075510     WRITE SCHMA.                                                         
075511     MOVE "    VFLD-NUM       ,  I2;                 " TO SCHMA.          
075530     WRITE SCHMA.                                                         
075630     MOVE "    IFLD-POSITION  ,  I2;                 " TO SCHMA.          
075710     WRITE SCHMA.                                                         
075711     MOVE "    VFLD-POSITION  ,  I2;                 " TO SCHMA.          
075730     WRITE SCHMA.                                                         
075740     MOVE "    IFLD-SUBLEN    ,  I2;                 " TO SCHMA.          
075800     WRITE SCHMA.                                                         
075900     MOVE "    IFLD-TYPE      ,  X2;                 " TO SCHMA.          
076000     WRITE SCHMA.                                                         
076100     MOVE "    VFLD-TYPE     ,  X4;                 " TO SCHMA.           
076200     WRITE SCHMA.                                                         
076300     MOVE "    IFLD-UNIQUE    ,  I2;                 " TO SCHMA.          
076400     WRITE SCHMA.                                                         
076500     MOVE "    VFLD-UNIQUE    ,  I2;                 " TO SCHMA.          
076600     WRITE SCHMA.                                                         
076700     MOVE "    IFLD-X         ,  I2;                 " TO SCHMA.          
076800     WRITE SCHMA.                                                         
076900     MOVE "    IFLD-Y         ,  I2;                 " TO SCHMA.          
077000     WRITE SCHMA.                                                         
077100     MOVE "    FLDCNT        ,  I4;                 " TO SCHMA.           
077200     WRITE SCHMA.                                                         
077300     MOVE "    FM-UNIQUE     ,  I2;                 " TO SCHMA.           
077400     WRITE SCHMA.                                                         
077500     MOVE "    FRM-NAME      , X16;                 " TO SCHMA.           
077600     WRITE SCHMA.                                                         
077700     MOVE "    FRM-NUMBER    ,  I2;                 " TO SCHMA.           
077800     WRITE SCHMA.                                                         
077900     MOVE "    FTP-IPADDR    , X16;                 " TO SCHMA.           
078000     WRITE SCHMA.                                                         
078100     MOVE "    FTP-NAME      , X16;                 " TO SCHMA.           
078200     WRITE SCHMA.                                                         
078300     MOVE "    FTP-USER      , X16;                 " TO SCHMA.           
078400     WRITE SCHMA.                                                         
078500     MOVE "    FTP-WORD      , X16;                 " TO SCHMA.           
078600     WRITE SCHMA.                                                         
078700     MOVE "    HEAD-FRM      , X16;                 " TO SCHMA.           
078800     WRITE SCHMA.                                                         
078900     MOVE "    LOGPATH       , X128;                " TO SCHMA.           
079000     WRITE SCHMA.                                                         
079100     MOVE "    MAX-BUF       ,  I2;                 " TO SCHMA.           
079200     WRITE SCHMA.                                                         
079300     MOVE "    MAX-FLDS      ,  I2;                 " TO SCHMA.           
079400     WRITE SCHMA.                                                         
079500     MOVE "    NBR-OF-FORMS  ,  I2;                 " TO SCHMA.           
079600     WRITE SCHMA.                                                         
079700     MOVE "    NEXT-FRM      , X16;                 " TO SCHMA.           
079800     WRITE SCHMA.                                                         
079900     MOVE "    NFORM-OPT     , X2;                 " TO SCHMA.            
080000     WRITE SCHMA.                                                         
080100     MOVE "    PAN-NAME      , X16;                 " TO SCHMA.           
080200     WRITE SCHMA.                                                         
080300     MOVE "    PAN-TYPE      , X6;                  " TO SCHMA.           
080301     WRITE SCHMA.                                                         
080320     MOVE "  PRSPEC-SEQ      , I2;                  " TO SCHMA.           
080410     WRITE SCHMA.                                                         
080420     MOVE "  PRSPEC-TEXT     , X80;                 " TO SCHMA.           
080440     WRITE SCHMA.                                                         
080500     MOVE "    REPEAT-OPT    , X2;                  " TO SCHMA.           
080600     WRITE SCHMA.                                                         
080700     MOVE "    SAVE-FLDS     ,  I2;                 " TO SCHMA.           
080800     WRITE SCHMA.                                                         
080900     MOVE "    SERV-NAME     ,  X8;                 " TO SCHMA.           
081000     WRITE SCHMA.                                                         
081100     MOVE "    SERV-PORT     ,  Z6;                 " TO SCHMA.           
081200     WRITE SCHMA.                                                         
081300     MOVE "    SERV-PROG     , X28;                 " TO SCHMA.           
081400     WRITE SCHMA.                                                         
081500     MOVE "    SQL-NAME      , X32;                 " TO SCHMA.           
081600     WRITE SCHMA.                                                         
081700     MOVE "    SQL-TYPE      , X16;                 " TO SCHMA.           
081800     WRITE SCHMA.                                                         
081900     MOVE "    SRN-ORD-NUM   ,  I2;                 " TO SCHMA.           
082000     WRITE SCHMA.                                                         
082100     MOVE "    SRN-SX        ,  I2;                 " TO SCHMA.   080812ma
082510     WRITE SCHMA.                                                 080812ma
082520     MOVE "    SRN-SY        ,  I2;                 " TO SCHMA.   080812ma
082530     WRITE SCHMA.                                                 080812ma
082531     MOVE "    SRN-EX        ,  I2;                 " TO SCHMA.   080812ma
082550     WRITE SCHMA.                                                 080812ma
082560     MOVE "    SRN-EY        ,  I2;                 " TO SCHMA.   080812ma
082570     WRITE SCHMA.                                                 080812ma
082580     MOVE "    SVR-DBCNT     ,  I4;                 " TO SCHMA.           
082600     WRITE SCHMA.                                                         
082700     MOVE "    SVR-DSCNT     ,  I4;                 " TO SCHMA.           
082800     WRITE SCHMA.                                                         
082900     MOVE "    SVR-FLDCNT    ,  I4;                 " TO SCHMA.           
083000     WRITE SCHMA.                                                         
083100     MOVE "    SVR-VFILCNT   ,  I4;                 " TO SCHMA.           
083200     WRITE SCHMA.                                                         
083300     MOVE "    SVR-VFRMCNT   ,  I4;                 " TO SCHMA.           
083400     WRITE SCHMA.                                                         
083500     MOVE "    SVR-VFLDCNT   ,  I4;                 " TO SCHMA.           
083600     WRITE SCHMA.                                                         
083700     MOVE "    SVR-IPADDR    , X16;                 " TO SCHMA.           
083800     WRITE SCHMA.                                                         
083900     MOVE "    SVR-MPEVERSION,  X8;                 " TO SCHMA.           
084000     WRITE SCHMA.                                                         
084100     MOVE "    SVR-NAME      , X24;                 " TO SCHMA.           
084200     WRITE SCHMA.                                                         
084300     MOVE "    SVR-REC-COST  ,  I4;                 " TO SCHMA.           
084400     WRITE SCHMA.                                                         
084500     MOVE "    SVR-RECCNT    ,  I4;                 " TO SCHMA.           
084600     WRITE SCHMA.                                                         
084700     MOVE "    SVR-SUSAN     ,  I2;                 " TO SCHMA.           
084800     WRITE SCHMA.                                                         
084900     MOVE "    SVR-UNIQUE    ,  I2;                 " TO SCHMA.           
085000     WRITE SCHMA.                                                         
085100     MOVE "    UNIQ-ID       ,  X8;                 " TO SCHMA.           
085200     WRITE SCHMA.                                                         
085300     MOVE "    UNIQ-NUM      ,  I2;                 " TO SCHMA.           
085400     WRITE SCHMA.                                                         
085500     MOVE "    VERSION       ,  I4;                 " TO SCHMA.           
085600     WRITE SCHMA.                                                         
085700     MOVE "    WIN-ENH       ,  x4;                 " TO SCHMA.           
085800     WRITE SCHMA.                                                         
085900     MOVE "    WIN-POS       ,  I2;                 " TO SCHMA.           
086000     WRITE SCHMA.                                                         
086100     MOVE "    WS-NAME       , X16;                 " TO SCHMA.           
086200     WRITE SCHMA.                                                         
086300     MOVE "    WS-OCTET1     ,  I2;                 " TO SCHMA.           
086400     WRITE SCHMA.                                                         
086500     MOVE "    WS-OCTET2     ,  I2;                 " TO SCHMA.           
086600     WRITE SCHMA.                                                         
086700     MOVE "    WS-OCTET3     ,  I2;                 " TO SCHMA.           
086800     WRITE SCHMA.                                                         
086900     MOVE "    WS-OCTET4     ,  I2;                 " TO SCHMA.           
087000     WRITE SCHMA.                                                         
087100     MOVE "                                         " TO SCHMA.           
087200     WRITE SCHMA.                                                         
087300     MOVE "                                         " TO SCHMA.           
087400     WRITE SCHMA.                                                         
087500     MOVE "  Sets:                                  " TO SCHMA.           
087600     WRITE SCHMA.                                                         
087700*// **************************************************************        
087800*//  DATASET:                              DBUNIQ-MSTR                    
087900     IF MYDBCAP < 1 MOVE 20 TO MYDBCAP.                                   
088000     COMPUTE MYDBCAP = MYDBCAP * 1.2.                                     
088100     MOVE MYDBCAP TO DISP-99                                              
088200     MOVE "Name: DBUNIQ-MSTR      , Automatic(3/3);" TO SCHMA.            
088300     WRITE SCHMA.                                                         
088400     MOVE "Entry:" TO SCHMA.                                              
088500     WRITE SCHMA.                                                         
088600     MOVE "DB-UNIQUE       (3);" TO SCHMA.                                
088700     WRITE SCHMA.                                                         
088800     INITIALIZE SCHMA.                                                    
088900     STRING "Cap:" DISP-99 ";" DELIMITED BY SIZE INTO SCHMA.              
089000     WRITE SCHMA.                                                         
089100*// **************************************************************        
089200*//  DATASET:                              DSUNIQ-MSTR                    
089300     IF MYDSCAP < 1 MOVE 20 TO MYDSCAP.                                   
089400     COMPUTE MYDSCAP = MYDSCAP * 1.2.                                     
089500     MOVE MYDSCAP TO DISP-99                                              
089600     MOVE "Name: DSUNIQ-MSTR      , Automatic(3/3);" TO SCHMA.            
089700     WRITE SCHMA.                                                         
089800     MOVE "Entry:" TO SCHMA.                                              
089900     WRITE SCHMA.                                                         
090000     MOVE "DS-UNIQUE       (2);" TO SCHMA.                                
090100     WRITE SCHMA.                                                         
090200     INITIALIZE SCHMA.                                                    
090300     STRING "Cap:" DISP-99 ";" DELIMITED BY SIZE INTO SCHMA.              
090400     WRITE SCHMA.                                                         
090500*// **************************************************************        
090600*//  DATASET:                              FLDUNIQ-MSTR                   
090700     IF MYFLDCAP < 1 MOVE 20 TO MYFLDCAP.                                 
090800     MOVE MYFLDCAP TO DISP-99                                             
090900     MOVE "Name: FLDUNIQ-MSTR      , Automatic(3/3);" TO SCHMA.           
091000     WRITE SCHMA.                                                         
091100     MOVE "Entry:" TO SCHMA.                                              
091200     WRITE SCHMA.                                                         
091300     MOVE "IFLD-UNIQUE       (1);" TO SCHMA.                              
091400     WRITE SCHMA.                                                         
091500     INITIALIZE SCHMA.                                                    
091600     STRING "Cap:" DISP-99 ";" DELIMITED BY SIZE INTO SCHMA.              
091700     WRITE SCHMA.                                                         
091800*// **************************************************************        
091900*//  DATASET:                              VFLDUNIQ-MSTR                  
092000     IF MYFFFLDCAP < 1 MOVE 20 TO MYFFFLDCAP.                             
092100     MOVE MYFFFLDCAP TO DISP-99                                           
092200     MOVE "Name: VFLDUNIQ-MSTR      , Automatic(3/3);" TO SCHMA.          
092300     WRITE SCHMA.                                                         
092400     MOVE "Entry:" TO SCHMA.                                              
092500     WRITE SCHMA.                                                         
092600     MOVE "VFLD-UNIQUE       (2);" TO SCHMA.                              
092700     WRITE SCHMA.                                                         
092800     INITIALIZE SCHMA.                                                    
092900     STRING "Cap:" DISP-99 ";" DELIMITED BY SIZE INTO SCHMA.              
093000     WRITE SCHMA.                                                         
094400*// **************************************************************        
094401*//  DATASET:                              FFUNIQ-MSTR                    
094402     IF MYFFILCAP < 1 MOVE 20 TO MYFFILCAP.                               
094403     MOVE MYFFILCAP TO DISP-99                                            
094404     MOVE "Name: FFUNIQ-MSTR      , Automatic(3/3);" TO SCHMA.            
094405     WRITE SCHMA.                                                         
094406     MOVE "Entry:" TO SCHMA.                                              
094407     WRITE SCHMA.                                                         
094408     MOVE "VFIL-UNIQUE       (3);" TO SCHMA.                              
094409     WRITE SCHMA.                                                         
094410     INITIALIZE SCHMA.                                                    
094411     STRING "Cap:" DISP-99 ";" DELIMITED BY SIZE INTO SCHMA.              
094412     WRITE SCHMA.                                                         
094413*// **************************************************************        
094414*//  DATASET:                              FMUNIQ-MSTR                    
094415     IF MYFMCAP < 1 MOVE 20 TO MYFMCAP.                                   
094416     MOVE MYFMCAP TO DISP-99                                              
094417     MOVE "Name: FMUNIQ-MSTR      , Automatic(3/3);" TO SCHMA.            
094418     WRITE SCHMA.                                                         
094419     MOVE "Entry:" TO SCHMA.                                              
094420     WRITE SCHMA.                                                         
094421     MOVE "VFIL-UNIQUE       (2);" TO SCHMA.                              
094422     WRITE SCHMA.                                                         
094423     INITIALIZE SCHMA.                                                    
094424     STRING "Cap:" DISP-99 ";" DELIMITED BY SIZE INTO SCHMA.              
094425     WRITE SCHMA.                                                         
094426                                                                          
094500                                                                          
094600*// **************************************************************        
094700*//  DATASET:                              NAME28MSTR                     
094800     MOVE MYFMCAP TO DISP-99                                              
094900     MOVE "Name: NAME28MSTR      , Automatic(3/3);" TO SCHMA.             
095000     WRITE SCHMA.                                                         
095100     MOVE "Entry:" TO SCHMA.                                              
095200     WRITE SCHMA.                                                         
095300     MOVE "ANYNAME28       (2);" TO SCHMA.                                
095400     WRITE SCHMA.                                                         
095500     INITIALIZE SCHMA.                                                    
095600     STRING "Cap:" DISP-99 ";" DELIMITED BY SIZE INTO SCHMA.              
095700     WRITE SCHMA.                                                         
095800*// **************************************************************        
095900*//  DATASET:                              NAME16MSTR                     
096000     COMPUTE MY16CAP = MYDSCAP + MYFFFLDCAP.                              
096100     MOVE MY16CAP TO DISP-99                                              
096200     MOVE "Name: NAME16MSTR      , Automatic(3/3);" TO SCHMA.             
096300     WRITE SCHMA.                                                         
096400     MOVE "Entry:" TO SCHMA.                                              
096500     WRITE SCHMA.                                                         
096600     MOVE "ANYNAME16       (4);" TO SCHMA.                                
096700     WRITE SCHMA.                                                         
096800     INITIALIZE SCHMA.                                                    
096900     STRING "Cap:" DISP-99 ";" DELIMITED BY SIZE INTO SCHMA.              
097000     WRITE SCHMA.                                                         
097100*// **************************************************************        
097200*//  DATASET:                              SERVER-MSTR                    
097300     MOVE "Name: SERVER-MSTR,      MANUAL   (3/3);" TO SCHMA.             
097400     WRITE SCHMA.                                                         
097500     MOVE "Entry:                                 " TO SCHMA.             
097600     WRITE SCHMA.                                                         
097700     MOVE "  SVR-UNIQUE   (6),                    " TO SCHMA.             
097800     WRITE SCHMA.                                                         
097900     MOVE "  SVR-NAME        ,                    " TO SCHMA.             
098000     WRITE SCHMA.                                                         
098100     MOVE "  SVR-IPADDR      ,                    " TO SCHMA.             
098200     WRITE SCHMA.                                                         
098300     MOVE "  SVR-DBCNT       ,                    " TO SCHMA.             
098400     WRITE SCHMA.                                                         
098500     MOVE "  SVR-DSCNT       ,                    " TO SCHMA.             
098600     WRITE SCHMA.                                                         
098700     MOVE "  SVR-FLDCNT      ,                    " TO SCHMA.             
098800     WRITE SCHMA.                                                         
098900     MOVE "  SVR-RECCNT      ,                    " TO SCHMA.             
099000     WRITE SCHMA.                                                         
099010     MOVE "  SVR-VFILCNT     ,                    " TO SCHMA.             
099110     WRITE SCHMA.                                                         
099120     MOVE "  SVR-VFRMCNT     ,                    " TO SCHMA.             
099130     WRITE SCHMA.                                                         
099140     MOVE "  SVR-VFLDCNT     ,                    " TO SCHMA.             
099141     WRITE SCHMA.                                                         
099160     MOVE "  SVR-SUSAN       ,                    " TO SCHMA.             
099200     WRITE SCHMA.                                                         
099300     MOVE "  SVR-REC-COST    ,                    " TO SCHMA.             
099400     WRITE SCHMA.                                                         
099500     MOVE "  SVR-MPEVERSION  ;                    " TO SCHMA.             
099600     WRITE SCHMA.                                                         
099700     MOVE "Cap: 1;                                " TO SCHMA.             
099800     WRITE SCHMA.                                                         
099900     MOVE "                                       " TO SCHMA.             
100000     WRITE SCHMA.                                                         
100100*// **************************************************************        
100200*//  DATASET:                              FTP-MSTR                       
100300     MOVE "Name: FTP-MSTR,      MANUAL   (3/3);   " TO SCHMA.             
100400     WRITE SCHMA.                                                         
100500     MOVE "Entry:                                 " TO SCHMA.             
100600     WRITE SCHMA.                                                         
100700     MOVE "  FTP-NAME     (0),                    " TO SCHMA.             
100800     WRITE SCHMA.                                                         
100900     MOVE "  FTP-USER        ,                    " TO SCHMA.             
101000     WRITE SCHMA.                                                         
101100     MOVE "  FTP-WORD        ,                    " TO SCHMA.             
101200     WRITE SCHMA.                                                         
101300     MOVE "  FTP-IPADDR      ;                    " TO SCHMA.             
101400     WRITE SCHMA.                                                         
101500     MOVE "Cap: 1;                                " TO SCHMA.             
101600     WRITE SCHMA.                                                         
101700     MOVE "                                       " TO SCHMA.             
101800     WRITE SCHMA.                                                         
101900*// **************************************************************        
102000*//  DATASET:                              DB-MSTR                        
102100     MOVE "Name: DB-MSTR,      DETAIL   (3/3);    " TO SCHMA.             
102200     WRITE SCHMA.                                                         
102300     MOVE "Entry:                                 " TO SCHMA.             
102400     WRITE SCHMA.                                                         
102500     MOVE "  SVR-UNIQUE(!SERVER-MSTR(DB-UNIQUE)), " TO SCHMA.             
102600     WRITE SCHMA.                                                         
102700     MOVE "  DB-UNIQUE      (DBUNIQ-MSTR),        " TO SCHMA.             
102800     WRITE SCHMA.                                                         
102900     MOVE "  DB-NAME        (NAME28MSTR),          " TO SCHMA.            
103000     WRITE SCHMA.                                                         
103100     MOVE "  DB-CREATOR     ,                     " TO SCHMA.             
103200     WRITE SCHMA.                                                         
103300     MOVE "  DB-ACCT        ,                     " TO SCHMA.             
103400     WRITE SCHMA.                                                         
103500     MOVE "  DB-GROUP       ,                     " TO SCHMA.             
103600     WRITE SCHMA.                                                         
103700     MOVE "  DB-BYTES       ,                     " TO SCHMA.             
103800     WRITE SCHMA.                                                         
103900     MOVE "  SQL-NAME       ,                     " TO SCHMA.             
104000     WRITE SCHMA.                                                         
104100     MOVE "  DATAPATH       ,                     " TO SCHMA.             
104200     WRITE SCHMA.                                                         
104300     MOVE "  LOGPATH        ,                     " TO SCHMA.             
104400     WRITE SCHMA.                                                         
104500     MOVE "  DB-SETCNT      ,                     " TO SCHMA.             
104600     WRITE SCHMA.                                                         
104700     MOVE "  DB-RECCNT      ,                     " TO SCHMA.             
104800     WRITE SCHMA.                                                         
104900     MOVE "  DB-MIG         ,                     " TO SCHMA.             
105000     WRITE SCHMA.                                                         
105100     MOVE "  DB-COST        ;                     " TO SCHMA.             
105200     WRITE SCHMA.                                                         
105300     MOVE MYDBCAP TO DISP-99.                                             
105400     INITIALIZE SCHMA.                                                    
105500     STRING "Cap:" DISP-99 ";" DELIMITED BY SIZE INTO SCHMA.              
105600     WRITE SCHMA.                                                         
105700     MOVE "                                       " TO SCHMA.             
105800     WRITE SCHMA.                                                         
105900*// **************************************************************        
106000*//  DATASET:                              DS-MSTR                        
106100     MOVE "Name: DS-MSTR,      DETAIL   (3/3);    " TO SCHMA.             
106200     WRITE SCHMA.                                                         
106300     MOVE "Entry:                                 " TO SCHMA.             
106400     WRITE SCHMA.                                                         
106500     MOVE "  DB-UNIQUE (DBUNIQ-MSTR(DS-UNIQUE)),  " TO SCHMA.             
106600     WRITE SCHMA.                                                         
106700     MOVE "  DS-UNIQUE      ( !DSUNIQ-MSTR),      " TO SCHMA.             
106800     WRITE SCHMA.                                                         
106900     MOVE "  SVR-UNIQUE     (SERVER-MSTR),        " TO SCHMA.             
107000     WRITE SCHMA.                                                         
107100     MOVE "  DS-NAME        (NAME16MSTR),         " TO SCHMA.             
107200     WRITE SCHMA.                                                         
107300     MOVE "  SQL-NAME       ,                     " TO SCHMA.             
107400     WRITE SCHMA.                                                         
107500     MOVE "  DS-TYPE        ,                     " TO SCHMA.             
107600     WRITE SCHMA.                                                         
107700     MOVE "  DS-RECCNT      ,                     " TO SCHMA.             
107800     WRITE SCHMA.                                                         
107900     MOVE "  DS-RECLEN      ,                     " TO SCHMA.             
108000     WRITE SCHMA.                                                         
108100     MOVE "  DS-BYTES       ,                     " TO SCHMA.             
108200     WRITE SCHMA.                                                         
108300     MOVE "  DS-COST        ;                     " TO SCHMA.             
108400     WRITE SCHMA.                                                         
108500     MOVE MYDSCAP TO DISP-99.                                             
108600     INITIALIZE SCHMA.                                                    
108700     STRING "Cap:" DISP-99 ";" DELIMITED BY SIZE INTO SCHMA.              
108800     WRITE SCHMA.                                                         
108900     MOVE "                                       " TO SCHMA.             
109000     WRITE SCHMA.                                                         
109100*// **************************************************************        
109200*//  DATASET:                              DB-FIELDS                      
109300*// **************************************************************        
109400     MOVE "Name: DB-FIELDS,      DETAIL   (3/3);  " TO SCHMA.             
109500     WRITE SCHMA.                                                         
109600     MOVE "Entry:                                 " TO SCHMA.             
109700     WRITE SCHMA.                                                         
109800     MOVE "  DS-UNIQUE (DSUNIQ-MSTR(IFLD-UNIQUE)), " TO SCHMA.            
109900     WRITE SCHMA.                                                         
110000     MOVE "  IFLD-UNIQUE     ( !FLDUNIQ-MSTR),     " TO SCHMA.            
110100     WRITE SCHMA.                                                         
110200     MOVE "  DB-UNIQUE      (DBUNIQ-MSTR),        " TO SCHMA.             
110300     WRITE SCHMA.                                                         
110400     MOVE "  SVR-UNIQUE     (SERVER-MSTR),        " TO SCHMA.             
110500     WRITE SCHMA.                                                         
110600     MOVE "  IFLD-NAME       (NAME16MSTR),         " TO SCHMA.            
110700     WRITE SCHMA.                                                         
110800     MOVE "  IFLD-LEN         ,                    " TO SCHMA.            
110900     WRITE SCHMA.                                                         
111000     MOVE "  IFLD-X           ,                    " TO SCHMA.            
111100     WRITE SCHMA.                                                         
111200     MOVE "  IFLD-Y           ,                    " TO SCHMA.            
111300     WRITE SCHMA.                                                         
111400     MOVE "  IFLD-SUBLEN      ,                    " TO SCHMA.            
111500     WRITE SCHMA.                                                         
111600     MOVE "  SQL-NAME        ,                    " TO SCHMA.             
111700     WRITE SCHMA.                                                         
111800     MOVE "  IFLD-TYPE        ,                    " TO SCHMA.            
111900     WRITE SCHMA.                                                         
112000     MOVE "  SQL-TYPE        ,                    " TO SCHMA.             
112100     WRITE SCHMA.                                                         
112200     MOVE "  IFLD-CVT-METHD  ,                    " TO SCHMA.             
112300     WRITE SCHMA.                                                         
112400     MOVE "  IFLD-MAX-VAL   ,                    " TO SCHMA.              
112500     WRITE SCHMA.                                                         
112600     MOVE "  IFLD-MIN-VAL   ;                    " TO SCHMA.              
112700     WRITE SCHMA.                                                         
112800     MOVE MYFLDCAP TO DISP-99.                                            
112900     INITIALIZE SCHMA.                                                    
113000     STRING "Cap:" DISP-99 ";" DELIMITED BY SIZE INTO SCHMA.              
113100     WRITE SCHMA.                                                         
113200     MOVE "                                       " TO SCHMA.             
113300     WRITE SCHMA.                                                         
113400*// **************************************************************        
113500*//  DATASET:                              FFILE-M                        
113600     MOVE "Name: FF-MSTR,      DETAIL   (3/3);    " TO SCHMA.             
113700     WRITE SCHMA.                                                         
113800     MOVE "Entry:                                 " TO SCHMA.             
113900     WRITE SCHMA.                                                         
114000     MOVE "  SVR-UNIQUE(!SERVER-MSTR(VFIL-UNIQUE)), " TO SCHMA.           
114100     WRITE SCHMA.                                                         
114200     MOVE "  VFIL-UNIQUE      (FFUNIQ-MSTR),        " TO SCHMA.           
114300     WRITE SCHMA.                                                         
114400     MOVE "  VFIL-NAME        (NAME28MSTR),          " TO SCHMA.          
114500     WRITE SCHMA.                                                         
114600     MOVE "  VFIL-CREATOR     ,                     " TO SCHMA.           
114700     WRITE SCHMA.                                                         
114800     MOVE "  VFIL-ACCT        ,                     " TO SCHMA.           
114900     WRITE SCHMA.                                                         
115000     MOVE "  VFIL-GROUP       ,                     " TO SCHMA.           
115100     WRITE SCHMA.                                                         
115200     MOVE "  VFIL-BYTES       ,                     " TO SCHMA.           
115300     WRITE SCHMA.                                                         
115400     MOVE "  VFIL-TYPE       ,                     " TO SCHMA.            
115500     WRITE SCHMA.                                                         
115600     MOVE "  PAN-NAME       ,                     " TO SCHMA.             
115700     WRITE SCHMA.                                                         
115800     MOVE "  DATAPATH       ,                     " TO SCHMA.             
115900     WRITE SCHMA.                                                         
116000     MOVE "  LOGPATH        ,                     " TO SCHMA.             
116100     WRITE SCHMA.                                                         
116200     MOVE "  VERSION           ,                     " TO SCHMA.          
116300     WRITE SCHMA.                                                         
116400     MOVE "  NBR-OF-FORMS   ,                     " TO SCHMA.             
116500     WRITE SCHMA.                                                         
116600     MOVE "  MAX-FLDS        ,                     " TO SCHMA.            
116700     WRITE SCHMA.                                                         
116800     MOVE "  MAX-BUF       ,                     " TO SCHMA.              
116900     WRITE SCHMA.                                                         
117000     MOVE "  SAVE-FLDS       ,                     " TO SCHMA.            
117100     WRITE SCHMA.                                                         
117200     MOVE "  HEAD-FRM         ,                     " TO SCHMA.           
117300     WRITE SCHMA.                                                         
117400     MOVE "  ERR-ENH     ,                     " TO SCHMA.                
117500     WRITE SCHMA.                                                         
117600     MOVE "  WIN-ENH    ,                     " TO SCHMA.                 
117700     WRITE SCHMA.                                                         
117800     MOVE "  WIN-POS   ,                     " TO SCHMA.                  
117900     WRITE SCHMA.                                                         
118000     MOVE "  VFIL-MIG         ,                     " TO SCHMA.           
118100     WRITE SCHMA.                                                         
118200     MOVE "  VFIL-COST        ;                     " TO SCHMA.           
118300     WRITE SCHMA.                                                         
118400     MOVE MYFFILCAP TO DISP-99.                                           
118500     INITIALIZE SCHMA.                                                    
118600     STRING "Cap:" DISP-99 ";" DELIMITED BY SIZE INTO SCHMA.              
118700     WRITE SCHMA.                                                         
118800     MOVE "                                       " TO SCHMA.             
118900     WRITE SCHMA.                                                         
119000*// **************************************************************        
119100*//  DATASET:                              FM-MSTR                        
119200     MOVE "Name: FM-MSTR,      DETAIL   (3/3);    " TO SCHMA.             
119300     WRITE SCHMA.                                                         
119400     MOVE "Entry:                                 " TO SCHMA.             
119500     WRITE SCHMA.                                                         
119600     MOVE "  VFIL-UNIQUE (FFUNIQ-MSTR(FM-UNIQUE)),  " TO SCHMA.           
119700     WRITE SCHMA.                                                         
119800     MOVE "  FM-UNIQUE      ( !FMUNIQ-MSTR),      " TO SCHMA.             
119900     WRITE SCHMA.                                                         
120000     MOVE "  SVR-UNIQUE     (SERVER-MSTR),        " TO SCHMA.             
120100     WRITE SCHMA.                                                         
120200     MOVE "  FRM-NAME        (NAME16MSTR),         " TO SCHMA.            
120300     WRITE SCHMA.                                                         
120400     MOVE "  PAN-NAME        ,                     " TO SCHMA.            
120500     WRITE SCHMA.                                                         
120600     MOVE "  PAN-TYPE        ,                     " TO SCHMA.            
120700     WRITE SCHMA.                                                         
120800     MOVE "  FRM-NUMBER      ,                     " TO SCHMA.            
120900     WRITE SCHMA.                                                         
121000     MOVE "  FLDCNT          ,                     " TO SCHMA.            
121100     WRITE SCHMA.                                                         
121200     MOVE "  BUF-LEN         ,                     " TO SCHMA.            
121300     WRITE SCHMA.                                                         
121400     MOVE "  NEXT-FRM        ,                     " TO SCHMA.            
121500     WRITE SCHMA.                                                         
121600     MOVE "  REPEAT-OPT      ,                     " TO SCHMA.            
121700     WRITE SCHMA.                                                         
121800     MOVE "  NFORM-OPT       ;                     " TO SCHMA.            
121900     WRITE SCHMA.                                                         
122000     MOVE MYFMCAP TO DISP-99.                                             
122100     INITIALIZE SCHMA.                                                    
122200     STRING "Cap:" DISP-99 ";" DELIMITED BY SIZE INTO SCHMA.              
122300     WRITE SCHMA.                                                         
122400     MOVE "                                       " TO SCHMA.             
122500     WRITE SCHMA.                                                         
122600*// **************************************************************        
122700*//  DATASET:                              FM-FIELDS                      
122800*// **************************************************************        
122900     MOVE "Name: FF-FIELDS,      DETAIL   (3/3);  " TO SCHMA.             
123000     WRITE SCHMA.                                                         
123100     MOVE "Entry:                                 " TO SCHMA.             
123200     WRITE SCHMA.                                                         
123300     MOVE "  FM-UNIQUE (FMUNIQ-MSTR(VFLD-UNIQUE))," TO SCHMA.             
123400     WRITE SCHMA.                                                         
123500     MOVE "  VFLD-UNIQUE     ( !VFLDUNIQ-MSTR),   " TO SCHMA.             
123600     WRITE SCHMA.                                                         
123700     MOVE "  VFIL-UNIQUE      (FFUNIQ-MSTR),      " TO SCHMA.             
123800     WRITE SCHMA.                                                         
123900     MOVE "  SVR-UNIQUE     (SERVER-MSTR),        " TO SCHMA.             
124000     WRITE SCHMA.                                                         
124100     MOVE "  VFLD-NAME       (NAME16MSTR),         " TO SCHMA.            
124200     WRITE SCHMA.                                                         
124500     MOVE "  BUF-X           ,                    " TO SCHMA.             
124600     WRITE SCHMA.                                                         
124700     MOVE "  BUF-Y           ,                    " TO SCHMA.             
124800     WRITE SCHMA.                                                         
124900     MOVE "  SRN-SX          ,                    " TO SCHMA.     080812ma
125310     WRITE SCHMA.                                                 080812ma
125320     MOVE "  SRN-SY          ,                    " TO SCHMA.     080812ma
125330     WRITE SCHMA.                                                 080812ma
125331     MOVE "  SRN-EX          ,                    " TO SCHMA.     080812ma
125350     WRITE SCHMA.                                                 080812ma
125360     MOVE "  SRN-EY          ,                    " TO SCHMA.     080812ma
125370     WRITE SCHMA.                                                 080812ma
125380     MOVE "  PAN-NAME        ,                    " TO SCHMA.             
125400     WRITE SCHMA.                                                         
125500     MOVE "  SRN-ORD-NUM     ,                    " TO SCHMA.             
125600     WRITE SCHMA.                                                         
125700     MOVE "  VFLD-NUM         ,                    " TO SCHMA.            
125800     WRITE SCHMA.                                                         
125900     MOVE "  VFLD-LENGTH      ,                    " TO SCHMA.            
126000     WRITE SCHMA.                                                         
126100     MOVE "  VFLD-POSITION    ,                    " TO SCHMA.            
126200     WRITE SCHMA.                                                         
126300     MOVE "  VFLD-ENHANCE   ,   " TO SCHMA.                       080828ma
126400     WRITE SCHMA.                                                         
126500     MOVE "  VFLD-TYPE      ,   " TO SCHMA.                       080828ma
126600     WRITE SCHMA.                                                         
126700     MOVE "  VFLD-DATATYPE  ,   " TO SCHMA.                       080828ma
126910     WRITE SCHMA.                                                 080828ma
126911     MOVE "  VFLD-INIVAL    ;   " TO SCHMA.                       080828ma
126930     WRITE SCHMA.                                                 080828ma
126940     MOVE MYFFFLDCAP TO DISP-99.                                          
127000     INITIALIZE SCHMA.                                                    
127100     STRING "Cap:" DISP-99 ";" DELIMITED BY SIZE INTO SCHMA.              
127200     WRITE SCHMA.                                                         
127300     MOVE "                                       " TO SCHMA.             
127400     WRITE SCHMA.                                                         
127500*// **************************************************************        
127501*//  DATASET:                              VFLD-PROCSPECS                 
127502*// **************************************************************        
127503     MOVE "Name: VFLD-PROCSPECS, DETAIL   (3/3);  " TO SCHMA.             
127504     WRITE SCHMA.                                                         
127505     MOVE "Entry:                                 " TO SCHMA.             
127506     WRITE SCHMA.                                                         
127509     MOVE "  VFLD-UNIQUE (!VFLDUNIQ-MSTR(PRSPEC-SEQ))," TO SCHMA.         
127510     WRITE SCHMA.                                                         
127515     MOVE "  PRSPEC-SEQ      ,         " TO SCHMA.                        
127516     WRITE SCHMA.                                                         
127517     MOVE "  PRSPEC-TEXT   ;                      " TO SCHMA.             
127527     WRITE SCHMA.                                                         
127547     MOVE MYFFspecCAP TO DISP-99.                                 080828ma
127557     INITIALIZE SCHMA.                                                    
127567     STRING "Cap:" DISP-99 ";" DELIMITED BY SIZE INTO SCHMA.              
127577     WRITE SCHMA.                                                         
127587     MOVE "                                       " TO SCHMA.             
127620     WRITE SCHMA.                                                         
127630     MOVE "                                       " TO SCHMA.             
127640     WRITE SCHMA.                                                         
127650*// **************************************************************        
127700*//  DATASET:                              SERVICES                       
127800     MOVE "Name: SERVICES,      MANUAL   (3/3);   " TO SCHMA.             
127900     WRITE SCHMA.                                                         
128000     MOVE "Entry:                                 " TO SCHMA.             
128100     WRITE SCHMA.                                                         
128200     MOVE "   SERV-NAME (0),                      " TO SCHMA.             
128300     WRITE SCHMA.                                                         
128400     MOVE "   SERV-PROG    ,                      " TO SCHMA.             
128500     WRITE SCHMA.                                                         
128600     MOVE "   SERV-PORT    ;                      " TO SCHMA.             
128700     WRITE SCHMA.                                                         
128800     MOVE "Cap: 28;                               " TO SCHMA.             
128900     WRITE SCHMA.                                                         
129000     MOVE "                                       " TO SCHMA.             
129100     WRITE SCHMA.                                                         
129200     MOVE "                                       " TO SCHMA.             
129300     WRITE SCHMA.                                                         
129400*// **************************************************************        
129500*//  DATASET:                              WSTBL                          
129600     MOVE "Name: WSTBL,      MANUAL   (3/3);    " TO SCHMA.               
129700     WRITE SCHMA.                                                         
129800     MOVE "Entry:                                 " TO SCHMA.             
129900     WRITE SCHMA.                                                         
130000     MOVE "   WS-NAME   (0),                      " TO SCHMA.             
130100     WRITE SCHMA.                                                         
130200     MOVE "   WS-OCTET1    ,                      " TO SCHMA.             
130300     WRITE SCHMA.                                                         
130400     MOVE "   WS-OCTET2    ,                      " TO SCHMA.             
130500     WRITE SCHMA.                                                         
130600     MOVE "   WS-OCTET3    ,                      " TO SCHMA.             
130700     WRITE SCHMA.                                                         
130800     MOVE "   WS-OCTET4    ;                      " TO SCHMA.             
130900     WRITE SCHMA.                                                         
131000     MOVE "Cap: 7;                                " TO SCHMA.             
131100     WRITE SCHMA.                                                         
131200     MOVE "                                       " TO SCHMA.             
131300     WRITE SCHMA.                                                         
131400*// **************************************************************        
131500*//  DATASET:                              NEXTUNIQ                       
131600     MOVE "Name: NEXTUNIQ,      MANUAL   (3/3);   " TO SCHMA.             
131700     WRITE SCHMA.                                                         
131800     MOVE "Entry:                                 " TO SCHMA.             
131900     WRITE SCHMA.                                                         
132000     MOVE "   UNIQ-ID   (0),                      " TO SCHMA.             
132100     WRITE SCHMA.                                                         
132200     MOVE "   UNIQ-NUM     ;                      " TO SCHMA.             
132300     WRITE SCHMA.                                                         
132400     MOVE "Cap: 14;                                " TO SCHMA.            
132500     WRITE SCHMA.                                                         
132600     MOVE "                                       " TO SCHMA.             
132700     WRITE SCHMA.                                                         
132800     MOVE "                                       " TO SCHMA.             
132900     WRITE SCHMA.                                                         
133000     MOVE "end. << Schema by: J3K Solutions >>    " TO SCHMA.             
133100     WRITE SCHMA.                                                         
133200     CLOSE SCHEMA-FILE.                                                   
133300     move "Purge STDMSG,temp > $null" to cmd.                             
133400     PERFORM MPE-COMMAND.                                                 
133500     move "Build STDMSG;rec=-80,1,f,ascii;temp" to cmd.                   
133600     PERFORM MPE-COMMAND.                                                 
133700     move "File XIO=STDMSG,oldtemp" to cmd.                               
133800     PERFORM MPE-COMMAND.                                                 
133900     MOVE "ECHO MIGDB > *XIO" TO CMD.                                     
134000     PERFORM MPE-COMMAND.                                                 
134100     MOVE "ECHO Y >> *XIO" TO CMD.                                        
134200     PERFORM MPE-COMMAND.                                                 
134300     MOVE "RUN DBUTIL.PUB.SYS,PURGE < *XIO > $NULL" TO CMD.               
134400     PERFORM MPE-COMMAND.                                                 
134500     MOVE "FILE DBSTEXT=SCHEM" TO CMD.                                    
134600     PERFORM MPE-COMMAND.                                                 
134700     MOVE "FILE DBSLIST=SCHEM;DEV=LP,1" TO CMD.                           
134800     PERFORM MPE-COMMAND.                                                 
134900     MOVE "Compiling Database Schema, " TO M.                             
135000     PERFORM MSG-PROCESS.                                                 
135100     PERFORM SHOWTIME.                                                    
135200     MOVE "RUN DBSCHEMA.PUB.SYS;PARM=7 "  TO CMD.                         
135300     PERFORM MPE-COMMAND.                                                 
135400     MOVE "Building Database File Structure, " TO M.                      
135500     PERFORM MSG-PROCESS.                                                 
135600     PERFORM SHOWTIME.                                                    
135700     MOVE "ECHO CREATE MIGDB > *XIO" TO CMD.                              
135800     PERFORM MPE-COMMAND.                                                 
135900     MOVE "ECHO RELEASE MIGDB >> *XIO" TO CMD.                            
136000     PERFORM MPE-COMMAND.                                                 
136100     MOVE "ECHO EXIT >> *XIO" TO CMD.                                     
136200     PERFORM MPE-COMMAND.                                                 
136300     MOVE "RUN DBUTIL.PUB.SYS < *XIO > $NULL" TO CMD.                     
136400     PERFORM MPE-COMMAND.                                                 
136500*------------------------------------------------------------             
136600 MSG-PROCESS.                                                             
136700     DISPLAY M.                                                           
136800     INITIALIZE CSTR.                                                     
136900     STRING "TELLOP " M  %15 DELIMITED BY SIZE INTO CSTR.                 
137000     Move 2 To CMSG.                                                      
137100     IF BATCH-PROCESS OR NOT-INTERACTIVE                                  
137200      CALL INTRINSIC "HPCICOMMAND" USING                                  
137300           CSTR CERR CPARM CMSG.                                          
137400     INITIALIZE M CMD.                                                    
